<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learn Linux</title>

<style>
/* ========== MOBILE FIRST BASE ========== */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #1e1e1e;
  color: #eaeaea;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  height: 100vh;
}

/* ========== INSTRUCTIONS ========== */
#instructions {
  padding: 1rem;
  background: #2b2b2b;
  min-height: 30vh;
  max-height: 40vh;
  overflow-y: auto;
  border-bottom: 2px solid #444;
  white-space: pre-line;
  font-size: 0.95rem;
}

/* ========== TERMINAL OUTPUT ========== */
#terminal {
  flex: 1;
  padding: 0.75rem;
  background: #000;
  overflow-y: auto;
  font-size: 0.9rem;
  line-height: 1.4;
}

/* ========== INPUT BAR ========== */
#input-bar {
  display: flex;
  padding: 0.5rem;
  background: #111;
  border-top: 2px solid #333;
}

#prompt {
  color: #00ff88;
  padding-right: 0.25rem;
  font-size: 1rem;
}

#commandInput {
  flex: 1;
  background: #000;
  color: #fff;
  border: none;
  outline: none;
  font-family: monospace;
  font-size: 1rem;
}

/* ========== TEXT STYLES ========== */
.success { color: #00ff88; }
.hint { color: #ffd866; }
.error { color: #ff5555; }
.dim { color: #888; }

/* ========== DESKTOP ENHANCEMENTS ========== */
@media (min-width: 768px) {
  body {
    flex-direction: row;
  }
  #instructions {
    width: 40%;
    height: 100vh;
    max-height: none;
    border-bottom: none;
    border-right: 2px solid #444;
  }
  #terminal-container {
    width: 60%;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
}
</style>
</head>

<body>

<div id="instructions"></div>

<div id="terminal-container">
  <pre id="terminal"></pre>

  <div id="input-bar">
    <span id="prompt">$</span>
    <input id="commandInput" type="text" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" placeholder="type a commandâ€¦" />
  </div>
</div>

<script>
// =================================================
// SYSTEM STATE
// =================================================
let cwd = "/home/student";
let user = "student";

let fs = {
  "/": {
    home: {
      student: {
        "readme.txt": "Welcome to Learn Linux.\nLinux rewards curiosity."
      }
    }
  }
};

let state = {
  lastCmd: "",
  testProgress: 0
};

// =================================================
// LESSONS â€” LEVEL 1
// =================================================
let lessonIndex = 0;

const lessons = [
{
  title: "Level 1.1 â€” Where am I?",
  text: "You are inside a Linux machine.\n\nShow your current directory.",
  goal: () => state.lastCmd === "pwd",
  hint: "Use: pwd"
},
{
  title: "Level 1.1 â€” What is here?",
  text: "List the files in this directory.",
  goal: () => state.lastCmd === "ls",
  hint: "Use: ls"
},
{
  title: "Level 1.2 â€” Move around",
  text: "Change into the root directory (/).",
  goal: () => cwd === "/",
  hint: "Use: cd /"
},
{
  title: "Level 1.2 â€” Go back home",
  text: "Return to your home directory.",
  goal: () => cwd === "/home/student",
  hint: "Use: cd /home/student"
},
{
  title: "Level 1.3 â€” Create a file",
  text: "Create a file named notes.txt.",
  goal: () => "notes.txt" in resolveDir(cwd),
  hint: "Use: touch notes.txt"
},
{
  title: "Level 1.3 â€” Read a file",
  text: "Read the contents of readme.txt.",
  goal: () => state.lastCmd === "cat readme.txt",
  hint: "Use: cat readme.txt"
},
{
  title: "Level 1.4 â€” Who are you?",
  text: "Find out which user you are.",
  goal: () => state.lastCmd === "whoami",
  hint: "Use: whoami"
},
{
  title: "Level 1.4 â€” Your identity",
  text: "Display your user and group IDs.",
  goal: () => state.lastCmd === "id",
  hint: "Use: id"
},
{
  title: "ðŸ§ª Level 1 Final Test",
  text:
`Tasks:
1. Go to /
2. Go back home
3. List files
4. Read readme.txt
5. Show your user

No hints unless you ask.`,
  goal: () => state.testProgress >= 5,
  hint: "Slow down. One task at a time."
}
];

// =================================================
// UI
// =================================================
const instr = document.getElementById("instructions");
const term = document.getElementById("terminal");
const input = document.getElementById("commandInput");

function loadLesson() {
  const l = lessons[lessonIndex];
  instr.textContent = `ðŸ“˜ ${l.title}\n\n${l.text}`;
}

function print(text, cls="") {
  const span = document.createElement("div");
  span.textContent = text;
  if (cls) span.className = cls;
  term.appendChild(span);
  term.scrollTop = term.scrollHeight;
}

// =================================================
// INPUT HANDLING
// =================================================
input.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    execute(input.value.trim());
    input.value = "";
  }
});

// Auto focus on tap
document.body.addEventListener("click", () => input.focus());

loadLesson();
print("Welcome to Learn Linux.");
print("Type 'help' if you're unsure.");

// =================================================
// COMMAND EXECUTION
// =================================================
function execute(inputCmd) {
  if (!inputCmd) return;

  state.lastCmd = inputCmd;
  print(`$ ${inputCmd}`, "dim");

  const parts = inputCmd.split(" ");
  const cmd = parts[0];
  const arg = parts.slice(1).join(" ");

  if (cmd === "help" || inputCmd.endsWith("-h")) {
    print("Commands: pwd, ls, cd, touch, cat, whoami, id, hint");
  }
  else if (cmd === "hint") {
    print(lessons[lessonIndex].hint, "hint");
  }
  else if (cmd === "pwd") {
    print(cwd);
  }
  else if (cmd === "ls") {
    print(Object.keys(resolveDir(cwd)).join(" "));
  }
  else if (cmd === "cd") {
    if (arg === "/") cwd = "/";
    else if (arg === "..") cwd = cwd.split("/").slice(0,-1).join("/") || "/";
    else cwd = cwd + "/" + arg;
  }
  else if (cmd === "touch") {
    resolveDir(cwd)[arg] = "";
  }
  else if (cmd === "cat") {
    let dir = resolveDir(cwd);
    if (dir[arg]) print(dir[arg]);
    else print("No such file", "error");
  }
  else if (cmd === "whoami") {
    print(user);
  }
  else if (cmd === "id") {
    print(`uid=1000(${user}) gid=1000(${user}) groups=1000(${user})`);
  }
  else {
    print("command not found", "error");
  }

  // Final test tracking
  if (lessons[lessonIndex].title.includes("Final Test")) {
    if (inputCmd === "cd /") state.testProgress++;
    if (inputCmd === "cd /home/student") state.testProgress++;
    if (inputCmd === "ls") state.testProgress++;
    if (inputCmd === "cat readme.txt") state.testProgress++;
    if (inputCmd === "whoami") state.testProgress++;
  }

  checkLesson();
}

// =================================================
// HELPERS
// =================================================
function resolveDir(path) {
  let parts = path.split("/").filter(Boolean);
  let cur = fs["/"];
  for (let p of parts) cur = cur[p];
  return cur;
}

function checkLesson() {
  if (lessons[lessonIndex].goal()) {
    print("âœ… Nice work! Type 'continue' to move on.", "success");
  }
  if (state.lastCmd === "continue") {
    lessonIndex++;
    if (lessonIndex < lessons.length) {
      loadLesson();
    } else {
      instr.textContent =
`ðŸŽ‰ LEVEL 1 COMPLETE

You can:
âœ” Navigate directories
âœ” Create & read files
âœ” Understand your user

You didnâ€™t memorize Linux.
You used it.

Next:
LEVEL 2 â€” Files, permissions & control ðŸ› ï¸`;
    }
  }
}
</script>

</body>
</html>
