<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learn Linux</title>
<style>
*{box-sizing:border-box;}
body{margin:0;font-family:monospace;display:flex;flex-direction:column;height:100vh;background:#1e1e1e;color:#eaeaea;}
#instructions{padding:0.8rem;background:#2b2b2b;min-height:14vh;max-height:20vh;overflow-y:auto;border-bottom:2px solid #444;white-space: pre-line;}
#terminal{flex:1;padding:0.75rem;background:#000;overflow-y:auto;font-size:0.9rem;line-height:1.4;}
#input-bar{display:flex;padding:0.5rem;background:#111;border-top:2px solid #333;}
#prompt{color:#00ff88;margin-right:0.3rem;}
#commandInput{flex:1;background:#000;color:#fff;border:none;outline:none;font-family:monospace;font-size:1rem;}
.success{color:#00ff88;}
.hint{color:#ffd866;}
.error{color:#ff5555;}
.dim{color:#888;}
@media(min-width:768px){
  body{flex-direction:row;}
  #instructions{width:40%;height:100vh;max-height:none;border-bottom:none;border-right:2px solid #444;}
  #terminal-container{width:60%;display:flex;flex-direction:column;height:100vh;}
}
</style>
</head>
<body>

<div id="instructions"></div>
<div id="terminal-container">
  <pre id="terminal"></pre>
  <div id="input-bar">
    <span id="prompt">$</span>
    <input id="commandInput" type="text" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" placeholder="type a commandâ€¦">
  </div>
</div>

<script>
// STATE
let cwd = "/home/student", user = "student";
let fs = {"/":{home:{student:{"readme.txt":{content:"Welcome to Learn Linux.\nLinux rewards curiosity.",perm:"rw-r--r--",type:"text"},"script.sh":{content:"# /bin/bash\necho Hello",perm:"rw-------",type:"shell script"}}}}};
let lessonIndex = 0;
let state = {
  lastCmd: "", testProgress: 0, packages: [], mistakes: {}, training: false,
  trainingQueue: [], trainingIndex: 0, hintCount: 0,
  xp: 0, hearts: 5, streak: 0, achievements: []
};

// SHUFFLE
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// LESSONS (shortened for brevity â€“ add full list back if needed)
const lessons = [
  { title:"Level 1.1 â€” Where am I?", text:"Show your current directory.", goal:()=>state.lastCmd==="pwd", hint:"pwd" },
  // ... add the rest of your lessons here ...
  { title:"Level 10 Final Test", text:"Simulate sysadmin tasks.", goal:()=>state.testProgress>=3, hint:"Follow carefully." }
];

// UI
const instr = document.getElementById("instructions");
const term = document.getElementById("terminal");
const input = document.getElementById("commandInput");

function print(txt, cls="") {
  let d = document.createElement("div");
  d.textContent = txt;
  if(cls) d.className = cls;
  term.appendChild(d);
  term.scrollTop = term.scrollHeight;
}

// FILESYSTEM HELPERS (unchanged)
function resolveDir(path){ /* ... same as before ... */ }
function normalizePath(path){ /* ... same as before ... */ }

// FIXED loadLesson â€“ using BACKTICKS + fallback
function loadLesson() {
  if (lessonIndex >= lessons.length) {
    instr.textContent = "ðŸŽ‰ Congratulations! You completed all lessons.";
    return;
  }
  const lesson = lessons[lessonIndex] || {};
  const title = lesson.title || "(missing title â€“ bug in lessons array)";
  const text  = lesson.text  || "(missing instructions â€“ please check lessons array)";
  instr.textContent = `ðŸ“˜ \( {title}\n\n \){text}`;
  state.hintCount = 0;
  state.hearts = 5; // reset hearts per lesson
  print(`ðŸ“˜ Now on: ${title}`,"success");
}

// START
print("Welcome to Learn Linux Trainer â€“ type 'help' or 'status'","hint");
loadLesson();  // This should now show correct title + text
input.focus();
</script>
</body>
</html>
