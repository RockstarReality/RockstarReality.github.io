<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certification Practice Hub</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .header p { color: #a0a0a0; font-size: 1.1rem; }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        .stat-card h3 { color: #a0a0a0; font-size: 0.9rem; margin-bottom: 8px; font-weight: 500; }
        .stat-card .value { font-size: 2rem; font-weight: 700; color: #ffd700; }
        .exams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }
        .exam-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .exam-card:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }
        .exam-header { display: flex; align-items: flex-start; gap: 15px; margin-bottom: 15px; }
        .exam-icon {
            background: rgba(255, 215, 0, 0.2);
            padding: 12px;
            border-radius: 8px;
            font-size: 24px;
        }
        .exam-title { flex: 1; }
        .exam-title h3 { color: #ffd700; font-size: 1.3rem; margin-bottom: 8px; }
        .exam-title p { color: #a0a0a0; font-size: 0.9rem; line-height: 1.5; }
        .exam-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        .difficulty {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .difficulty.beginner { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .difficulty.intermediate { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .difficulty.advanced { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .question-count { color: #666; font-size: 0.85rem; }
        .instructions-view, .exam-view, .results-view {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        .timer { font-size: 1.2rem; color: #ffcc00; margin-bottom: 20px; }
        .question-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .options-container { margin-bottom: 20px; }
        .option {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #666;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .option:hover { background: rgba(255, 255, 255, 0.05); }
        .option.selected { border-color: #ffd700; background: rgba(255, 215, 0, 0.1); }
        .option input { cursor: pointer; }
        .submit-btn, .start-btn, .next-btn {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .submit-btn:hover, .start-btn:hover, .next-btn:hover { background: #ffed4e; transform: translateY(-2px); }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .results-header { font-size: 1.5rem; margin-bottom: 20px; }
        .pass { color: #22c55e; }
        .fail { color: #ef4444; }
        .domain-breakdown { margin-top: 30px; }
        .domain-breakdown h4 { margin-bottom: 10px; }
        .domain-bar { background: rgba(255, 255, 255, 0.1); height: 10px; border-radius: 5px; }
        .domain-fill { height: 100%; background: #ffd700; border-radius: 5px; }
        .back-btn {
            background: transparent;
            border: 1px solid #666;
            color: #fff;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .back-btn:hover { border-color: #ffd700; color: #ffd700; }
        .hidden { display: none; }
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .exams-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><span>üìö</span> Certification Practice Hub</h1>
            <p>Realistic timed practice exams for CompTIA, AWS, Microsoft & more</p>
        </div>
        <div class="dashboard">
            <div class="stat-card">
                <h3>Last Score</h3>
                <div class="value" id="lastScore">0</div>
            </div>
            <div class="stat-card">
                <h3>Exams Completed</h3>
                <div class="value" id="examsCompleted">0</div>
            </div>
            <div class="stat-card">
                <h3>Average Pass Rate</h3>
                <div class="value" id="passRate">0%</div>
            </div>
        </div>
        <div id="examsView" class="exams-grid"></div>
        <div id="instructionsView" class="instructions-view hidden"></div>
        <div id="examView" class="exam-view hidden"></div>
        <div id="resultsView" class="results-view hidden"></div>
    </div>
        <script>
const state = {
    selectedExam: null,
    currentQuestion: 0,
    answers: [],
    startTime: null,
    timerInterval: null,
    timeRemaining: 90 * 60,
    examHistory: [],
    wrongQuestions: [],       // NEW: for review wrong answers
    showingReview: false      // NEW: flag for review mode
};





        const exams = [
            {
                id: 1,
                title: "CompTIA Security+ SY0-701 Practice Exam",
                icon: "üìù",
                difficulty: "intermediate",
                description: "Realistic simulation of the CompTIA Security+ certification exam with randomized questions",
                timeLimitMinutes: 90,
                domainWeights: [0.12, 0.22, 0.18, 0.28, 0.20],
                questions: [
                    // Domain 1: Attacks, Threats, and Vulnerabilities (24%)
                    // Domain 2: Architecture and Design (21%)
                    // Domain 3: Implementation (25%)
                    // Domain 4: Operations and Incident Response (20%)
                    // Domain 5: Governance, Risk, and Compliance (14%)
                    { domain: 1, type: 'single', question: "Which of the following is a common indicator of a phishing attack?", options: ["Unexpected email with urgent language", "Official company logo", "HTTPS connection", "Known sender address"], answer: 0, explanation: "Phishing often uses urgency to trick users into clicking." },
                    { domain: 1, type: 'multi', question: "Select all that apply to ransomware characteristics.", options: ["Encrypts files", "Demands payment", "Self-propagates like a worm", "Always deletable with antivirus"], answer: [0,1,2], explanation: "Ransomware encrypts, demands ransom, and may spread." },
                    { domain: 1, type: 'single', question: "What is a zero-day exploit?", options: ["Unknown vulnerability", "Patched vulnerability", "Social engineering", "Known exploit"], answer: 0, explanation: "Zero-day is unknown to vendor." },
                    { domain: 2, type: 'single', question: "Which encryption algorithm is symmetric?", options: ["AES", "RSA", "ECC", "DSA"], answer: 0, explanation: "AES is symmetric." },
                    { domain: 2, type: 'multi', question: "Select secure network design elements.", options: ["DMZ", "VLAN segmentation", "Flat network", "Zero Trust"], answer: [0,1,3], explanation: "DMZ, VLAN, Zero Trust enhance security." },
                    { domain: 3, type: 'single', question: "What does PKI stand for?", options: ["Public Key Infrastructure", "Private Key Integration", "Public Key Integration", "Private Key Infrastructure"], answer: 0, explanation: "Public Key Infrastructure manages digital certificates." },
                    { domain: 4, type: 'single', question: "First step in incident response?", options: ["Preparation", "Identification", "Containment", "Eradication"], answer: 1, explanation: "Identification confirms the incident." },
                    { domain: 5, type: 'single', question: "What is GDPR?", options: ["General Data Protection Regulation", "General Data Privacy Rule", "Global Data Protection Rule", "Global Data Privacy Regulation"], answer: 0, explanation: "EU data protection law." },
                    { domain: 1, type: 'single', question: "Which of the following is the BEST example of social engineering?", options: ["Phishing email pretending to be from IT support", "Brute-force password attack", "Buffer overflow exploit", "SQL injection"], answer: 0, explanation: "Social engineering manipulates people; phishing is a classic technique." },
                    { domain: 1, type: 'single', question: "What type of attack uses previously captured network traffic to gain unauthorized access?", options: ["Replay attack", "Man-in-the-middle", "Session hijacking", "Evil twin"], answer: 0, explanation: "Replay attacks resend valid captured data (usually authentication packets)." },
                    { domain: 1, type: 'multi', question: "Select all techniques commonly used in a watering hole attack.", options: ["Compromise legitimate websites frequented by targets", "Inject malicious code into the site", "Send targeted spear-phishing emails", "Redirect users to a fake login page"], answer: [0,1,3], explanation: "Watering hole attacks poison sites the victim group visits." },
                    { domain: 1, type: 'single', question: "Which vulnerability allows an attacker to execute arbitrary code by overflowing a buffer?", options: ["Buffer overflow", "Integer overflow", "Format string vulnerability", "Use-after-free"], answer: 0, explanation: "Classic buffer overflow overwrites adjacent memory with malicious code." },
                    { domain: 1, type: 'single', question: "What is the primary goal of a DDoS attack?", options: ["Make a service unavailable", "Steal credentials", "Install ransomware", "Exfiltrate data"], answer: 0, explanation: "Distributed Denial of Service overwhelms targets to disrupt availability." },
                    { domain: 1, type: 'single', question: "Which of the following is a fileless malware technique?", options: ["Living-off-the-land binaries (LOLBins)", "PowerShell scripts in memory", "Registry Run keys", "All of the above"], answer: 3, explanation: "Fileless malware avoids disk writes by using legitimate system tools." },
                    { domain: 1, type: 'single', question: "An attacker sends malformed input that causes a database error revealing table structure. This is an example of:", options: ["Error-based SQL injection", "Blind SQL injection", "Union-based SQL injection", "Time-based SQL injection"], answer: 0, explanation: "Error-based injection exploits verbose error messages." },
                    { domain: 1, type: 'single', question: "What is the purpose of a command-and-control (C2) channel in malware?", options: ["Receive instructions and exfiltrate data", "Encrypt files", "Spread to other hosts", "Elevate privileges"], answer: 0, explanation: "C2 allows remote control of compromised hosts." },
                    { domain: 1, type: 'single', question: "Which attack exploits the trust in a certificate authority?", options: ["CA compromise / rogue CA", "Pass-the-hash", "Kerberoasting", "Golden ticket"], answer: 0, explanation: "A compromised CA can issue fraudulent certificates." },
                    { domain: 1, type: 'single', question: "What is vishing?", options: ["Voice phishing over phone calls", "SMS phishing", "Email phishing", "Spear phishing"], answer: 0, explanation: "Vishing = voice phishing." },
                    { domain: 2, type: 'single', question: "Which control provides the strongest protection against physical theft of a laptop?", options: ["Full-disk encryption", "Strong password", "BIOS password", "Cable lock"], answer: 0, explanation: "FDE protects data even if device is stolen." },
                    { domain: 2, type: 'single', question: "What is the purpose of a bastion host?", options: ["Single hardened point for external administration", "Load balancer", "Web application firewall", "SIEM collector"], answer: 0, explanation: "Bastion hosts are jump servers in DMZ for controlled access." },
                    { domain: 2, type: 'single', question: "Which architecture assumes breach and verifies every access?", options: ["Zero Trust", "Defense-in-depth", "Perimeter security", "Implicit trust"], answer: 0, explanation: "Zero Trust never trusts, always verifies." },
                    { domain: 2, type: 'multi', question: "Select all that are key Zero Trust pillars.", options: ["Verify explicitly", "Use least privilege", "Assume breach", "Trust internal network"], answer: [0,1,2], explanation: "Core pillars exclude trusting internal traffic." },
                    { domain: 2, type: 'single', question: "What is the BEST way to segment networks in a Zero Trust model?", options: ["Micro-segmentation", "VLANs only", "One large flat network", "No segmentation"], answer: 0, explanation: "Micro-segmentation limits lateral movement." },
                    { domain: 2, type: 'single', question: "Which cryptographic primitive is used for digital signatures?", options: ["Asymmetric encryption", "Hashing", "Symmetric encryption", "Key exchange"], answer: 0, explanation: "Asymmetric keys (private sign, public verify) enable signatures." },
                    { domain: 1, type: 'single', question: "What is the primary difference between a worm and a virus?", options: ["Worm self-propagates without user interaction", "Virus requires user action to spread", "Worm encrypts files", "Virus uses social engineering"], answer: 0, explanation: "Worms replicate independently across networks; viruses attach to files and need user execution." },
                    { domain: 1, type: 'single', question: "Which attack exploits weak session management to impersonate users?", options: ["Session hijacking", "Cross-site scripting", "Cross-site request forgery", "Clickjacking"], answer: 0, explanation: "Session hijacking steals or predicts session IDs to take over active sessions." },
                    { domain: 1, type: 'multi', question: "Select all common goals of an advanced persistent threat (APT).", options: ["Long-term access", "Stealthy data exfiltration", "Immediate ransomware deployment", "High visibility disruption"], answer: [0,1], explanation: "APTs focus on stealth, persistence, and targeted data theft over time." },
                    { domain: 1, type: 'single', question: "What is a 'watering hole' attack?", options: ["Compromising websites frequented by a target group", "Sending phishing emails to many users", "Poisoning DNS responses", "Exploiting buffer overflows"], answer: 0, explanation: "Attackers infect legitimate sites their targets visit to deliver malware." },
                    { domain: 1, type: 'single', question: "Which technique hides malicious code inside legitimate processes?", options: ["Process injection", "DLL sideloading", "Living-off-the-land", "All of the above"], answer: 3, explanation: "All three are fileless or stealth techniques used in modern malware." },
                    { domain: 1, type: 'single', question: "What does the term 'Kerberoasting' target?", options: ["Kerberos service tickets for offline cracking", "NTLM hashes", "LDAP queries", "SAML assertions"], answer: 0, explanation: "Kerberoasting requests service tickets and cracks them offline to get service account passwords." },
                    { domain: 1, type: 'single', question: "Which is a common post-exploitation technique in Windows environments?", options: ["Pass-the-hash", "Golden ticket", "Silver ticket", "All are valid"], answer: 3, explanation: "All are Mimikatz-style credential attacks used after initial access." },
                    { domain: 1, type: 'single', question: "What is the purpose of a rootkit?", options: ["Hide presence of malware or attacker", "Encrypt files for ransom", "Steal credentials", "Spread via USB"], answer: 0, explanation: "Rootkits provide stealth by hiding processes, files, and network activity." },
                    { domain: 1, type: 'single', question: "Which attack vector exploits unvalidated redirects?", options: ["Open redirect", "Phishing", "CSRF", "XSS"], answer: 0, explanation: "Open redirects trick users into visiting malicious sites via trusted domains." },
                    { domain: 1, type: 'single', question: "What is 'credential stuffing'?", options: ["Using stolen username/password pairs from breaches on many sites", "Brute-forcing passwords", "Keylogging", "Phishing for credentials"], answer: 0, explanation: "Credential stuffing reuses leaked credentials across multiple services." },
                    { domain: 2, type: 'single', question: "Which design principle ensures no single point of failure?", options: ["Defense-in-depth", "High availability", "Least privilege", "Separation of duties"], answer: 1, explanation: "High availability uses redundancy to eliminate single points of failure." },
                    { domain: 2, type: 'single', question: "What is the primary purpose of a DMZ?", options: ["Host public-facing services with limited internal access", "Store sensitive data", "Run internal applications", "Provide VPN access"], answer: 0, explanation: "DMZ isolates internet-facing servers from the internal network." },
                    { domain: 2, type: 'single', question: "Which control prevents lateral movement in a network?", options: ["Network segmentation", "Single sign-on", "Multi-factor authentication", "Password complexity"], answer: 0, explanation: "Segmentation (VLANs, firewalls, micro-segmentation) limits attacker movement." },
                    { domain: 2, type: 'single', question: "What is 'implicit deny' in firewall rules?", options: ["Deny all traffic unless explicitly allowed", "Allow all unless denied", "Log all traffic", "Block only inbound"], answer: 0, explanation: "Implicit deny is the default catch-all rule at the end of firewall policies." },
                    { domain: 2, type: 'single', question: "Which is a benefit of using a hardware security module (HSM)?", options: ["Secure key storage and cryptographic operations", "Faster network throughput", "User authentication", "Log aggregation"], answer: 0, explanation: "HSMs protect private keys and perform crypto operations securely." },
                    { domain: 2, type: 'single', question: "What does 'DLP' stand for in security architecture?", options: ["Data Loss Prevention", "Data Leak Protection", "Digital License Protection", "Domain Level Policy"], answer: 0, explanation: "DLP prevents sensitive data from leaving the organization." },
                    { domain: 2, type: 'single', question: "Which architecture uses software-defined perimeters?", options: ["Zero Trust Network Access (ZTNA)", "Traditional VPN", "Perimeter firewall only", "Cloud-native security"], answer: 0, explanation: "ZTNA creates invisible perimeters, granting access only after verification." },
                    { domain: 3, type: 'single', question: "What is the BEST way to store passwords in a database?", options: ["Use strong hashing with salt (e.g., bcrypt, Argon2)", "Encrypt with AES", "Store plaintext", "Base64 encode"], answer: 0, explanation: "One-way hashing with salt prevents reversal even if DB is compromised." },
                    { domain: 3, type: 'single', question: "Which protocol should be used for secure remote access?", options: ["SSH", "Telnet", "RDP without NLA", "FTP"], answer: 0, explanation: "SSH provides encrypted, authenticated remote shell access." },
                    { domain: 3, type: 'single', question: "What is the purpose of certificate pinning?", options: ["Prevent man-in-the-middle by validating expected certificate", "Speed up TLS handshake", "Encrypt traffic", "Revoke certificates"], answer: 0, explanation: "HPKP or Certificate Transparency pinning ensures only trusted certs are accepted." },
                    { domain: 4, type: 'single', question: "Which NIST IR phase includes isolating affected systems?", options: ["Containment", "Detection", "Recovery", "Post-incident"], answer: 0, explanation: "Containment stops the spread of the incident." },
                    { domain: 4, type: 'single', question: "What is the first action when a system is suspected of compromise?", options: ["Isolate the system", "Reimage immediately", "Run antivirus scan", "Notify executives"], answer: 0, explanation: "Containment first ‚Äî isolate to prevent further damage." },
                    { domain: 5, type: 'single', question: "Which regulation requires breach notification within 72 hours?", options: ["GDPR", "HIPAA", "PCI DSS", "SOX"], answer: 0, explanation: "GDPR mandates notification to supervisory authority within 72 hours." },
                    { domain: 5, type: 'single', question: "What is a risk register used for?", options: ["Document identified risks, likelihood, impact, and mitigation", "Track vulnerabilities", "Manage user permissions", "Log incidents"], answer: 0, explanation: "Risk register is the central document for risk management." },
                    { domain: 1, type: 'single', question: "What is a supply-chain attack?", options: ["Compromising a trusted vendor or software to deliver malware", "Direct phishing of end users", "Brute-force on login portals", "DDoS on infrastructure"], answer: 0, explanation: "Supply-chain attacks target third-party vendors or updates to reach many victims (e.g., SolarWinds, MOVEit)." },
                    { domain: 1, type: 'single', question: "Which technique uses compromised legitimate accounts for command-and-control?", options: ["Living-off-the-land", "Pass-the-ticket", "Account takeover", "All of the above"], answer: 3, explanation: "Attackers use legitimate accounts/tools to blend in (LOLBins, stolen tickets, etc.)." },
                    { domain: 1, type: 'single', question: "What is the goal of a 'watering hole' attack?", options: ["Infect legitimate websites visited by a specific target group", "Flood a website with traffic", "Steal session cookies", "Exploit browser extensions"], answer: 0, explanation: "Targets are lured to poisoned legitimate sites they trust." },
                    { domain: 1, type: 'multi', question: "Select all that are indicators of compromise (IoCs) for a fileless attack.", options: ["Unusual PowerShell or WMI activity", "High memory usage by lsass.exe", "New files written to disk", "Suspicious network connections"], answer: [0,1,3], explanation: "Fileless attacks avoid disk writes; focus on memory, processes, and network." },
                    { domain: 1, type: 'single', question: "What is 'credential dumping'?", options: ["Extracting credentials from memory (lsass.exe, SAM, etc.)", "Brute-forcing passwords", "Phishing for credentials", "Keylogging"], answer: 0, explanation: "Tools like Mimikatz dump creds from memory, registry, or files." },
                    { domain: 1, type: 'single', question: "Which attack spoofs ARP replies to redirect traffic?", options: ["ARP poisoning", "DNS spoofing", "DHCP starvation", "MAC flooding"], answer: 0, explanation: "ARP poisoning associates attacker MAC with victim IP." },
                    { domain: 1, type: 'single', question: "What is the primary risk of an unpatched Print Spooler service?", options: ["Remote code execution (PrintNightmare)", "Data exfiltration", "Denial of service only", "Credential theft"], answer: 0, explanation: "PrintNightmare and similar bugs allowed RCE via spooler." },
                    { domain: 1, type: 'single', question: "What is a 'living-off-the-land' (LOTL) attack?", options: ["Using legitimate system tools for malicious purposes", "Installing custom malware", "Exploiting zero-days", "Social engineering"], answer: 0, explanation: "LOTL abuses native binaries (PowerShell, WMI, rundll32, etc.) to evade detection." },
                    { domain: 2, type: 'single', question: "What is the main purpose of a security information and event management (SIEM) system?", options: ["Collect, correlate, and analyze logs for threat detection", "Encrypt data at rest", "Manage user permissions", "Block malicious IPs"], answer: 0, explanation: "SIEM provides centralized log management and real-time alerting." },
                    { domain: 2, type: 'single', question: "Which is a key component of defense-in-depth?", options: ["Multiple layers of security controls", "Single strong firewall", "Password complexity only", "Antivirus alone"], answer: 0, explanation: "Defense-in-depth uses overlapping controls so one failure doesn‚Äôt compromise the whole system." },
                    { domain: 2, type: 'single', question: "What does a WAF primarily protect against?", options: ["Web application attacks (XSS, SQLi, CSRF)", "DDoS", "Malware downloads", "Brute-force logins"], answer: 0, explanation: "Web Application Firewall filters HTTP traffic to block application-layer attacks." },
                    { domain: 2, type: 'single', question: "Which is the strongest form of multi-factor authentication?", options: ["Hardware token + biometrics", "SMS code", "Email OTP", "Security question"], answer: 0, explanation: "Phishing-resistant MFA (hardware tokens, FIDO2) is strongest." },
                    { domain: 3, type: 'single', question: "Which protocol provides secure file transfer with authentication and encryption?", options: ["SFTP", "FTP", "TFTP", "HTTP"], answer: 0, explanation: "SFTP (SSH File Transfer Protocol) is encrypted and authenticated." },
                    { domain: 3, type: 'single', question: "What is the BEST key management practice for long-term storage?", options: ["Use hardware security module (HSM)", "Store keys in config files", "Use same key for all services", "No rotation needed"], answer: 0, explanation: "HSMs protect keys from extraction and provide secure crypto operations." },
                    { domain: 3, type: 'single', question: "Which is a secure way to implement single sign-on?", options: ["SAML 2.0 or OIDC", "Shared passwords across apps", "Basic auth", "No SSO"], answer: 0, explanation: "SAML/OIDC enable federated SSO with strong tokens." },
                    { domain: 3, type: 'single', question: "What should be enabled on wireless networks to prevent rogue access points?", options: ["802.1X / WPA-Enterprise", "WPA2-Personal", "Open network", "MAC filtering only"], answer: 0, explanation: "802.1X with RADIUS authenticates users/devices and prevents unauthorized APs." },
                    { domain: 3, type: 'single', question: "Which control protects against side-channel attacks on cryptographic implementations?", options: ["Constant-time operations", "Stronger keys", "Key rotation", "Salting"], answer: 0, explanation: "Constant-time crypto prevents timing attacks that leak info." },
                    { domain: 4, type: 'single', question: "What is the purpose of a honeypot?", options: ["Attract and detect attackers", "Store backups", "Encrypt traffic", "Manage patches"], answer: 0, explanation: "Honeypots lure attackers to study tactics and alert on compromise." },
                    { domain: 4, type: 'single', question: "Which tool is used for network traffic analysis in incident response?", options: ["Wireshark", "Nmap", "Metasploit", "Burp Suite"], answer: 0, explanation: "Wireshark captures and analyzes packets for anomalies." },
                    { domain: 5, type: 'single', question: "What is the purpose of a data classification policy?", options: ["Label data by sensitivity to apply controls", "Encrypt all data", "Delete old data", "Share freely"], answer: 0, explanation: "Classification determines handling (confidential, public, etc.)." },
                    { domain: 3, type: 'single', question: "Which protocol should NEVER be used for secure remote administration?", options: ["Telnet", "SSH", "RDP with TLS", "WinRM over HTTPS"], answer: 0, explanation: "Telnet transmits credentials and data in plaintext ‚Äî always avoid it." },
                    { domain: 3, type: 'single', question: "What is the primary purpose of certificate revocation lists (CRLs)?", options: ["List certificates that are no longer valid", "Store public keys", "Encrypt traffic", "Authenticate users"], answer: 0, explanation: "CRLs (and OCSP) inform relying parties which certificates have been revoked." },
                    { domain: 3, type: 'single', question: "Which is the strongest password hashing algorithm currently recommended?", options: ["Argon2", "MD5", "SHA-1", "DES"], answer: 0, explanation: "Argon2 is memory-hard and resistant to GPU/ASIC cracking attacks." },
                    { domain: 3, type: 'single', question: "What does EDR stand for in endpoint security?", options: ["Endpoint Detection and Response", "Enterprise Data Recovery", "Encrypted Disk Recovery", "Extended Detection Range"], answer: 0, explanation: "EDR provides continuous monitoring, threat hunting, and response on endpoints." },
                    { domain: 3, type: 'single', question: "Which control prevents unauthorized software execution on endpoints?", options: ["Application allowlisting / whitelisting", "Antivirus signature scanning only", "Firewall rules", "User account control"], answer: 0, explanation: "Allowlisting runs only approved applications ‚Äî very strong against unknown malware." },
                    { domain: 3, type: 'single', question: "What is the BEST way to protect against pass-the-hash attacks?", options: ["Restrict NTLM usage, enforce Kerberos, use LAPS", "Longer passwords", "MFA on all accounts", "Patch management only"], answer: 0, explanation: "Restrict NTLM (disable fallback), enforce Kerberos, and use LAPS for local admin passwords." },
                    { domain: 3, type: 'single', question: "Which protocol provides mutual authentication and encryption for web traffic?", options: ["TLS 1.3", "SSL 3.0", "HTTP/2", "IPsec"], answer: 0, explanation: "Modern TLS provides confidentiality, integrity, and authentication." },
                    { domain: 3, type: 'single', question: "What is FIDO2 used for?", options: ["Passwordless authentication with public-key cryptography", "Symmetric encryption", "Hashing passwords", "VPN tunneling"], answer: 0, explanation: "FIDO2 (WebAuthn + CTAP) enables strong, phishing-resistant passwordless login." },
                    { domain: 3, type: 'single', question: "Which is a secure way to handle API authentication?", options: ["OAuth 2.0 with JWT bearer tokens", "Basic auth over HTTP", "API keys in URL query string", "Shared secret in plaintext"], answer: 0, explanation: "OAuth 2.0 + JWTs (with short expiration) is secure and scalable." },
                    { domain: 4, type: 'single', question: "What is the purpose of a chain of custody in digital forensics?", options: ["Document handling of evidence to ensure integrity and admissibility", "Speed up incident response", "Encrypt forensic images", "Delete evidence after analysis"], answer: 0, explanation: "Chain of custody proves evidence was not tampered with." },
                    { domain: 4, type: 'single', question: "Which command-line tool is used to capture network traffic on Windows?", options: ["pktmon", "netstat", "nslookup", "tracert"], answer: 0, explanation: "Packet Monitor (pktmon) is the built-in packet capture tool in modern Windows." },
                    { domain: 4, type: 'single', question: "What is volatile data in incident response?", options: ["Data lost on power-off (RAM, running processes, connections)", "Files on disk", "Log files", "Backups"], answer: 0, explanation: "Volatile data must be collected first as it disappears when the system shuts down." },
                    { domain: 4, type: 'single', question: "Which is the correct order of volatility in forensics?", options: ["Registers/cache ‚Üí RAM ‚Üí swap ‚Üí disk ‚Üí backups", "Disk ‚Üí RAM ‚Üí registers", "Backups ‚Üí disk ‚Üí RAM", "RAM ‚Üí disk ‚Üí backups"], answer: 0, explanation: "Collect most volatile first: CPU registers ‚Üí memory ‚Üí disk ‚Üí archival media." },
                    { domain: 4, type: 'single', question: "What is the purpose of a jump bag in incident response?", options: ["Pre-packed toolkit with forensics tools, cables, bootable media", "Backup storage", "Communication device", "Documentation folder"], answer: 0, explanation: "Jump bag contains ready-to-go tools for rapid response." },
                    { domain: 4, type: 'single', question: "Which log source is critical for detecting privilege escalation?", options: ["Security event log (Event ID 4672/4673)", "Application log", "System log", "DNS log"], answer: 0, explanation: "Event ID 4672/4673 shows new privileges assigned to tokens." },
                    { domain: 5, type: 'single', question: "Which framework provides control objectives for information security?", options: ["COBIT", "NIST CSF", "ISO 27001", "All are valid"], answer: 3, explanation: "All provide governance, risk, and compliance guidance." },
                    { domain: 5, type: 'single', question: "What is the purpose of a business impact analysis (BIA)?", options: ["Identify critical assets and recovery time objectives", "Encrypt data", "Manage user access", "Patch systems"], answer: 0, explanation: "BIA determines impact of disruptions and prioritizes recovery." },
                    { domain: 5, type: 'single', question: "Which regulation requires protection of payment card data?", options: ["PCI DSS", "HIPAA", "GDPR", "SOX"], answer: 0, explanation: "Payment Card Industry Data Security Standard protects cardholder data." },
                    { domain: 2, type: 'single', question: "What is the primary benefit of network segmentation?", options: ["Limits lateral movement during a breach", "Increases bandwidth", "Simplifies management", "Reduces patching needs"], answer: 0, explanation: "Segmentation contains threats to smaller zones." },
                    { domain: 2, type: 'single', question: "Which is a compensating control when encryption is not possible?", options: ["Tokenization", "Strong access controls", "Air-gapping", "All can be compensating"], answer: 3, explanation: "Compensating controls provide alternative protection when primary controls can't be used." },
                    { domain: 3, type: 'single', question: "Which is the most secure key exchange method in modern TLS?", options: ["ECDHE (Elliptic Curve Diffie-Hellman Ephemeral)", "RSA key exchange", "Static Diffie-Hellman", "PSK (Pre-Shared Key)"], answer: 0, explanation: "ECDHE provides forward secrecy by generating ephemeral keys for each session." },
                    { domain: 3, type: 'single', question: "What is the purpose of Secure Boot?", options: ["Verify integrity of boot components using digital signatures", "Encrypt the disk", "Hide boot process", "Speed up startup"], answer: 0, explanation: "Secure Boot prevents unauthorized code from loading during boot." },
                    { domain: 3, type: 'single', question: "Which control prevents unauthorized changes to configuration files?", options: ["File integrity monitoring (FIM)", "Antivirus", "Firewall", "User permissions only"], answer: 0, explanation: "FIM alerts on unexpected changes to critical files (e.g., Tripwire, OSSEC)." },
                    { domain: 3, type: 'single', question: "What is the best practice for managing privileged accounts?", options: ["Use just-in-time (JIT) access and Privileged Access Management (PAM)", "Give permanent admin rights", "Share admin credentials", "No monitoring needed"], answer: 0, explanation: "PAM + JIT reduces standing privileges and logs access." },
                    { domain: 3, type: 'single', question: "Which protocol is used for secure email transmission?", options: ["S/MIME or PGP", "SMTP", "POP3", "IMAP"], answer: 0, explanation: "S/MIME provides encryption and signing for email messages." },
                    { domain: 3, type: 'single', question: "What does UEFI Secure Boot protect against?", options: ["Bootkit and rootkit infections during startup", "Network attacks", "Phishing", "Data exfiltration"], answer: 0, explanation: "UEFI Secure Boot verifies signed bootloaders and OS kernels." },
                    { domain: 3, type: 'single', question: "Which is a secure alternative to storing secrets in environment variables?", options: ["Use a secrets management service (HashiCorp Vault, AWS Secrets Manager)", "Hardcode in source code", "Store in plaintext config files", "Share via email"], answer: 0, explanation: "Secrets managers provide rotation, auditing, and least-privilege access." },
                    { domain: 3, type: 'single', question: "What is the purpose of input validation in secure coding?", options: ["Prevent injection attacks and buffer overflows", "Speed up application", "Encrypt data", "Log user activity"], answer: 0, explanation: "Validation ensures only expected data is processed." },
                    { domain: 3, type: 'single', question: "Which is the strongest form of device authentication?", options: ["Certificate-based authentication", "Username/password", "SMS OTP", "Security questions"], answer: 0, explanation: "Certificates (with private keys) are phishing-resistant and strong." },
                    { domain: 4, type: 'single', question: "Which tool is commonly used for memory forensics?", options: ["Volatility", "Wireshark", "Nmap", "Burp Suite"], answer: 0, explanation: "Volatility analyzes memory dumps for malware artifacts, hidden processes, etc." },
                    { domain: 4, type: 'single', question: "What is the first step when handling a suspected ransomware infection?", options: ["Isolate the infected system", "Pay the ransom", "Run full antivirus scan", "Reboot"], answer: 0, explanation: "Containment: isolate to prevent spread." },
                    { domain: 4, type: 'single', question: "Which log source records user logon events on Windows?", options: ["Security log (Event ID 4624)", "System log", "Application log", "DNS log"], answer: 0, explanation: "Event ID 4624 = successful logon." },
                    { domain: 4, type: 'single', question: "What is the purpose of a forensic disk image?", options: ["Create bit-for-bit copy of storage for analysis without altering original", "Compress data", "Encrypt evidence", "Delete original"], answer: 0, explanation: "Imaging preserves original evidence integrity." },
                    { domain: 4, type: 'single', question: "Which phase of incident response involves restoring systems from backups?", options: ["Recovery", "Containment", "Eradication", "Detection"], answer: 0, explanation: "Recovery restores operations after eradication." },
                    { domain: 4, type: 'single', question: "What should be done with evidence before analysis?", options: ["Create hash to verify integrity", "Open in editor", "Delete after use", "Share publicly"], answer: 0, explanation: "Hashing (MD5/SHA) proves no tampering occurred." },
                    { domain: 4, type: 'single', question: "Which is a common indicator of compromise in logs?", options: ["Unusual outbound connections to unknown IPs", "Normal user logins", "Routine patch installs", "Scheduled backups"], answer: 0, explanation: "C2 or exfiltration often shows suspicious network traffic." },

                    { domain: 5, type: 'single', question: "What is the purpose of a third-party risk management program?", options: ["Assess and monitor vendor security posture", "Encrypt vendor data", "Share passwords with vendors", "Ignore vendor risks"], answer: 0, explanation: "TPRM identifies and mitigates supply-chain risks." },
                    { domain: 5, type: 'single', question: "Which framework is widely used for cybersecurity risk management?", options: ["NIST Cybersecurity Framework (CSF)", "COBIT", "ISO 27001", "All are valid"], answer: 3, explanation: "All provide risk management guidance." },
                    { domain: 5, type: 'single', question: "What is a security awareness training program designed to reduce?", options: ["Human error and social engineering success rate", "Hardware failures", "Network latency", "Storage costs"], answer: 0, explanation: "Training reduces phishing click rates and policy violations." },

                    { domain: 2, type: 'single', question: "What is the main advantage of using a reverse proxy?", options: ["Hide backend servers and provide load balancing / WAF", "Increase latency", "Store data", "Encrypt client-side"], answer: 0, explanation: "Reverse proxies protect origin servers and add security layers." },
                    { domain: 2, type: 'single', question: "Which is a key principle of secure system design?", options: ["Fail securely / fail-safe defaults", "Allow all by default", "Single point of failure", "No logging"], answer: 0, explanation: "Fail-safe defaults deny access unless explicitly allowed." },
                    { domain: 3, type: 'single', question: "Which is the recommended cipher suite for TLS 1.3?", options: ["TLS_AES_256_GCM_SHA384", "TLS_RSA_WITH_AES_128_CBC_SHA", "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384", "SSLv3"], answer: 0, explanation: "TLS 1.3 only supports modern AEAD ciphers like AES-GCM with SHA384." },
                    { domain: 3, type: 'single', question: "What is the purpose of HSTS (HTTP Strict Transport Security)?", options: ["Force HTTPS and prevent downgrade attacks", "Encrypt cookies", "Speed up page loads", "Block JavaScript"], answer: 0, explanation: "HSTS tells browsers to only use HTTPS for a domain, preventing MITM downgrade." },
                    { domain: 3, type: 'single', question: "Which endpoint protection technique blocks unknown executables?", options: ["Application control / allowlisting", "Signature-based antivirus", "Firewall rules", "User training"], answer: 0, explanation: "Allowlisting runs only approved apps ‚Äî very effective against zero-days." },
                    { domain: 3, type: 'single', question: "What is the best practice for managing SSH keys?", options: ["Use passphrase-protected private keys + ssh-agent", "Share private keys", "Store keys in plaintext", "Disable key auth"], answer: 0, explanation: "Passphrases add protection; ssh-agent avoids repeated passphrase entry." },
                    { domain: 3, type: 'single', question: "Which is a secure alternative to basic authentication?", options: ["Digest authentication", "OAuth 2.0", "NTLM", "LDAP"], answer: 1, explanation: "OAuth 2.0 provides token-based auth with scopes and revocation." },
                    { domain: 3, type: 'single', question: "What does ASLR protect against?", options: ["Memory corruption exploits by randomizing memory layout", "Brute-force logins", "Phishing", "Data exfiltration"], answer: 0, explanation: "Address Space Layout Randomization makes buffer overflows harder to exploit predictably." },
                    { domain: 3, type: 'single', question: "Which is the strongest wireless encryption standard?", options: ["WPA3", "WPA2", "WEP", "Open"], answer: 0, explanation: "WPA3 uses SAE and stronger key derivation; resists offline attacks." },
                    { domain: 3, type: 'single', question: "What is the purpose of DEP (Data Execution Prevention)?", options: ["Prevent execution of code in data memory regions", "Encrypt memory", "Speed up execution", "Hide processes"], answer: 0, explanation: "DEP marks data pages non-executable to stop code injection." },
                    { domain: 3, type: 'single', question: "Which is a secure way to handle session tokens?", options: ["Use HttpOnly + Secure + SameSite cookies", "Store in URL", "Store in localStorage", "No expiration"], answer: 0, explanation: "HttpOnly prevents JS access; Secure forces HTTPS; SameSite blocks CSRF." },
                    { domain: 4, type: 'single', question: "Which command is used to create a forensic disk image on Linux?", options: ["dd if=/dev/sda of=image.dd bs=4M conv=noerror,sync", "cp /dev/sda image.dd", "tar -cf image.tar /dev/sda", "rsync /dev/sda image.dd"], answer: 0, explanation: "dd with conv=noerror,sync ensures bit-for-bit copy even on read errors." },
                    { domain: 4, type: 'single', question: "What is the purpose of sandboxing in incident response?", options: ["Analyze suspicious files safely without risking the host", "Encrypt evidence", "Delete malware", "Notify users"], answer: 0, explanation: "Sandboxes (Cuckoo, Hybrid Analysis) detonate malware in isolation." },
                    { domain: 4, type: 'single', question: "Which is a common indicator of compromise in Windows Event Logs?", options: ["Event ID 4624 with unknown IP", "Event ID 6000", "Event ID 7036", "Event ID 1000"], answer: 0, explanation: "4624 shows logons; unknown IP can indicate lateral movement." },
                    { domain: 4, type: 'single', question: "What is the final phase of NIST incident response lifecycle?", options: ["Post-Incident Activity (lessons learned)", "Recovery", "Eradication", "Containment"], answer: 0, explanation: "Post-incident includes root cause analysis and process improvement." },
                    { domain: 4, type: 'single', question: "Which tool captures full packet data for network forensics?", options: ["tcpdump or Wireshark", "netstat", "nslookup", "ping"], answer: 0, explanation: "Full packet capture preserves payload for deep analysis." },
                    { domain: 4, type: 'single', question: "What should be done with a live system suspected of compromise?", options: ["Capture volatile data first (memory, connections)", "Shut down immediately", "Run antivirus", "Reboot"], answer: 0, explanation: "Volatile data is lost on shutdown ‚Äî collect first." },
                    { domain: 5, type: 'single', question: "Which regulation requires annual penetration testing?", options: ["PCI DSS", "GDPR", "HIPAA", "SOX"], answer: 0, explanation: "PCI DSS v4 requires regular pen testing." },
                    { domain: 5, type: 'single', question: "What is a risk treatment option?", options: ["Avoid, Mitigate, Transfer, Accept", "Ignore", "Delete", "Encrypt only"], answer: 0, explanation: "Standard risk treatment strategies." },
                    { domain: 5, type: 'single', question: "What does a security policy define?", options: ["High-level rules for acceptable use and controls", "Technical configs", "User passwords", "Hardware specs"], answer: 0, explanation: "Policies set organizational standards; procedures detail how to implement." },
                    { domain: 2, type: 'single', question: "What is 'resiliency' in security architecture?", options: ["Ability to withstand and recover from attacks", "Encryption strength", "Speed of detection", "User training"], answer: 0, explanation: "Resiliency includes redundancy, backups, and rapid recovery." },
                    { domain: 2, type: 'single', question: "Which is a key benefit of using a SIEM?", options: ["Centralized log correlation and alerting", "Data encryption", "Patch management", "User provisioning"], answer: 0, explanation: "SIEM detects threats by correlating events across sources." },
                    { domain: 1, type: 'single', question: "What is a 'spear-phishing' attack?", options: ["Targeted phishing against specific individuals or organizations", "Mass phishing emails", "Voice phishing", "SMS phishing"], answer: 0, explanation: "Spear-phishing is highly targeted, often using personal information for credibility." },
                    { domain: 1, type: 'single', question: "Which technique uses fake Wi-Fi hotspots to steal credentials?", options: ["Evil twin attack", "Rogue access point", "Deauthentication attack", "All of the above"], answer: 3, explanation: "Evil twin creates a rogue AP with the same SSID; deauth forces reconnection." },
                    { domain: 1, type: 'single', question: "What is the purpose of a 'beaconing' network pattern?", options: ["Regular outbound connections to a C2 server", "High inbound traffic", "DNS tunneling", "Lateral movement"], answer: 0, explanation: "Beaconing is periodic, low-volume traffic from infected hosts to command-and-control." },
                    { domain: 1, type: 'single', question: "Which attack exploits weak certificate validation in mobile apps?", options: ["SSL stripping / pinning bypass", "Man-in-the-middle", "Session fixation", "Clickjacking"], answer: 0, explanation: "Apps that don't pin certificates or disable validation are vulnerable to MITM." },
                    { domain: 1, type: 'single', question: "What is 'domain shadowing'?", options: ["Compromising a legitimate domain to host malicious subdomains", "DNS spoofing", "Domain hijacking", "Typo-squatting"], answer: 0, explanation: "Attackers use a legitimate domain they control to create malicious subdomains." },
                    { domain: 1, type: 'single', question: "Which is a common persistence mechanism on macOS?", options: ["LaunchAgents / LaunchDaemons", "Registry Run keys", "Startup folder", "Cron jobs only"], answer: 0, explanation: "LaunchAgents/LaunchDaemons run code at login or boot." },
                    { domain: 1, type: 'single', question: "What is the goal of a 'business email compromise' (BEC) attack?", options: ["Trick executives into authorizing fraudulent wire transfers", "Encrypt files", "Steal credentials", "DDoS"], answer: 0, explanation: "BEC uses social engineering to impersonate trusted senders for financial fraud." },
                    { domain: 2, type: 'single', question: "What is 'software-defined perimeter' (SDP)?", options: ["Zero Trust access model that hides resources until authenticated", "Traditional VPN", "Firewall rule set", "Load balancer"], answer: 0, explanation: "SDP makes resources invisible until identity and context are verified." },
                    { domain: 2, type: 'single', question: "Which resiliency technique uses multiple geographic regions?", options: ["Multi-region deployment", "Single AZ redundancy", "Tape backups", "RAID 0"], answer: 0, explanation: "Multi-region protects against regional outages or disasters." },
                    { domain: 2, type: 'single', question: "What is the purpose of a canary deployment?", options: ["Roll out changes to a small subset first to detect issues", "Full rollback", "Blue-green switching", "Immutable infrastructure"], answer: 0, explanation: "Canaries limit blast radius during updates." },
                    { domain: 2, type: 'single', question: "Which is a core principle of secure by design?", options: ["Security is built-in from the start", "Add security after development", "Rely on vendor defaults", "No security testing"], answer: 0, explanation: "Secure by design integrates security throughout the SDLC." },
                    { domain: 3, type: 'single', question: "Which is a secure way to implement password reset?", options: ["Time-limited token sent via email + rate limiting", "Security questions only", "No expiration token", "Plaintext reset link"], answer: 0, explanation: "Tokens must be single-use, short-lived, and rate-limited to prevent abuse." },
                    { domain: 3, type: 'single', question: "What is the purpose of a security token service (STS)?", options: ["Issue and validate security tokens (e.g., SAML, JWT)", "Encrypt traffic", "Store passwords", "Manage firewalls"], answer: 0, explanation: "STS handles federation and token issuance in SSO." },
                    { domain: 3, type: 'single', question: "Which is the strongest protection for API keys?", options: ["Store in environment variables or secrets manager", "Hardcode in code", "Store in client-side JS", "Share in docs"], answer: 0, explanation: "Secrets managers (Vault, AWS SSM) provide rotation and access control." },
                    { domain: 4, type: 'single', question: "Which is a key step in digital forensics acquisition?", options: ["Write-blocker on source drive", "Run antivirus first", "Boot normally", "Delete temp files"], answer: 0, explanation: "Write-blockers prevent accidental writes to evidence." },
                    { domain: 4, type: 'single', question: "What is 'triage' in incident response?", options: ["Prioritize incidents based on severity and impact", "Eradicate malware", "Recover systems", "Document lessons"], answer: 0, explanation: "Triage determines which incidents need immediate action." },
                    { domain: 5, type: 'single', question: "Which is a key component of a security awareness program?", options: ["Phishing simulations and training", "Firewall rules", "Patch management", "Encryption only"], answer: 0, explanation: "Simulations reduce human error and measure effectiveness." },
                    { domain: 5, type: 'single', question: "What does ISO 27001 primarily focus on?", options: ["Information security management system (ISMS)", "Network security", "Physical security", "Cloud migration"], answer: 0, explanation: "ISO 27001 is a framework for establishing, implementing, and maintaining ISMS." },
                    { domain: 1, type: 'single', question: "What is 'living-off-the-land binaries' (LOLBins)?", options: ["Legitimate system tools abused for malicious purposes", "Custom malware binaries", "Encrypted payloads", "Phishing attachments"], answer: 0, explanation: "LOLBins are native Windows tools (e.g., rundll32, regsvr32) used to evade detection." },
                    { domain: 1, type: 'single', question: "Which technique spoofs caller ID to trick victims?", options: ["Vishing with caller ID spoofing", "Smishing", "Pharming", "Phishing"], answer: 0, explanation: "Vishing attackers spoof numbers to appear legitimate." },
                    { domain: 1, type: 'single', question: "What is a 'fileless' attack?", options: ["Malware that executes entirely in memory without writing to disk", "Virus that attaches to files", "Trojan with dropper", "Ransomware that encrypts files"], answer: 0, explanation: "Fileless attacks use memory-resident code to avoid AV detection." },
                    { domain: 1, type: 'single', question: "What does 'domain generation algorithm' (DGA) do in malware?", options: ["Generates random C2 domains to evade blocklists", "Encrypts traffic", "Steals credentials", "Spreads via USB"], answer: 0, explanation: "DGA creates unpredictable domains for resilient C2 communication." },
                    { domain: 1, type: 'single', question: "Which attack uses compromised supply-chain software updates?", options: ["Supply-chain compromise", "Watering hole", "Evil twin", "Session hijacking"], answer: 0, explanation: "Attackers inject malware into trusted vendor updates (e.g., SolarWinds, NotPetya)." },
                    { domain: 2, type: 'single', question: "What is 'immutable infrastructure'?", options: ["Servers are never modified after deployment; replaced instead", "Dynamic scaling", "Manual patching", "Shared hosting"], answer: 0, explanation: "Immutable servers reduce attack surface by preventing drift." },
                    { domain: 2, type: 'single', question: "Which is a benefit of using infrastructure as code (IaC)?", options: ["Version control, repeatability, and auditability of infrastructure", "Faster hardware", "No security needed", "Manual configuration"], answer: 0, explanation: "IaC (Terraform, CloudFormation) enables secure, auditable deployments." },
                    { domain: 2, type: 'single', question: "What does 'blue-green deployment' provide?", options: ["Zero-downtime rollouts with rollback capability", "Increased latency", "Single environment risk", "Manual testing only"], answer: 0, explanation: "Blue-green switches traffic between identical environments." },
                    { domain: 2, type: 'single', question: "Which is a key Zero Trust identity pillar?", options: ["Continuous verification of identity and context", "Trust after login", "Perimeter VPN only", "Static roles"], answer: 0, explanation: "Zero Trust re-verifies identity throughout the session." },
                    { domain: 3, type: 'single', question: "Which is a secure way to implement API rate limiting?", options: ["Token bucket or leaky bucket algorithm", "No limits", "IP-based only", "User password check"], answer: 0, explanation: "Rate limiting prevents abuse and DoS on APIs." },
                    { domain: 3, type: 'single', question: "What is the purpose of a web application firewall (WAF)?", options: ["Filter malicious web requests (XSS, SQLi, etc.)", "Encrypt traffic", "Manage DNS", "Load balance"], answer: 0, explanation: "WAF inspects HTTP traffic for application-layer attacks." },
                    { domain: 3, type: 'single', question: "Which is the strongest protection against brute-force attacks?", options: ["Account lockout + CAPTCHA + rate limiting", "Long passwords only", "No MFA", "Single sign-on"], answer: 0, explanation: "Multiple layers (lockout, CAPTCHA, rate limiting) defeat brute-force." },
                    { domain: 4, type: 'single', question: "Which is a key step in evidence preservation?", options: ["Create hash of forensic image", "Open files directly", "Delete original", "Share via email"], answer: 0, explanation: "Hashing verifies integrity of copies." },
                    { domain: 4, type: 'single', question: "What is 'memory forensics' used for?", options: ["Detect fileless malware and in-memory artifacts", "Analyze disk images", "Capture network packets", "Log review"], answer: 0, explanation: "Tools like Volatility extract hidden processes from RAM." },
                    { domain: 5, type: 'single', question: "What is the purpose of a security governance framework?", options: ["Align security with business objectives", "Encrypt data", "Manage firewalls", "Patch systems"], answer: 0, explanation: "Governance ensures security supports business goals." },
                    { domain: 5, type: 'single', question: "Which is a key element of risk assessment?", options: ["Identify threats, vulnerabilities, and impact", "Ignore low risks", "Encrypt everything", "Delete data"], answer: 0, explanation: "Risk assessment quantifies likelihood and impact." },
                    { domain: 1, type: 'single', question: "What is a 'typo-squatting' attack?", options: ["Registering domains similar to legitimate ones for phishing", "Domain hijacking", "DNS spoofing", "Domain shadowing"], answer: 0, explanation: "Attackers register misspellings of real domains (e.g., googlle.com) to trick users." },
                    { domain: 1, type: 'single', question: "Which technique uses legitimate cloud services for malicious C2?", options: ["Cloud C2 or living-off-the-cloud", "Direct IP connection", "IRC channel", "HTTP only"], answer: 0, explanation: "Attackers abuse AWS S3, Azure Blob, or Google Cloud for C2 to blend in." },
                    { domain: 1, type: 'single', question: "What is the purpose of 'code signing' in malware analysis?", options: ["Verify if malware is signed by a trusted publisher", "Decrypt payloads", "Analyze strings", "Reverse engineer"], answer: 0, explanation: "Signed malware can appear legitimate; check for stolen or fake certs." },
                    { domain: 1, type: 'single', question: "Which is a common evasion technique against antivirus?", options: ["Obfuscation or packing of malicious code", "Cleartext payloads", "Signed binaries only", "No evasion"], answer: 0, explanation: "Packing/encryption hides code from signature-based detection." },
                    { domain: 1, type: 'single', question: "What is 'credential harvesting'?", options: ["Collecting usernames/passwords from breaches or phishing", "Brute-forcing", "Keylogging", "Pass-the-hash"], answer: 0, explanation: "Harvesting compiles large datasets of credentials for reuse." },
                    { domain: 2, type: 'single', question: "What is 'trust but verify' a principle of?", options: ["Zero Trust", "Perimeter security", "Defense-in-depth", "Implicit trust"], answer: 0, explanation: "Zero Trust assumes breach and verifies every access." },
                    { domain: 2, type: 'single', question: "Which is a key benefit of using a CASB (Cloud Access Security Broker)?", options: ["Enforce policies on SaaS apps (DLP, threat protection)", "Encrypt data at rest", "Manage on-prem firewalls", "Host applications"], answer: 0, explanation: "CASB provides visibility and control over cloud services." },
                    { domain: 2, type: 'single', question: "What does 'segmentation' prevent in a breach?", options: ["Lateral movement", "Initial access", "Data exfiltration", "Social engineering"], answer: 0, explanation: "Segmentation limits attackers to a single zone." },
                    { domain: 2, type: 'single', question: "Which is a secure design practice for APIs?", options: ["Use OAuth 2.0 + rate limiting + input validation", "Open access", "No authentication", "Store tokens in URLs"], answer: 0, explanation: "Secure APIs need auth, rate limits, and validation." },
                    { domain: 3, type: 'single', question: "Which is the strongest protection against rainbow table attacks?", options: ["Salting passwords before hashing", "Longer passwords", "MFA", "No salting"], answer: 0, explanation: "Salts make precomputed tables useless." },
                    { domain: 3, type: 'single', question: "What is the purpose of a certificate transparency log?", options: ["Publicly log issued certificates to detect rogue ones", "Encrypt traffic", "Revoke certificates", "Validate signatures"], answer: 0, explanation: "CT logs allow monitoring for unauthorized cert issuance." },
                    { domain: 3, type: 'single', question: "Which is a secure way to handle temporary credentials?", options: ["Use AWS STS or Azure Managed Identities for short-lived tokens", "Long-term access keys", "Hardcode in code", "Share with team"], answer: 0, explanation: "Short-lived tokens reduce risk if compromised." },
                    { domain: 3, type: 'single', question: "What is 'secure coding'?", options: ["Writing code with security principles to prevent vulnerabilities", "Adding antivirus", "Patching after release", "No code review"], answer: 0, explanation: "Secure coding includes input validation, error handling, etc." },
                    { domain: 4, type: 'single', question: "Which is a common forensic tool for timeline analysis?", options: ["Autopsy or plaso", "Wireshark", "Metasploit", "Nmap"], answer: 0, explanation: "Tools like Autopsy create timelines from event logs and files." },
                    { domain: 4, type: 'single', question: "What is the purpose of 'eradication' in incident response?", options: ["Remove root cause and all malware", "Contain the incident", "Recover systems", "Detect threats"], answer: 0, explanation: "Eradication ensures the threat is fully removed." },
                    { domain: 5, type: 'single', question: "What is the purpose of a security audit?", options: ["Independent review to ensure compliance and effectiveness", "Daily log review", "Patch management", "User training"], answer: 0, explanation: "Audits verify controls are working as intended." },
                    { domain: 5, type: 'single', question: "Which is a key element of a disaster recovery plan (DRP)?", options: ["Recovery time objective (RTO) and recovery point objective (RPO)", "Incident response only", "Risk assessment", "Policy writing"], answer: 0, explanation: "RTO/RPO define acceptable downtime and data loss." },
                    { domain: 1, type: 'single', question: "What is a 'watering hole' attack?", options: ["Compromising websites frequented by a target group", "Mass phishing emails", "Voice phishing", "SMS phishing"], answer: 0, explanation: "Attackers poison legitimate sites that targets visit." },
                    { domain: 1, type: 'single', question: "Which technique uses compromised legitimate software for C2?", options: ["Living-off-the-land", "Fileless malware", "Cloud C2", "All of the above"], answer: 3, explanation: "All leverage trusted tools/services to evade detection." },
                    { domain: 1, type: 'single', question: "What is 'credential stuffing'?", options: ["Using leaked username/password pairs on many sites", "Brute-forcing", "Keylogging", "Pass-the-hash"], answer: 0, explanation: "Reuses credentials from breaches across services." },
                    { domain: 1, type: 'single', question: "Which attack spoofs ARP to redirect traffic?", options: ["ARP poisoning", "DNS spoofing", "DHCP starvation", "MAC flooding"], answer: 0, explanation: "Associates attacker MAC with victim IP." },
                    { domain: 1, type: 'single', question: "What is the goal of a 'business email compromise' (BEC)?", options: ["Trick executives into fraudulent transfers", "Encrypt files", "Steal credentials", "DDoS"], answer: 0, explanation: "BEC impersonates trusted senders for financial fraud." },
                    { domain: 1, type: 'single', question: "What is 'domain generation algorithm' (DGA)?", options: ["Generates random C2 domains to evade blocklists", "Encrypts traffic", "Steals credentials", "Spreads via USB"], answer: 0, explanation: "DGA creates unpredictable domains for resilient C2." },
                    { domain: 2, type: 'single', question: "What is the primary benefit of network segmentation?", options: ["Limits lateral movement during breach", "Increases bandwidth", "Simplifies management", "Reduces patching"], answer: 0, explanation: "Segmentation contains threats to smaller zones." },
                    { domain: 2, type: 'single', question: "Which is a core Zero Trust principle?", options: ["Never trust, always verify", "Trust internal network", "Perimeter only", "Implicit trust"], answer: 0, explanation: "Zero Trust assumes breach and verifies every access." },
                    { domain: 2, type: 'single', question: "What does 'micro-segmentation' provide?", options: ["Granular access controls between workloads", "One big flat network", "Only firewall at edge", "No segmentation"], answer: 0, explanation: "Limits lateral movement with fine-grained policies." },
                    { domain: 2, type: 'single', question: "Which resiliency technique uses multiple AZs?", options: ["High availability", "Single region", "Tape backups", "RAID 0"], answer: 0, explanation: "Multi-AZ protects against zone failures." },
                    { domain: 3, type: 'single', question: "Which is the strongest wireless security standard?", options: ["WPA3", "WPA2", "WEP", "Open"], answer: 0, explanation: "WPA3 uses SAE and resists offline attacks." },
                    { domain: 3, type: 'single', question: "What is the purpose of HSTS?", options: ["Force HTTPS and prevent downgrade attacks", "Encrypt cookies", "Speed up loads", "Block JS"], answer: 0, explanation: "HSTS prevents MITM downgrade." },
                    { domain: 3, type: 'single', question: "Which is a secure way to store secrets?", options: ["Secrets manager (Vault, AWS Secrets Manager)", "Hardcode in code", "Env variables only", "Share in email"], answer: 0, explanation: "Secrets managers provide rotation and auditing." },
                    { domain: 3, type: 'single', question: "What is FIDO2?", options: ["Passwordless authentication with public-key crypto", "Symmetric encryption", "Hashing", "VPN"], answer: 0, explanation: "FIDO2 enables phishing-resistant login." },
                    { domain: 4, type: 'single', question: "Which tool is used for memory forensics?", options: ["Volatility", "Wireshark", "Nmap", "Burp"], answer: 0, explanation: "Volatility extracts hidden processes from RAM dumps." },
                    { domain: 4, type: 'single', question: "What is chain of custody?", options: ["Documentation of evidence handling", "Speed up IR", "Encrypt images", "Delete evidence"], answer: 0, explanation: "Ensures evidence integrity for legal use." },
                    { domain: 5, type: 'single', question: "What is a risk register?", options: ["Document of identified risks and mitigations", "Log file", "Policy document", "Training material"], answer: 0, explanation: "Central record for risk management." },
                    { domain: 5, type: 'single', question: "Which regulation protects health information?", options: ["HIPAA", "GDPR", "PCI DSS", "SOX"], answer: 0, explanation: "Health Insurance Portability and Accountability Act." },
                    { domain: 1, type: 'single', question: "What is 'typo-squatting'?", options: ["Registering domains similar to legitimate ones to trick users", "Domain hijacking", "DNS poisoning", "Domain shadowing"], answer: 0, explanation: "Attackers register misspellings (e.g., g00gle.com) for phishing." },
                    { domain: 1, type: 'single', question: "Which technique uses legitimate cloud services for C2?", options: ["Living-off-the-cloud", "Direct IP C2", "IRC channel", "HTTP beaconing"], answer: 0, explanation: "Abuses AWS S3, Azure Blob, etc. to blend in with normal traffic." },
                    { domain: 1, type: 'single', question: "What is the purpose of code signing in malware?", options: ["Make malware appear legitimate", "Encrypt payloads", "Analyze strings", "Reverse engineer"], answer: 0, explanation: "Signed malware can bypass some trust checks; check for stolen certs." },
                    { domain: 1, type: 'single', question: "Which is a common evasion against signature-based AV?", options: ["Obfuscation and packing", "Cleartext payloads", "Signed binaries only", "No evasion"], answer: 0, explanation: "Packing hides code from static signature detection." },
                    { domain: 1, type: 'single', question: "What is 'credential harvesting'?", options: ["Collecting credentials from breaches or phishing kits", "Brute-forcing", "Keylogging", "Pass-the-hash"], answer: 0, explanation: "Compiles large lists for credential stuffing." },
                    { domain: 1, type: 'single', question: "Which attack uses compromised legitimate software updates?", options: ["Supply-chain compromise", "Watering hole", "Evil twin", "Session hijacking"], answer: 0, explanation: "Malware in trusted vendor updates (SolarWinds, NotPetya)." },
                    { domain: 1, type: 'single', question: "What is 'domain shadowing'?", options: ["Using a legitimate domain to host malicious subdomains", "DNS spoofing", "Domain hijacking", "Typo-squatting"], answer: 0, explanation: "Attackers control a domain to create malicious subdomains." },
                    { domain: 1, type: 'single', question: "Which is a persistence method on macOS?", options: ["LaunchAgents / LaunchDaemons", "Registry Run keys", "Startup folder", "Cron jobs only"], answer: 0, explanation: "LaunchAgents/LaunchDaemons run code at login/boot." },
                    { domain: 1, type: 'single', question: "What is BEC (Business Email Compromise)?", options: ["Tricking executives into fraudulent transfers via email spoofing", "Encrypting files", "Stealing credentials", "DDoS"], answer: 0, explanation: "Social engineering for financial fraud." },
                    { domain: 1, type: 'single', question: "What does DGA stand for in malware?", options: ["Domain Generation Algorithm", "Data Generation Attack", "Direct Gateway Access", "Domain Guard Attack"], answer: 0, explanation: "Generates random C2 domains to evade blocklists." },
                    { domain: 2, type: 'single', question: "What is 'immutable infrastructure'?", options: ["Servers replaced instead of modified", "Dynamic scaling", "Manual patching", "Shared hosting"], answer: 0, explanation: "Reduces drift and attack surface." },
                    { domain: 2, type: 'single', question: "Which is a benefit of IaC?", options: ["Version control, repeatability, auditability", "Faster hardware", "No security needed", "Manual config"], answer: 0, explanation: "Terraform/CloudFormation enables secure deployments." },
                    { domain: 2, type: 'single', question: "What does blue-green deployment provide?", options: ["Zero-downtime rollouts with rollback", "Increased latency", "Single environment risk", "Manual testing"], answer: 0, explanation: "Switches traffic between identical environments." },
                    { domain: 2, type: 'single', question: "Which is a Zero Trust identity pillar?", options: ["Continuous verification", "Trust after login", "Perimeter VPN only", "Static roles"], answer: 0, explanation: "Re-verifies identity throughout session." },
                    { domain: 2, type: 'single', question: "What is a key benefit of CASB?", options: ["Enforce policies on SaaS apps (DLP, threat protection)", "Encrypt data at rest", "Manage on-prem firewalls", "Host applications"], answer: 0, explanation: "Visibility and control over cloud services." },
                    { domain: 2, type: 'single', question: "What does segmentation prevent in a breach?", options: ["Lateral movement", "Initial access", "Data exfiltration", "Social engineering"], answer: 0, explanation: "Limits attackers to one zone." },
                    { domain: 2, type: 'single', question: "Which is secure by design?", options: ["Security built-in from start", "Add security later", "Vendor defaults", "No testing"], answer: 0, explanation: "Integrates security in SDLC." },
                    { domain: 3, type: 'single', question: "Which is strongest wireless security?", options: ["WPA3", "WPA2", "WEP", "Open"], answer: 0, explanation: "WPA3 resists offline attacks." },
                    { domain: 3, type: 'single', question: "What does HSTS do?", options: ["Force HTTPS, prevent downgrade", "Encrypt cookies", "Speed loads", "Block JS"], answer: 0, explanation: "Prevents MITM downgrade." },
                    { domain: 3, type: 'single', question: "Best way to store secrets?", options: ["Secrets manager", "Hardcode", "Env vars only", "Email"], answer: 0, explanation: "Vault/AWS Secrets Manager for rotation/auditing." },
                    { domain: 3, type: 'single', question: "What is FIDO2?", options: ["Passwordless public-key auth", "Symmetric encryption", "Hashing", "VPN"], answer: 0, explanation: "Phishing-resistant login." },
                    { domain: 3, type: 'single', question: "What is ASLR?", options: ["Randomizes memory layout", "Encrypts memory", "Speeds execution", "Hides processes"], answer: 0, explanation: "Makes buffer overflows harder." },
                    { domain: 3, type: 'single', question: "What is Secure Boot?", options: ["Verifies boot components signatures", "Encrypts disk", "Hides boot", "Speeds startup"], answer: 0, explanation: "Prevents unauthorized boot code." },
                    { domain: 3, type: 'single', question: "Best privileged account management?", options: ["JIT + PAM", "Permanent admin", "Shared creds", "No monitoring"], answer: 0, explanation: "Reduces standing privileges." },
                    { domain: 4, type: 'single', question: "What is chain of custody?", options: ["Evidence handling documentation", "Speed IR", "Encrypt images", "Delete evidence"], answer: 0, explanation: "Ensures integrity for legal use." },
                    { domain: 4, type: 'single', question: "What is memory forensics for?", options: ["Detect fileless malware", "Disk analysis", "Packet capture", "Log review"], answer: 0, explanation: "Volatility extracts in-memory artifacts." },
                    { domain: 4, type: 'single', question: "What is triage in IR?", options: ["Prioritize incidents", "Eradicate malware", "Recover systems", "Document lessons"], answer: 0, explanation: "Determines immediate action." },

                    { domain: 5, type: 'single', question: "What is a security audit?", options: ["Independent compliance review", "Daily log review", "Patch management", "User training"], answer: 0, explanation: "Verifies controls work." },
                    { domain: 5, type: 'single', question: "What is DRP key element?", options: ["RTO and RPO", "IR only", "Risk assessment", "Policy"], answer: 0, explanation: "Defines downtime/data loss tolerance." },
                    { domain: 1, type: 'single', question: "What is 'typo-squatting'?", options: ["Registering domains similar to legitimate ones to trick users", "Domain hijacking", "DNS poisoning", "Domain shadowing"], answer: 0, explanation: "Attackers register misspellings (e.g., g00gle.com) for phishing." },
                    { domain: 1, type: 'single', question: "Which technique uses legitimate cloud services for C2?", options: ["Living-off-the-cloud", "Direct IP C2", "IRC channel", "HTTP beaconing"], answer: 0, explanation: "Abuses AWS S3, Azure Blob, etc. to blend in with normal traffic." },
                    { domain: 1, type: 'single', question: "What is the purpose of code signing in malware?", options: ["Make malware appear legitimate", "Encrypt payloads", "Analyze strings", "Reverse engineer"], answer: 0, explanation: "Signed malware can bypass some trust checks; check for stolen certs." },
                    { domain: 1, type: 'single', question: "Which is a common evasion against signature-based AV?", options: ["Obfuscation and packing", "Cleartext payloads", "Signed binaries only", "No evasion"], answer: 0, explanation: "Packing hides code from static signature detection." },
                    { domain: 1, type: 'single', question: "What is 'credential harvesting'?", options: ["Collecting credentials from breaches or phishing kits", "Brute-forcing", "Keylogging", "Pass-the-hash"], answer: 0, explanation: "Compiles large lists for credential stuffing." },
                    { domain: 1, type: 'single', question: "Which attack uses compromised legitimate software updates?", options: ["Supply-chain compromise", "Watering hole", "Evil twin", "Session hijacking"], answer: 0, explanation: "Malware in trusted vendor updates (SolarWinds, NotPetya)." },
                    { domain: 1, type: 'single', question: "What is 'domain shadowing'?", options: ["Using a legitimate domain to host malicious subdomains", "DNS spoofing", "Domain hijacking", "Typo-squatting"], answer: 0, explanation: "Attackers control a domain to create malicious subdomains." },
                    { domain: 1, type: 'single', question: "Which is a persistence method on macOS?", options: ["LaunchAgents / LaunchDaemons", "Registry Run keys", "Startup folder", "Cron jobs only"], answer: 0, explanation: "LaunchAgents/LaunchDaemons run code at login/boot." },
                    { domain: 1, type: 'single', question: "What is BEC (Business Email Compromise)?", options: ["Tricking executives into fraudulent transfers via email spoofing", "Encrypting files", "Stealing credentials", "DDoS"], answer: 0, explanation: "Social engineering for financial fraud." },
                    { domain: 1, type: 'single', question: "What does DGA stand for in malware?", options: ["Domain Generation Algorithm", "Data Generation Attack", "Direct Gateway Access", "Domain Guard Attack"], answer: 0, explanation: "Generates random C2 domains to evade blocklists." },
                    { domain: 1, type: 'single', question: "What is 'vishing'?", options: ["Voice phishing", "SMS phishing", "Email phishing", "Spear phishing"], answer: 0, explanation: "Vishing uses phone calls to trick users." },
                    { domain: 1, type: 'single', question: "Which is a common post-exploitation technique?", options: ["Pass-the-hash", "Golden ticket", "Silver ticket", "All are valid"], answer: 3, explanation: "All are Mimikatz-style credential attacks." },
                    { domain: 1, type: 'single', question: "What is the goal of a rootkit?", options: ["Hide presence of malware", "Encrypt files", "Steal credentials", "Spread via USB"], answer: 0, explanation: "Rootkits hide processes, files, and network activity." },
                    { domain: 1, type: 'single', question: "Which attack exploits unvalidated redirects?", options: ["Open redirect", "Phishing", "CSRF", "XSS"], answer: 0, explanation: "Open redirects trick users into visiting malicious sites via trusted domains." },
                    { domain: 1, type: 'single', question: "What is 'credential stuffing'?", options: ["Using leaked username/password pairs on many sites", "Brute-forcing", "Keylogging", "Phishing for credentials"], answer: 0, explanation: "Reuses credentials from breaches." },
                    { domain: 1, type: 'single', question: "What is a 'watering hole' attack?", options: ["Compromising websites frequented by targets", "Mass phishing", "Voice phishing", "SMS phishing"], answer: 0, explanation: "Poison legitimate sites the target group visits." },
                    { domain: 1, type: 'single', question: "Which is a fileless malware technique?", options: ["Living-off-the-land binaries (LOLBins)", "PowerShell in memory", "Registry Run keys", "All of the above"], answer: 3, explanation: "Fileless avoids disk writes." },
                    { domain: 1, type: 'single', question: "What is 'Kerberoasting'?", options: ["Offline cracking of Kerberos service tickets", "NTLM hash cracking", "LDAP query abuse", "SAML assertion theft"], answer: 0, explanation: "Requests service tickets for offline cracking." },
                    { domain: 1, type: 'single', question: "Which is a common indicator of compromise?", options: ["Unusual outbound connections", "Normal logins", "Patch installs", "Backups"], answer: 0, explanation: "C2 or exfiltration traffic." },
                    { domain: 1, type: 'single', question: "What is 'replay attack'?", options: ["Resending captured data to gain access", "MITM", "Session hijacking", "Evil twin"], answer: 0, explanation: "Resends valid authentication packets." },
                    { domain: 2, type: 'single', question: "What is 'immutable infrastructure'?", options: ["Servers replaced instead of modified", "Dynamic scaling", "Manual patching", "Shared hosting"], answer: 0, explanation: "Reduces drift and attack surface." },
                    { domain: 2, type: 'single', question: "Which is a benefit of IaC?", options: ["Version control, repeatability, auditability", "Faster hardware", "No security", "Manual config"], answer: 0, explanation: "Terraform/CloudFormation enables secure deployments." },
                    { domain: 2, type: 'single', question: "What does blue-green deployment provide?", options: ["Zero-downtime rollouts with rollback", "Increased latency", "Single environment risk", "Manual testing"], answer: 0, explanation: "Switches traffic between identical environments." },
                    { domain: 2, type: 'single', question: "Which is a Zero Trust identity pillar?", options: ["Continuous verification", "Trust after login", "Perimeter VPN only", "Static roles"], answer: 0, explanation: "Re-verifies identity throughout session." },
                    { domain: 2, type: 'single', question: "What is a key benefit of CASB?", options: ["Enforce policies on SaaS apps", "Encrypt data at rest", "Manage on-prem firewalls", "Host applications"], answer: 0, explanation: "Visibility and control over cloud services." },
                    { domain: 2, type: 'single', question: "What does segmentation prevent?", options: ["Lateral movement", "Initial access", "Data exfiltration", "Social engineering"], answer: 0, explanation: "Limits attackers to one zone." },
                    { domain: 2, type: 'single', question: "Which is secure by design?", options: ["Security built-in from start", "Add security later", "Vendor defaults", "No testing"], answer: 0, explanation: "Integrates security in SDLC." },
                    { domain: 2, type: 'single', question: "What is 'fail-safe defaults'?", options: ["Deny access unless allowed", "Allow all by default", "Single failure point", "No logging"], answer: 0, explanation: "Principle of least privilege." },
                    { domain: 3, type: 'single', question: "Which is strongest wireless security?", options: ["WPA3", "WPA2", "WEP", "Open"], answer: 0, explanation: "WPA3 resists offline attacks." },
                    { domain: 3, type: 'single', question: "What does HSTS do?", options: ["Force HTTPS, prevent downgrade", "Encrypt cookies", "Speed loads", "Block JS"], answer: 0, explanation: "Prevents MITM downgrade." },
                    { domain: 3, type: 'single', question: "Best way to store secrets?", options: ["Secrets manager", "Hardcode", "Env vars only", "Email"], answer: 0, explanation: "Vault/AWS Secrets Manager for rotation." },
                    { domain: 3, type: 'single', question: "What is FIDO2?", options: ["Passwordless public-key auth", "Symmetric encryption", "Hashing", "VPN"], answer: 0, explanation: "Phishing-resistant login." },
                    { domain: 3, type: 'single', question: "What is ASLR?", options: ["Randomizes memory layout", "Encrypts memory", "Speeds execution", "Hides processes"], answer: 0, explanation: "Makes buffer overflows harder." },
                    { domain: 3, type: 'single', question: "What is Secure Boot?", options: ["Verifies boot signatures", "Encrypts disk", "Hides boot", "Speeds startup"], answer: 0, explanation: "Prevents unauthorized boot code." },
                    { domain: 3, type: 'single', question: "Best privileged account management?", options: ["JIT + PAM", "Permanent admin", "Shared creds", "No monitoring"], answer: 0, explanation: "Reduces standing privileges." },
                    { domain: 3, type: 'single', question: "Which is a secure API authentication?", options: ["OAuth 2.0 + JWT", "Basic auth over HTTP", "API keys in URL", "Shared secret plaintext"], answer: 0, explanation: "OAuth 2.0 + JWTs with short expiration." },
                    { domain: 3, type: 'single', question: "What is certificate pinning?", options: ["Validate expected certificate", "Speed TLS handshake", "Encrypt traffic", "Revoke certificates"], answer: 0, explanation: "Prevents MITM by pinning." },
                    { domain: 3, type: 'single', question: "What is DEP?", options: ["Prevents code execution in data regions", "Encrypts memory", "Speeds execution", "Hides processes"], answer: 0, explanation: "Marks data pages non-executable." },
                    { domain: 4, type: 'single', question: "What is chain of custody?", options: ["Evidence handling documentation", "Speed IR", "Encrypt images", "Delete evidence"], answer: 0, explanation: "Ensures integrity for legal use." },
                    { domain: 4, type: 'single', question: "What is memory forensics for?", options: ["Detect fileless malware", "Disk analysis", "Packet capture", "Log review"], answer: 0, explanation: "Volatility extracts in-memory artifacts." },
                    { domain: 4, type: 'single', question: "What is triage in IR?", options: ["Prioritize incidents", "Eradicate malware", "Recover systems", "Document lessons"], answer: 0, explanation: "Determines immediate action." },
                    { domain: 4, type: 'single', question: "What is honeypot purpose?", options: ["Attract and detect attackers", "Store backups", "Encrypt traffic", "Manage patches"], answer: 0, explanation: "Lures attackers to study tactics." },
                    { domain: 5, type: 'single', question: "What is a security audit?", options: ["Independent compliance review", "Daily log review", "Patch management", "User training"], answer: 0, explanation: "Verifies controls work." },
                    { domain: 5, type: 'single', question: "What is DRP key element?", options: ["RTO and RPO", "IR only", "Risk assessment", "Policy"], answer: 0, explanation: "Defines downtime/data loss tolerance." },
                    { domain: 5, type: 'single', question: "What is risk register?", options: ["Document of risks and mitigations", "Log file", "Policy", "Training"], answer: 0, explanation: "Central risk management record." },
                    { domain: 5, type: 'single', question: "Which regulation protects payment cards?", options: ["PCI DSS", "HIPAA", "GDPR", "SOX"], answer: 0, explanation: "Payment Card Industry Data Security Standard." }



],
domainNames: [
    "Attacks, Threats, and Vulnerabilities",                    // Domain 1 (24%)
    "Architecture and Design",                                 // Domain 2 (21%)
    "Implementation",                                          // Domain 3 (25%)
    "Operations and Incident Response",                        // Domain 4 (20%)
    "Governance, Risk, and Compliance"                         // Domain 5 (14%)
]
            },
            {
                id: 2,
                title: "AWS Certified Cloud Practitioner (CLF-C02) Practice Exam",
                icon: "‚òÅÔ∏è",
                difficulty: "intermediate",
                description: "Realistic simulation of the AWS Cloud Practitioner exam ‚Äì 65 randomized questions, 90 minutes",
                timeLimitMinutes: 90,
                domainWeights: [0.24, 0.30, 0.34, 0.12],
                questions: [
                    { domain: 1, type: 'single', question: "What is the AWS Shared Responsibility Model?", options: ["AWS responsible for security of the cloud, customer for security in the cloud", "Customer responsible for everything", "AWS responsible for everything", "Shared equally"], answer: 0, explanation: "AWS handles physical infrastructure and global services; customers manage data, apps, OS, etc." },
                    { domain: 1, type: 'single', question: "Which AWS service provides compute capacity?", options: ["Amazon EC2", "Amazon S3", "Amazon RDS", "AWS Lambda"], answer: 0, explanation: "EC2 offers resizable virtual servers (compute)." },
                    { domain: 1, type: 'single', question: "What is the benefit of the AWS Cloud's elasticity?", options: ["Scale resources up/down automatically based on demand", "Fixed pricing", "Manual scaling only", "No scaling"], answer: 0, explanation: "Elasticity allows dynamic scaling to match workload." },
                    { domain: 1, type: 'single', question: "Which is a pillar of the AWS Well-Architected Framework?", options: ["Operational Excellence", "Cost Optimization", "Security", "All of the above"], answer: 3, explanation: "The framework has six pillars: Operational Excellence, Security, Reliability, Performance Efficiency, Cost Optimization, Sustainability." },
                    { domain: 1, type: 'single', question: "What does 'pay-as-you-go' pricing mean?", options: ["Pay only for the resources you use, no upfront commitment", "Fixed monthly fee", "Free tier only", "Annual contracts"], answer: 0, explanation: "No long-term contracts; pay for actual usage." },
                    { domain: 2, type: 'single', question: "Which service provides centralized identity management in AWS?", options: ["AWS IAM Identity Center (successor to AWS SSO)", "Amazon Cognito", "AWS Directory Service", "All are identity services"], answer: 0, explanation: "IAM Identity Center manages workforce access across accounts." },
                    { domain: 2, type: 'single', question: "What is the purpose of AWS Shield?", options: ["DDoS protection", "Encryption", "Logging", "Patching"], answer: 0, explanation: "Shield provides always-on DDoS mitigation." },
                    { domain: 2, type: 'single', question: "Which is a best practice for securing S3 buckets?", options: ["Enable Block Public Access by default", "Make buckets public", "Disable encryption", "No policies"], answer: 0, explanation: "Block Public Access prevents accidental exposure." },
                    { domain: 2, type: 'single', question: "What does AWS KMS do?", options: ["Manage encryption keys and perform cryptographic operations", "Store secrets", "Log API calls", "Scan for vulnerabilities"], answer: 0, explanation: "Key Management Service handles key creation, rotation, and usage." },
                    { domain: 3, type: 'single', question: "Which service is serverless compute?", options: ["AWS Lambda", "Amazon EC2", "Amazon ECS", "AWS Fargate"], answer: 0, explanation: "Lambda runs code without provisioning servers." },
                    { domain: 3, type: 'single', question: "What is Amazon S3 primarily used for?", options: ["Object storage", "Block storage", "File storage", "Database"], answer: 0, explanation: "S3 stores objects (files) with high durability and scalability." },
                    { domain: 3, type: 'single', question: "Which service provides managed relational databases?", options: ["Amazon RDS", "Amazon DynamoDB", "Amazon Redshift", "Amazon ElastiCache"], answer: 0, explanation: "RDS manages MySQL, PostgreSQL, etc." },
                    { domain: 3, type: 'single', question: "What is AWS Auto Scaling?", options: ["Automatically adjusts EC2 capacity based on demand", "Manual scaling", "Storage scaling", "Network scaling"], answer: 0, explanation: "Auto Scaling maintains performance and cost efficiency." },
                    { domain: 4, type: 'single', question: "Which pricing model offers the lowest cost for EC2?", options: ["Spot Instances", "On-Demand", "Reserved Instances", "Savings Plans"], answer: 0, explanation: "Spot Instances can be up to 90% cheaper but can be interrupted." },
                    { domain: 4, type: 'single', question: "What is the AWS Free Tier?", options: ["Limited free usage for new accounts for 12 months", "Lifetime free", "No free tier", "Only for students"], answer: 0, explanation: "Offers free usage of many services (e.g., 750 hours EC2 t2.micro)." },
                    { domain: 4, type: 'single', question: "Which support plan includes 24/7 phone support?", options: ["Business or Enterprise", "Basic", "Developer", "None"], answer: 0, explanation: "Business and above offer 24/7 technical support." },
                    // Domain 1: Cloud Concepts (24%) ~48 questions
                    { domain: 1, type: 'single', question: "What is the AWS Shared Responsibility Model?", options: ["AWS is responsible for security of the cloud, customer for security in the cloud", "Customer is responsible for everything", "AWS is responsible for everything", "Shared equally for all services"], answer: 0, explanation: "AWS manages the infrastructure (physical security, hardware, global network), customers manage their data, applications, OS configuration, and access management." },
                    { domain: 1, type: 'single', question: "Which AWS design principle allows you to scale resources automatically?", options: ["Elasticity", "High availability", "Fault tolerance", "Agility"], answer: 0, explanation: "Elasticity enables automatic scaling up or down to match demand." },
                    { domain: 1, type: 'single', question: "What is the primary benefit of the AWS Cloud's pay-as-you-go pricing model?", options: ["Pay only for what you use with no long-term commitments", "Fixed monthly fees", "Free usage forever", "Annual contracts only"], answer: 0, explanation: "You pay only for the resources consumed, with no upfront costs or long-term contracts required." },
                    { domain: 1, type: 'single', question: "Which AWS Well-Architected Framework pillar focuses on protecting data and systems?", options: ["Security", "Reliability", "Performance Efficiency", "Cost Optimization"], answer: 0, explanation: "Security pillar emphasizes protecting information and systems." },
                    { domain: 1, type: 'single', question: "What does the AWS Cloud's global infrastructure provide?", options: ["Regions, Availability Zones, and Edge Locations", "Only one global data center", "Only Availability Zones", "Only Regions"], answer: 0, explanation: "AWS operates multiple Regions (geographic areas), each with multiple Availability Zones, plus Edge Locations for low-latency content delivery." },
                    { domain: 1, type: 'single', question: "Which service helps customers understand their cloud spending?", options: ["AWS Cost Explorer", "Amazon CloudWatch", "AWS Trusted Advisor", "AWS Budgets"], answer: 0, explanation: "Cost Explorer provides detailed billing and usage analysis." },
                    { domain: 1, type: 'single', question: "What is the main advantage of serverless computing on AWS?", options: ["No need to manage servers or infrastructure", "Always cheaper than EC2", "Requires manual scaling", "Limited to small workloads"], answer: 0, explanation: "Serverless (e.g., Lambda) lets you focus on code ‚Äî AWS manages servers, scaling, and availability." },

                    // Domain 2: Security and Compliance (30%) ~60 questions
                    { domain: 2, type: 'single', question: "Which AWS service provides centralized identity and access management?", options: ["AWS IAM", "Amazon Cognito", "AWS Directory Service", "AWS Organizations"], answer: 0, explanation: "IAM controls who can access what in your AWS account (users, roles, policies)." },
                    { domain: 2, type: 'single', question: "What is the best practice for securing S3 buckets by default?", options: ["Enable Block Public Access", "Make buckets public", "Disable encryption", "Allow anonymous access"], answer: 0, explanation: "Block Public Access prevents accidental public exposure of buckets." },
                    { domain: 2, type: 'single', question: "Which service protects against DDoS attacks at the network edge?", options: ["AWS Shield", "AWS WAF", "Amazon GuardDuty", "AWS Firewall Manager"], answer: 0, explanation: "Shield provides always-on DDoS protection for AWS resources." },
                    { domain: 2, type: 'single', question: "What does AWS KMS do?", options: ["Manages encryption keys and performs cryptographic operations", "Stores secrets", "Logs API calls", "Scans for vulnerabilities"], answer: 0, explanation: "Key Management Service handles key creation, rotation, and usage." },
                    { domain: 2, type: 'single', question: "Which service monitors for malicious activity and unauthorized behavior?", options: ["Amazon GuardDuty", "AWS Config", "AWS CloudTrail", "Amazon Inspector"], answer: 0, explanation: "GuardDuty uses machine learning to detect threats." },
                    { domain: 2, type: 'single', question: "What is the purpose of AWS Artifact?", options: ["Access compliance reports and agreements", "Manage encryption keys", "Log API calls", "Scan code for vulnerabilities"], answer: 0, explanation: "Artifact provides on-demand access to SOC, PCI, ISO reports, and agreements." },
                    { domain: 2, type: 'single', question: "Which is a best practice for root account security?", options: ["Enable MFA and do not use for daily tasks", "Use root for all operations", "Share root credentials", "Disable MFA"], answer: 0, explanation: "Root should be protected with MFA and used only when necessary." },

                    // Domain 3: Cloud Technology and Services (34%) ~68 questions
                    { domain: 3, type: 'single', question: "Which service provides scalable object storage?", options: ["Amazon S3", "Amazon EBS", "Amazon EFS", "Amazon RDS"], answer: 0, explanation: "S3 is designed for storing and retrieving any amount of data (objects)." },
                    { domain: 3, type: 'single', question: "Which is a serverless compute service?", options: ["AWS Lambda", "Amazon EC2", "Amazon ECS", "AWS Batch"], answer: 0, explanation: "Lambda runs code in response to events without provisioning servers." },
                    { domain: 3, type: 'single', question: "What is Amazon EC2 used for?", options: ["Resizable virtual servers (compute)", "Object storage", "Managed databases", "DNS routing"], answer: 0, explanation: "EC2 provides scalable compute capacity in the cloud." },
                    { domain: 3, type: 'single', question: "Which service provides managed relational databases?", options: ["Amazon RDS", "Amazon DynamoDB", "Amazon Redshift", "Amazon ElastiCache"], answer: 0, explanation: "RDS supports MySQL, PostgreSQL, Oracle, SQL Server, etc." },
                    { domain: 3, type: 'single', question: "What does Amazon CloudFront do?", options: ["Content delivery network (CDN)", "Load balancing", "Database caching", "Message queuing"], answer: 0, explanation: "CloudFront delivers content globally with low latency and high transfer speeds." },
                    { domain: 3, type: 'single', question: "Which service provides DNS routing and domain registration?", options: ["Amazon Route 53", "AWS Direct Connect", "Amazon VPC", "AWS Transit Gateway"], answer: 0, explanation: "Route 53 is a scalable DNS web service." },
                    { domain: 3, type: 'single', question: "What is Amazon VPC?", options: ["Logically isolated virtual network", "Global content delivery", "Serverless compute", "Managed database"], answer: 0, explanation: "VPC lets you launch AWS resources in a private, isolated section of the cloud." },

                    // Domain 4: Billing, Pricing, and Support (12%) ~24 questions
                    { domain: 4, type: 'single', question: "Which pricing model can offer the lowest cost for EC2 but with possible interruptions?", options: ["Spot Instances", "On-Demand", "Reserved Instances", "Savings Plans"], answer: 0, explanation: "Spot Instances offer significant savings but can be reclaimed by AWS." },
                    { domain: 4, type: 'single', question: "What is the AWS Free Tier?", options: ["Limited free usage for new accounts for 12 months", "Lifetime free for all services", "No free tier", "Only for students"], answer: 0, explanation: "Includes free usage of many services (e.g., 750 hours EC2 t2.micro, 5 GB S3)." },
                    { domain: 4, type: 'single', question: "Which tool helps track and forecast AWS costs?", options: ["AWS Cost Explorer", "Amazon CloudWatch", "AWS Trusted Advisor", "AWS Budgets"], answer: 0, explanation: "Cost Explorer provides detailed billing and usage analysis." },
                    { domain: 4, type: 'single', question: "Which support plan includes 24/7 phone and chat support?", options: ["Business or Enterprise", "Basic", "Developer", "None"], answer: 0, explanation: "Business and higher offer 24/7 technical support." },
                    { domain: 4, type: 'single', question: "What are Savings Plans?", options: ["Flexible commitment to compute usage for lower prices", "Fixed instance type discounts", "Free tier extension", "Spot instance commitments"], answer: 0, explanation: "Savings Plans offer savings across EC2, Lambda, Fargate with flexible usage." },
                    { domain: 4, type: 'single', question: "Which pricing model has no upfront payment and no long-term commitment?", options: ["On-Demand", "Reserved Instances", "Spot Instances", "Dedicated Hosts"], answer: 0, explanation: "On-Demand charges per second/hour with no commitment." },
                    { domain: 1, type: 'single', question: "Which AWS service is primarily used for object storage?", options: ["Amazon S3", "Amazon EBS", "Amazon RDS", "Amazon EC2"], answer: 0, explanation: "S3 is designed for storing and retrieving any amount of data (objects) at any time." },
                    { domain: 1, type: 'single', question: "What is the main benefit of AWS Regions?", options: ["Low latency for users in different geographic areas", "Cheaper pricing", "Automatic backups", "Serverless compute"], answer: 0, explanation: "Regions allow you to deploy resources close to end users for lower latency and compliance." },
                    { domain: 1, type: 'single', question: "Which term describes AWS's ability to automatically increase or decrease capacity?", options: ["Elasticity", "Scalability", "High Availability", "Durability"], answer: 0, explanation: "Elasticity refers to the ability to scale resources up or down automatically." },
                    { domain: 1, type: 'single', question: "What is the AWS global infrastructure composed of?", options: ["Regions, Availability Zones, and Edge Locations", "Only Regions", "Only Availability Zones", "Only Edge Locations"], answer: 0, explanation: "AWS operates multiple Regions (geographic areas), each with multiple Availability Zones, plus Edge Locations for caching." },
                    { domain: 1, type: 'single', question: "Which AWS service allows you to run code without provisioning servers?", options: ["AWS Lambda", "Amazon EC2", "Amazon ECS", "AWS Fargate"], answer: 0, explanation: "Lambda is a serverless compute service ‚Äî you pay only for compute time used." },
                    { domain: 1, type: 'single', question: "What does 'pay-as-you-go' mean in AWS?", options: ["Pay only for the resources you consume", "Fixed monthly fee", "Annual contracts required", "Free forever"], answer: 0, explanation: "No upfront payment; billed per second/hour of usage." },
                    { domain: 1, type: 'single', question: "Which pillar of the AWS Well-Architected Framework focuses on cost awareness?", options: ["Cost Optimization", "Security", "Reliability", "Performance Efficiency"], answer: 0, explanation: "Cost Optimization helps avoid unnecessary expenses." },

                    { domain: 2, type: 'single', question: "Which service manages user permissions and access in AWS?", options: ["AWS IAM", "Amazon Cognito", "AWS SSO", "AWS Organizations"], answer: 0, explanation: "IAM controls who (users/roles) can do what (actions) on which resources." },
                    { domain: 2, type: 'single', question: "What is the default encryption status for new S3 buckets?", options: ["Server-side encryption with S3 managed keys (SSE-S3)", "No encryption", "Client-side encryption", "KMS only"], answer: 0, explanation: "New buckets use SSE-S3 by default for encryption at rest." },
                    { domain: 2, type: 'single', question: "Which service provides DDoS protection for AWS resources?", options: ["AWS Shield", "AWS WAF", "Amazon GuardDuty", "AWS Firewall Manager"], answer: 0, explanation: "Shield offers always-on DDoS mitigation at the network edge." },
                    { domain: 2, type: 'single', question: "What does AWS Artifact provide?", options: ["Compliance reports and agreements", "Encryption keys", "API call logs", "Vulnerability scans"], answer: 0, explanation: "Artifact gives on-demand access to SOC, PCI, ISO reports, and contracts." },
                    { domain: 2, type: 'single', question: "Which is a best practice for root account security?", options: ["Enable MFA and avoid daily use", "Use root for everyday tasks", "Share root credentials", "Disable MFA"], answer: 0, explanation: "Root should be protected and used only when absolutely necessary." },
                    { domain: 2, type: 'single', question: "What does Amazon GuardDuty detect?", options: ["Malicious activity and unauthorized behavior", "Cost anomalies", "Configuration drift", "Performance issues"], answer: 0, explanation: "GuardDuty uses ML to identify threats like reconnaissance or crypto mining." },

                    { domain: 3, type: 'single', question: "Which service is a managed relational database?", options: ["Amazon RDS", "Amazon DynamoDB", "Amazon Redshift", "Amazon ElastiCache"], answer: 0, explanation: "RDS supports MySQL, PostgreSQL, Oracle, SQL Server, MariaDB, Aurora." },
                    { domain: 3, type: 'single', question: "What is Amazon CloudFront used for?", options: ["Content delivery (CDN)", "Load balancing", "Database caching", "Message queuing"], answer: 0, explanation: "CloudFront delivers content globally with low latency and high speed." },
                    { domain: 3, type: 'single', question: "Which service provides DNS and domain registration?", options: ["Amazon Route 53", "AWS Direct Connect", "Amazon VPC", "AWS Transit Gateway"], answer: 0, explanation: "Route 53 is a scalable DNS web service with domain registration." },
                    { domain: 3, type: 'single', question: "What is Amazon VPC?", options: ["Logically isolated virtual network", "Global CDN", "Serverless compute", "Managed database"], answer: 0, explanation: "VPC lets you launch resources in a private, isolated section of the AWS Cloud." },
                    { domain: 3, type: 'single', question: "Which service provides block-level storage for EC2?", options: ["Amazon EBS", "Amazon S3", "Amazon EFS", "Amazon Glacier"], answer: 0, explanation: "EBS offers persistent block storage volumes for EC2 instances." },
                    { domain: 3, type: 'single', question: "What is AWS Auto Scaling used for?", options: ["Automatically adjust EC2 capacity based on demand", "Manual scaling", "Storage scaling", "Network scaling"], answer: 0, explanation: "Auto Scaling maintains performance and cost efficiency." },

                    { domain: 4, type: 'single', question: "Which EC2 pricing model offers the lowest cost but can be interrupted?", options: ["Spot Instances", "On-Demand", "Reserved Instances", "Savings Plans"], answer: 0, explanation: "Spot can save up to 90% but AWS can reclaim instances." },
                    { domain: 4, type: 'single', question: "What is the AWS Free Tier?", options: ["Limited free usage for new accounts for 12 months", "Lifetime free", "No free tier", "Only for students"], answer: 0, explanation: "Includes free usage of many services (e.g., 750 hours EC2, 5 GB S3)." },
                    { domain: 4, type: 'single', question: "Which tool helps visualize and forecast AWS costs?", options: ["AWS Cost Explorer", "Amazon CloudWatch", "AWS Trusted Advisor", "AWS Budgets"], answer: 0, explanation: "Cost Explorer provides detailed billing and usage analysis." },
                    { domain: 4, type: 'single', question: "Which support plan includes 24/7 technical support?", options: ["Business or Enterprise", "Basic", "Developer", "None"], answer: 0, explanation: "Business and above offer 24/7 phone/chat support." },
                    { domain: 1, type: 'single', question: "Which AWS service provides a fully managed NoSQL database?", options: ["Amazon DynamoDB", "Amazon RDS", "Amazon Redshift", "Amazon ElastiCache"], answer: 0, explanation: "DynamoDB is a serverless, NoSQL database with single-digit millisecond latency." },
                    { domain: 1, type: 'single', question: "What is the purpose of AWS Regions?", options: ["Isolate failures and meet compliance requirements", "Only reduce latency", "Only lower costs", "Only increase availability"], answer: 0, explanation: "Regions provide fault isolation, data residency/compliance, and lower latency." },
                    { domain: 1, type: 'single', question: "Which is a core benefit of the AWS Cloud?", options: ["Agility and innovation speed", "Fixed hardware", "Manual scaling only", "Long-term contracts"], answer: 0, explanation: "Cloud enables rapid provisioning and experimentation." },
                    { domain: 1, type: 'single', question: "What does the AWS Free Tier include for EC2?", options: ["750 hours per month of t2.micro or t3.micro instances", "Unlimited free usage", "No free tier for EC2", "Only for 1 month"], answer: 0, explanation: "Free for 12 months on eligible new accounts." },
                    { domain: 1, type: 'single', question: "Which AWS service is used for global content delivery?", options: ["Amazon CloudFront", "Amazon Route 53", "AWS Direct Connect", "AWS Transit Gateway"], answer: 0, explanation: "CloudFront is a CDN that caches content at edge locations." },
                    { domain: 2, type: 'single', question: "Which AWS service enables multi-account management and consolidated billing?", options: ["AWS Organizations", "AWS IAM", "AWS SSO", "AWS Control Tower"], answer: 0, explanation: "Organizations simplifies management of multiple accounts with policies and billing." },
                    { domain: 2, type: 'single', question: "What is the purpose of AWS WAF?", options: ["Protect web applications from common exploits", "DDoS protection", "Key management", "Log analysis"], answer: 0, explanation: "Web Application Firewall filters malicious web traffic (SQLi, XSS, etc.)." },
                    { domain: 2, type: 'single', question: "Which is a best practice for IAM users?", options: ["Grant least privilege permissions", "Use root credentials for daily tasks", "Share IAM user credentials", "Disable MFA"], answer: 0, explanation: "Least privilege reduces risk if credentials are compromised." },
                    { domain: 2, type: 'single', question: "What does Amazon Inspector assess?", options: ["Vulnerabilities and best practices on EC2 and Lambda", "Cost anomalies", "Configuration drift", "Performance issues"], answer: 0, explanation: "Inspector scans for security vulnerabilities and deviations." },
                    { domain: 2, type: 'single', question: "Which service logs all API calls made to AWS resources?", options: ["AWS CloudTrail", "Amazon CloudWatch", "AWS Config", "Amazon GuardDuty"], answer: 0, explanation: "CloudTrail records API activity for auditing and troubleshooting." },

                    { domain: 3, type: 'single', question: "Which service provides file storage for multiple EC2 instances?", options: ["Amazon EFS", "Amazon EBS", "Amazon S3", "Amazon Glacier"], answer: 0, explanation: "EFS is a scalable, shared file system for Linux workloads." },
                    { domain: 3, type: 'single', question: "What is AWS Elastic Load Balancing used for?", options: ["Distribute incoming traffic across multiple targets", "Store data", "Run serverless code", "Manage DNS"], answer: 0, explanation: "ELB improves availability and scales traffic." },
                    { domain: 3, type: 'single', question: "Which service provides a managed message queue?", options: ["Amazon SQS", "Amazon SNS", "Amazon MQ", "AWS Step Functions"], answer: 0, explanation: "SQS decouples components with reliable message delivery." },
                    { domain: 3, type: 'single', question: "What is Amazon Aurora?", options: ["MySQL/PostgreSQL-compatible relational database", "NoSQL database", "Data warehouse", "Caching service"], answer: 0, explanation: "Aurora is a high-performance, fully managed relational DB." },
                    { domain: 3, type: 'single', question: "Which service provides low-latency in-memory caching?", options: ["Amazon ElastiCache", "Amazon RDS", "Amazon Redshift", "Amazon DynamoDB Accelerator (DAX)"], answer: 0, explanation: "ElastiCache supports Redis and Memcached." },
                    { domain: 3, type: 'single', question: "What is AWS Direct Connect?", options: ["Dedicated private connection from on-premises to AWS", "Public internet connection", "VPN tunnel", "Satellite link"], answer: 0, explanation: "Direct Connect bypasses the public internet for consistent performance." },

                    { domain: 4, type: 'single', question: "What are Reserved Instances?", options: ["Commit to usage for 1 or 3 years for discounted rates", "Pay per second", "Interruptible instances", "Free tier"], answer: 0, explanation: "Reserved Instances offer up to 72% savings over On-Demand." },
                    { domain: 4, type: 'single', question: "Which tool alerts when costs exceed a budget?", options: ["AWS Budgets", "AWS Cost Explorer", "AWS Trusted Advisor", "Amazon CloudWatch"], answer: 0, explanation: "Budgets set cost thresholds and send alerts." },
                    { domain: 4, type: 'single', question: "What is the Developer Support plan level?", options: ["Email support during business hours", "24/7 phone support", "No support", "Enterprise-level support"], answer: 0, explanation: "Developer plan offers email support with response times." },
                    { domain: 1, type: 'single', question: "Which AWS service is a managed message broker?", options: ["Amazon MQ", "Amazon SQS", "Amazon SNS", "AWS Step Functions"], answer: 0, explanation: "MQ supports Apache ActiveMQ and RabbitMQ protocols." },
                    { domain: 1, type: 'single', question: "What is AWS Snowball used for?", options: ["Large-scale data transfer to/from AWS", "Serverless compute", "DNS routing", "Load balancing"], answer: 0, explanation: "Snowball moves petabytes of data physically when network transfer is too slow." },
                    { domain: 1, type: 'single', question: "Which is a characteristic of AWS Availability Zones?", options: ["Isolated locations within a Region", "Global locations", "Only for S3", "Single data center"], answer: 0, explanation: "AZs are isolated to provide high availability and fault tolerance." },
                    { domain: 1, type: 'single', question: "What does AWS Outposts provide?", options: ["AWS services on-premises", "Cloud-only services", "Free tier extension", "DNS management"], answer: 0, explanation: "Outposts runs AWS infrastructure in your own data center." },
                    { domain: 1, type: 'single', question: "Which service helps migrate databases to AWS?", options: ["AWS Database Migration Service (DMS)", "AWS Snowball", "AWS DataSync", "AWS Transfer Family"], answer: 0, explanation: "DMS supports homogeneous and heterogeneous migrations." },
                    { domain: 2, type: 'single', question: "What is the purpose of AWS Config?", options: ["Track configuration changes and compliance", "Log API calls", "DDoS protection", "Vulnerability scanning"], answer: 0, explanation: "Config records resource configurations and evaluates against rules." },
                    { domain: 2, type: 'single', question: "Which service manages user pools and identity for web/mobile apps?", options: ["Amazon Cognito", "AWS IAM", "AWS SSO", "AWS Directory Service"], answer: 0, explanation: "Cognito handles user sign-up, sign-in, and access control." },
                    { domain: 2, type: 'single', question: "What is AWS Firewall Manager used for?", options: ["Centrally manage WAF, Shield, and VPC security groups across accounts", "Single account only", "Key rotation", "Log analysis"], answer: 0, explanation: "Simplifies policy management in Organizations." },
                    { domain: 2, type: 'single', question: "Which is a best practice for S3 bucket security?", options: ["Use bucket policies and IAM roles", "Make buckets public", "Disable versioning", "Allow anonymous writes"], answer: 0, explanation: "Policies and roles enforce least privilege." },
                    { domain: 2, type: 'single', question: "What does AWS Macie discover?", options: ["Sensitive data in S3", "API call logs", "Cost anomalies", "Performance issues"], answer: 0, explanation: "Macie uses ML to find PII, PHI, etc. in S3." },
                    { domain: 3, type: 'single', question: "Which service is a managed data warehouse?", options: ["Amazon Redshift", "Amazon RDS", "Amazon DynamoDB", "Amazon ElastiCache"], answer: 0, explanation: "Redshift is designed for OLAP and large-scale analytics." },
                    { domain: 3, type: 'single', question: "What is AWS Step Functions used for?", options: ["Orchestrate serverless workflows", "Store objects", "Run code", "Deliver content"], answer: 0, explanation: "Step Functions coordinates multiple AWS services into workflows." },
                    { domain: 3, type: 'single', question: "Which service provides a managed Hadoop framework?", options: ["Amazon EMR", "AWS Glue", "Amazon Athena", "Amazon Kinesis"], answer: 0, explanation: "EMR runs big data frameworks like Spark, Hive, Presto." },
                    { domain: 3, type: 'single', question: "What is Amazon Athena?", options: ["Serverless interactive query service for S3", "Managed database", "Data pipeline", "Streaming service"], answer: 0, explanation: "Athena lets you query S3 data using standard SQL." },
                    { domain: 3, type: 'single', question: "Which service streams and analyzes real-time data?", options: ["Amazon Kinesis", "Amazon SQS", "AWS Glue", "Amazon EMR"], answer: 0, explanation: "Kinesis handles streaming data ingestion and processing." },
                    { domain: 4, type: 'single', question: "What are Savings Plans?", options: ["Flexible commitment for compute usage with discounts", "Fixed instance discounts", "Free tier extension", "Spot commitments"], answer: 0, explanation: "Savings Plans apply to EC2, Lambda, Fargate with 1- or 3-year terms." },
                    { domain: 4, type: 'single', question: "Which tool recommends cost-saving opportunities?", options: ["AWS Trusted Advisor", "AWS Cost Explorer", "AWS Budgets", "Amazon CloudWatch"], answer: 0, explanation: "Trusted Advisor checks for cost, performance, security, etc." },
                    { domain: 4, type: 'single', question: "What is the Business Support plan minimum?", options: ["$100/month", "Free", "$29/month", "$10,000/month"], answer: 0, explanation: "Business plan starts at $100/month and includes 24/7 support." },
                    { domain: 4, type: 'single', question: "Which pricing model has no long-term commitment?", options: ["On-Demand Instances", "Reserved Instances", "Spot Instances", "Dedicated Hosts"], answer: 0, explanation: "On-Demand charges per second/hour with no commitment." },
                    { domain: 1, type: 'single', question: "Which AWS service is used for managed Kafka?", options: ["Amazon MSK", "Amazon MQ", "Amazon SQS", "Amazon SNS"], answer: 0, explanation: "Managed Streaming for Apache Kafka (MSK) handles Kafka clusters." },
                    { domain: 1, type: 'single', question: "What is AWS Wavelength?", options: ["Ultra-low latency for 5G edge computing", "Satellite communication", "Private connection", "Global network"], answer: 0, explanation: "Wavelength brings AWS services to 5G edge locations." },
                    { domain: 1, type: 'single', question: "Which AWS service provides serverless data integration?", options: ["AWS Glue", "Amazon EMR", "AWS Data Pipeline", "Amazon Kinesis"], answer: 0, explanation: "Glue is a serverless ETL service." },
                    { domain: 1, type: 'single', question: "What is the purpose of AWS Local Zones?", options: ["Extend AWS closer to users for low latency", "Global data centers", "Fault isolation", "Cost savings"], answer: 0, explanation: "Local Zones place compute, storage, etc. closer to large cities." },
                    { domain: 1, type: 'single', question: "Which is a core AWS Cloud advantage?", options: ["Global reach with local presence", "Fixed hardware", "Manual provisioning", "High upfront costs"], answer: 0, explanation: "AWS has global infrastructure with regional compliance." },
                    { domain: 2, type: 'single', question: "What is AWS Control Tower?", options: ["Orchestrates setup of multi-account environment", "Manages single account", "Encrypts data", "Logs API"], answer: 0, explanation: "Control Tower sets up landing zones with guardrails." },
                    { domain: 2, type: 'single', question: "Which service provides secrets management?", options: ["AWS Secrets Manager", "AWS KMS", "AWS Parameter Store", "AWS Config"], answer: 0, explanation: "Secrets Manager stores and rotates secrets like API keys." },
                    { domain: 2, type: 'single', question: "What is AWS Security Hub?", options: ["Central dashboard for security findings", "DDoS protection", "Key management", "Log analysis"], answer: 0, explanation: "Aggregates and prioritizes security alerts." },
                    { domain: 2, type: 'single', question: "Which is a best practice for EC2 security?", options: ["Use security groups as firewalls", "Make instances public", "Disable IAM roles", "Use root user"], answer: 0, explanation: "Security groups control inbound/outbound traffic." },
                    { domain: 2, type: 'single', question: "What does AWS Inspector do?", options: ["Automated vulnerability scanning", "Cost analysis", "Configuration tracking", "Performance monitoring"], answer: 0, explanation: "Inspector assesses EC2 and Lambda for vulnerabilities." },
                    { domain: 3, type: 'single', question: "Which service provides serverless data lakes?", options: ["Amazon S3 with Athena", "Amazon RDS", "Amazon Redshift", "Amazon ElastiCache"], answer: 0, explanation: "S3 stores data; Athena queries it serverlessly." },
                    { domain: 3, type: 'single', question: "What is AWS App Runner?", options: ["Serverless container deployment", "Virtual servers", "Managed databases", "DNS"], answer: 0, explanation: "App Runner builds and deploys containerized web apps." },
                    { domain: 3, type: 'single', question: "Which service provides hybrid storage for on-prem and cloud?", options: ["AWS Storage Gateway", "Amazon S3", "Amazon EFS", "Amazon Glacier"], answer: 0, explanation: "Storage Gateway integrates on-prem with AWS storage." },
                    { domain: 3, type: 'single', question: "What is Amazon Lightsail?", options: ["Simplified compute for beginners", "Enterprise compute", "Big data processing", "Serverless"], answer: 0, explanation: "Lightsail offers easy VM, storage, networking for small apps." },
                    { domain: 3, type: 'single', question: "Which service provides container orchestration?", options: ["Amazon ECS", "AWS Lambda", "Amazon EC2", "AWS Batch"], answer: 0, explanation: "ECS manages container deployment and scaling." },
                    { domain: 4, type: 'single', question: "What is AWS Trusted Advisor?", options: ["Automated checks for cost, security, performance", "Manual consulting", "Free tier only", "Support tickets"], answer: 0, explanation: "Advisor provides best practice recommendations." },
                    { domain: 4, type: 'single', question: "Which pricing model is flexible for compute usage?", options: ["Savings Plans", "On-Demand", "Reserved Instances", "Spot"], answer: 0, explanation: "Savings Plans offer discounts on flexible compute." },
                    { domain: 4, type: 'single', question: "What is the Enterprise Support plan minimum?", options: ["$15,000/month", "Free", "$29/month", "$100/month"], answer: 0, explanation: "Enterprise plan offers TAM and concierge support." },
                    { domain: 4, type: 'single', question: "Which tool sets cost thresholds and alerts?", options: ["AWS Budgets", "AWS Cost Explorer", "Trusted Advisor", "CloudWatch"], answer: 0, explanation: "Budgets monitor spend and send notifications." }

                    
                ]

            },

            {
                id: 3,
                title: "CISSP Practice Exam",
                icon: "üîí",
                difficulty: "advanced",
                description: "Realistic simulation of the CISSP certification exam ‚Äì randomized questions from all 8 domains",
                timeLimitMinutes: 180,  // CISSP is 3 hours (180 minutes)
                domainWeights: [0.15, 0.10, 0.13, 0.13, 0.13, 0.12, 0.13, 0.11],
                questions: [
                    // Domain 1: Security and Risk Management (15%)
                    // Domain 2: Asset Security (10%)
                    // Domain 3: Security Architecture and Engineering (13%)
                    // Domain 4: Communication and Network Security (13%)
                    // Domain 5: Identity and Access Management (13%)
                    // Domain 6: Security Assessment and Testing (12%)
                    // Domain 7: Security Operations (13%)
                    // Domain 8: Software Development Security (11%)
                    { domain: 1, type: 'single', question: "Which principle is most important in the CIA triad for protecting intellectual property?", options: ["Confidentiality", "Integrity", "Availability", "Non-repudiation"], answer: 0, explanation: "Confidentiality prevents unauthorized disclosure of sensitive information like IP." },
                    { domain: 1, type: 'multi', question: "Select all that are key elements of a security governance framework.", options: ["Policy development", "Risk management", "Compliance monitoring", "Daily firewall rule changes"], answer: [0,1,2], explanation: "Governance includes high-level policies, risk processes, and compliance oversight." },
                    { domain: 1, type: 'single', question: "What is the primary purpose of a business impact analysis (BIA)?", options: ["Identify critical assets and recovery objectives", "Encrypt data", "Manage user access", "Patch systems"], answer: 0, explanation: "BIA determines impact of disruptions and prioritizes recovery." },
                    { domain: 1, type: 'single', question: "Which regulation requires protection of personally identifiable information (PII) in the EU?", options: ["GDPR", "HIPAA", "SOX", "PCI DSS"], answer: 0, explanation: "General Data Protection Regulation governs PII in the EU." },
                    { domain: 1, type: 'single', question: "What is the purpose of a risk register?", options: ["Document identified risks, likelihood, impact, and mitigations", "Log incidents", "Manage passwords", "Track patches"], answer: 0, explanation: "Central document for tracking and managing risks." },
                    { domain: 2, type: 'single', question: "Which is the most secure method for data disposal?", options: ["Cryptographic erasure or physical destruction", "Delete files", "Format drive", "Overwrite once"], answer: 0, explanation: "Cryptographic erasure or destruction ensures data is irrecoverable." },
                    { domain: 2, type: 'single', question: "What is data remanence?", options: ["Residual data left after deletion", "Encrypted data", "Backed-up data", "Live data in memory"], answer: 0, explanation: "Data that remains after attempted removal." },
                    { domain: 2, type: 'single', question: "Which classification level requires the highest protection?", options: ["Top Secret", "Confidential", "Secret", "Public"], answer: 0, explanation: "Top Secret has the most severe impact if compromised." },
                    { domain: 3, type: 'single', question: "Which is a core principle of secure design?", options: ["Least privilege", "Allow all by default", "Single point of failure", "No logging"], answer: 0, explanation: "Least privilege limits access to minimum needed." },
                    { domain: 3, type: 'single', question: "What is the purpose of a trusted platform module (TPM)?", options: ["Secure key storage and hardware-based crypto", "Network encryption", "User authentication", "Log collection"], answer: 0, explanation: "TPM provides secure storage for keys and measurements." },
                    { domain: 3, type: 'single', question: "Which cryptographic mode provides both confidentiality and integrity?", options: ["GCM", "ECB", "CBC", "OFB"], answer: 0, explanation: "Galois/Counter Mode (GCM) provides authenticated encryption." },
                    { domain: 4, type: 'single', question: "Which protocol is used for secure remote access?", options: ["SSH", "Telnet", "FTP", "HTTP"], answer: 0, explanation: "SSH provides encrypted and authenticated remote shell." },
                    { domain: 4, type: 'single', question: "What is the purpose of a VPN?", options: ["Create encrypted tunnel over untrusted network", "Increase bandwidth", "Block traffic", "Log connections"], answer: 0, explanation: "VPNs secure communication over public networks." },
                    { domain: 5, type: 'single', question: "Which is the strongest form of authentication?", options: ["Multi-factor authentication", "Password only", "Security questions", "Single sign-on"], answer: 0, explanation: "MFA adds multiple factors for stronger security." },
                    { domain: 5, type: 'single', question: "What is role-based access control (RBAC)?", options: ["Access based on job function", "Discretionary access", "Mandatory access", "Rule-based access"], answer: 0, explanation: "RBAC assigns permissions to roles, not individuals." },
                    { domain: 6, type: 'single', question: "What is the purpose of penetration testing?", options: ["Identify exploitable vulnerabilities", "Encrypt data", "Manage patches", "Log events"], answer: 0, explanation: "Simulates attacks to find weaknesses." },
                    { domain: 7, type: 'single', question: "What is the first step in incident response?", options: ["Preparation", "Identification", "Containment", "Eradication"], answer: 0, explanation: "Preparation includes planning and tools." },
                    { domain: 8, type: 'single', question: "Which is a secure coding practice?", options: ["Input validation", "Hardcoded credentials", "No error handling", "Plaintext storage"], answer: 0, explanation: "Validation prevents injection attacks." },
                    { domain: 1, type: 'single', question: "Which is the PRIMARY goal of a security governance framework?", options: ["Align security with business objectives", "Encrypt all data", "Patch all systems daily", "Eliminate all risks"], answer: 0, explanation: "Governance ensures security supports and enables business goals, not the other way around." },
                    { domain: 1, type: 'single', question: "What is the purpose of a risk appetite statement?", options: ["Define acceptable level of risk the organization is willing to take", "Eliminate all risk", "Set maximum budget for security", "List all controls"], answer: 0, explanation: "Risk appetite guides risk treatment decisions." },
                    { domain: 1, type: 'single', question: "Which regulation requires protection of cardholder data?", options: ["PCI DSS", "GDPR", "HIPAA", "SOX"], answer: 0, explanation: "Payment Card Industry Data Security Standard governs cardholder data." },
                    { domain: 1, type: 'single', question: "What is the first step in the risk management process?", options: ["Risk identification", "Risk treatment", "Risk monitoring", "Risk acceptance"], answer: 0, explanation: "You must first identify risks before assessing or treating them." },
                    { domain: 1, type: 'single', question: "Which is a key component of a security awareness program?", options: ["Phishing simulations", "Firewall rules", "Patch management", "Encryption only"], answer: 0, explanation: "Simulations measure and improve human response to threats." },
                    { domain: 1, type: 'single', question: "What is the purpose of a business continuity plan (BCP)?", options: ["Ensure critical business functions continue during disruption", "Encrypt data", "Manage user access", "Patch systems"], answer: 0, explanation: "BCP focuses on maintaining operations during and after incidents." },
                    { domain: 1, type: 'single', question: "Which is a common risk treatment strategy?", options: ["Avoid, Mitigate, Transfer, Accept", "Ignore", "Delete", "Encrypt only"], answer: 0, explanation: "These are the four standard risk treatment options." },
                    { domain: 1, type: 'single', question: "What does a non-disclosure agreement (NDA) protect?", options: ["Confidential information", "Physical assets", "Hardware", "Network traffic"], answer: 0, explanation: "NDAs legally protect sensitive business information." },
                    { domain: 2, type: 'single', question: "Which is the most secure method for data destruction?", options: ["Physical destruction or cryptographic erasure", "Simple delete", "Format drive", "Overwrite once"], answer: 0, explanation: "Physical destruction or crypto erase ensures data is irrecoverable." },
                    { domain: 2, type: 'single', question: "What is data remanence?", options: ["Residual data after deletion attempts", "Encrypted data", "Backed-up data", "Live data in memory"], answer: 0, explanation: "Data that persists after normal deletion methods." },
                    { domain: 2, type: 'single', question: "Which classification level requires the highest protection?", options: ["Top Secret", "Confidential", "Secret", "Public"], answer: 0, explanation: "Top Secret has the most severe impact if compromised." },
                    { domain: 2, type: 'single', question: "What is the purpose of data labeling?", options: ["Indicate sensitivity level for handling", "Encrypt data", "Delete old data", "Share freely"], answer: 0, explanation: "Labels guide appropriate protection and handling." },
                    { domain: 2, type: 'single', question: "Which is the best method for sanitizing magnetic media?", options: ["Degaussing", "Overwrite", "Delete", "Format"], answer: 0, explanation: "Degaussing disrupts magnetic fields, making data unrecoverable." },
                    { domain: 3, type: 'single', question: "Which principle ensures no single point of failure?", options: ["Defense-in-depth", "Least privilege", "Separation of duties", "Fail-safe defaults"], answer: 0, explanation: "Defense-in-depth uses multiple layers to mitigate single failures." },
                    { domain: 3, type: 'single', question: "What is the purpose of a TPM (Trusted Platform Module)?", options: ["Secure key storage and hardware crypto", "Network encryption", "User authentication", "Log collection"], answer: 0, explanation: "TPM provides root of trust for measurements and key protection." },
                    { domain: 3, type: 'single', question: "Which cryptographic mode provides both confidentiality and integrity?", options: ["GCM", "ECB", "CBC", "OFB"], answer: 0, explanation: "Galois/Counter Mode offers authenticated encryption." },
                    { domain: 3, type: 'single', question: "What is the primary purpose of salting passwords?", options: ["Prevent rainbow table attacks", "Encrypt passwords", "Speed hashing", "Store plaintext"], answer: 0, explanation: "Unique salts make precomputed tables useless." },
                    { domain: 3, type: 'single', question: "Which is a hardware security module (HSM) used for?", options: ["Secure key generation and storage", "Network traffic encryption", "User login", "Log aggregation"], answer: 0, explanation: "HSMs protect keys and perform crypto operations." },
                    { domain: 4, type: 'single', question: "Which protocol provides secure remote shell access?", options: ["SSH", "Telnet", "RDP without TLS", "FTP"], answer: 0, explanation: "SSH provides encrypted and authenticated remote access." },
                    { domain: 4, type: 'single', question: "What is the purpose of a VPN?", options: ["Create encrypted tunnel over untrusted networks", "Increase bandwidth", "Block traffic", "Log connections"], answer: 0, explanation: "VPNs secure communication over public internet." },
                    { domain: 4, type: 'single', question: "Which is a best practice for wireless security?", options: ["Use WPA3", "Use WEP", "Open network", "MAC filtering only"], answer: 0, explanation: "WPA3 provides the strongest protection." },
                    { domain: 4, type: 'single', question: "What does IPsec provide?", options: ["Authentication, integrity, and confidentiality for IP packets", "Only encryption", "Only authentication", "Only integrity"], answer: 0, explanation: "IPsec secures IP communications at the network layer." },
                    { domain: 5, type: 'single', question: "Which is the strongest authentication factor?", options: ["Something you have (hardware token)", "Something you know (password)", "Something you are (biometrics)", "Somewhere you are (location)"], answer: 0, explanation: "Hardware tokens are phishing-resistant and strong." },
                    { domain: 5, type: 'single', question: "What is role-based access control (RBAC)?", options: ["Permissions assigned to roles, not individuals", "Discretionary access", "Mandatory access", "Rule-based"], answer: 0, explanation: "RBAC simplifies management by grouping permissions." },
                    { domain: 5, type: 'single', question: "What is the purpose of just-in-time (JIT) access?", options: ["Grant temporary elevated privileges only when needed", "Permanent admin rights", "Share credentials", "No monitoring"], answer: 0, explanation: "JIT reduces standing privileges and risk." },
                    { domain: 5, type: 'single', question: "Which is a best practice for password management?", options: ["Use password manager and long passphrases", "Reuse passwords", "Short complex passwords", "No MFA"], answer: 0, explanation: "Managers help generate/store strong unique passphrases." },
                    { domain: 6, type: 'single', question: "What is the primary goal of penetration testing?", options: ["Identify exploitable vulnerabilities", "Encrypt data", "Manage patches", "Log events"], answer: 0, explanation: "Simulates real attacks to find weaknesses." },
                    { domain: 6, type: 'single', question: "Which is a type of vulnerability scan?", options: ["Authenticated scan", "Unauthenticated scan", "Both authenticated and unauthenticated", "Only manual"], answer: 2, explanation: "Authenticated scans use credentials for deeper visibility." },
                    { domain: 6, type: 'single', question: "What is the purpose of a code review?", options: ["Identify security flaws in source code", "Encrypt code", "Compile code", "Run code"], answer: 0, explanation: "Reviews catch vulnerabilities before deployment." },
                    { domain: 7, type: 'single', question: "What is the first phase of NIST incident response lifecycle?", options: ["Preparation", "Identification", "Containment", "Eradication"], answer: 0, explanation: "Preparation includes planning, tools, and training." },
                    { domain: 7, type: 'single', question: "Which is a key SIEM function?", options: ["Log correlation and alerting", "Encryption", "Patching", "User provisioning"], answer: 0, explanation: "SIEM aggregates and analyzes logs for threat detection." },
                    { domain: 7, type: 'single', question: "What is the purpose of a honeypot?", options: ["Detect and study attacker behavior", "Store backups", "Encrypt traffic", "Manage patches"], answer: 0, explanation: "Honeypots lure attackers and alert on compromise." },
                    { domain: 8, type: 'single', question: "Which is a secure coding practice?", options: ["Input validation", "Hardcoded credentials", "No error handling", "Plaintext storage"], answer: 0, explanation: "Validation prevents injection attacks." },
                    { domain: 8, type: 'single', question: "What is threat modeling?", options: ["Identify threats during design", "Encrypt code", "Patch after release", "No review"], answer: 0, explanation: "Models threats to prioritize mitigations early." },
                    { domain: 8, type: 'single', question: "Which is a best practice for secure SDLC?", options: ["Shift-left security", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Integrate security early in development." },
                    { domain: 1, type: 'single', question: "What is the primary purpose of a security policy?", options: ["Define high-level rules and expectations", "Detail technical configurations", "List all vulnerabilities", "Encrypt all data"], answer: 0, explanation: "Policies set organizational standards; procedures detail implementation." },
                    { domain: 1, type: 'single', question: "Which is a key element of due diligence in third-party risk?", options: ["Assess vendor security posture before engagement", "Ignore vendor risks", "Share passwords", "Encrypt vendor data only"], answer: 0, explanation: "Due diligence identifies risks early in vendor relationships." },
                    { domain: 1, type: 'single', question: "What does a security awareness program aim to reduce?", options: ["Human error and social engineering success rate", "Hardware failures", "Network latency", "Storage costs"], answer: 0, explanation: "Training reduces phishing click rates and policy violations." },
                    { domain: 2, type: 'single', question: "Which is the best method for sanitizing SSDs?", options: ["Cryptographic erasure", "Degaussing", "Overwrite multiple times", "Format"], answer: 0, explanation: "Crypto erase is effective and faster for flash media." },
                    { domain: 2, type: 'single', question: "What is data in use?", options: ["Data being processed in memory", "Data at rest", "Data in transit", "Archived data"], answer: 0, explanation: "Data in use is vulnerable to memory scraping attacks." },
                    { domain: 2, type: 'single', question: "Which is a data ownership responsibility?", options: ["Determine classification and handling requirements", "Perform backups", "Encrypt data", "Delete old data"], answer: 0, explanation: "Owners define how data is classified and protected." },
                    { domain: 3, type: 'single', question: "What is zero trust architecture?", options: ["Never trust, always verify", "Trust internal network", "Perimeter only", "Implicit trust"], answer: 0, explanation: "Zero trust assumes breach and verifies every access." },
                    { domain: 3, type: 'single', question: "Which is a secure design principle?", options: ["Economy of mechanism", "Fail-safe defaults", "Complete mediation", "All of the above"], answer: 3, explanation: "These are classic Saltzer and Schroeder principles." },
                    { domain: 3, type: 'single', question: "What is the purpose of a secure enclave?", options: ["Isolate sensitive code/data execution", "Encrypt traffic", "Log events", "Manage patches"], answer: 0, explanation: "Enclaves protect code from the rest of the system (e.g., Intel SGX)." },
                    { domain: 4, type: 'single', question: "Which protocol is used for secure email?", options: ["S/MIME or PGP", "SMTP", "POP3", "IMAP"], answer: 0, explanation: "S/MIME provides encryption and signing." },
                    { domain: 4, type: 'single', question: "What is a bastion host?", options: ["Hardened jump server in DMZ", "Load balancer", "Web firewall", "SIEM collector"], answer: 0, explanation: "Bastion controls access to internal resources." },
                    { domain: 4, type: 'single', question: "Which is a benefit of micro-segmentation?", options: ["Limits lateral movement", "Increases bandwidth", "Simplifies management", "Reduces patching"], answer: 0, explanation: "Granular policies contain threats." },
                    { domain: 5, type: 'single', question: "What is privilege creep?", options: ["Accumulation of unnecessary privileges over time", "Password reuse", "MFA bypass", "No monitoring"], answer: 0, explanation: "Regular access reviews prevent creep." },
                    { domain: 5, type: 'single', question: "Which is a phishing-resistant MFA method?", options: ["FIDO2 / WebAuthn", "SMS OTP", "Email link", "Security question"], answer: 0, explanation: "Hardware tokens are phishing-resistant." },
                    { domain: 5, type: 'single', question: "What is the purpose of attribute-based access control (ABAC)?", options: ["Dynamic access based on attributes", "Role-based only", "Discretionary", "Mandatory"], answer: 0, explanation: "ABAC uses user, resource, and context attributes." },
                    { domain: 6, type: 'single', question: "What is fuzz testing?", options: ["Input random data to find crashes", "Manual review", "Static analysis", "Patch testing"], answer: 0, explanation: "Fuzzing discovers vulnerabilities by malformed input." },
                    { domain: 6, type: 'single', question: "Which is a type of security control test?", options: ["Synthetic transaction monitoring", "Log review", "Patch deployment", "Backup testing"], answer: 0, explanation: "Synthetic monitoring tests availability and performance." },
                    { domain: 7, type: 'single', question: "What is the purpose of change management?", options: ["Control modifications to reduce risk", "Speed up patching", "Ignore changes", "Delete logs"], answer: 0, explanation: "Change management prevents unauthorized changes." },
                    { domain: 7, type: 'single', question: "Which is a key forensic principle?", options: ["Preserve evidence integrity", "Delete originals", "Share publicly", "Modify evidence"], answer: 0, explanation: "Chain of custody and hashing ensure admissibility." },
                    { domain: 8, type: 'single', question: "What is secure by design?", options: ["Integrate security from the start", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Security is built-in throughout the SDLC." },
                    { domain: 8, type: 'single', question: "Which is a secure software development practice?", options: ["Static application security testing (SAST)", "No code review", "Hardcoded secrets", "Plaintext storage"], answer: 0, explanation: "SAST finds vulnerabilities early in code." },
                    // Domain 1: Security and Risk Management (continued)
                    { domain: 1, type: 'single', question: "What is the primary purpose of a security policy?", options: ["Define high-level rules and expectations", "Detail technical configurations", "List all vulnerabilities", "Encrypt all data"], answer: 0, explanation: "Policies set organizational standards; procedures detail implementation." },
                    { domain: 1, type: 'single', question: "Which is a key element of due diligence in third-party risk?", options: ["Assess vendor security posture before engagement", "Ignore vendor risks", "Share passwords", "Encrypt vendor data only"], answer: 0, explanation: "Due diligence identifies risks early in vendor relationships." },
                    { domain: 1, type: 'single', question: "What does a security awareness program aim to reduce?", options: ["Human error and social engineering success rate", "Hardware failures", "Network latency", "Storage costs"], answer: 0, explanation: "Training reduces phishing click rates and policy violations." },
                    { domain: 1, type: 'single', question: "Which is a common risk treatment strategy?", options: ["Avoid, Mitigate, Transfer, Accept", "Ignore", "Delete", "Encrypt only"], answer: 0, explanation: "These are the four standard risk treatment options." },
                    { domain: 1, type: 'single', question: "What is the purpose of a risk register?", options: ["Document identified risks, likelihood, impact, and mitigations", "Log incidents", "Manage passwords", "Track patches"], answer: 0, explanation: "Central record for risk management." },
                    { domain: 1, type: 'single', question: "Which regulation requires breach notification within 72 hours?", options: ["GDPR", "HIPAA", "PCI DSS", "SOX"], answer: 0, explanation: "GDPR mandates notification to supervisory authority within 72 hours." },
                    { domain: 1, type: 'single', question: "What is a security governance framework?", options: ["Aligns security with business objectives", "Encrypts data", "Manages firewalls", "Patches systems"], answer: 0, explanation: "Governance ensures security supports business goals." },
                    { domain: 1, type: 'single', question: "Which is a key component of a BCP?", options: ["Recovery Time Objective (RTO) and Recovery Point Objective (RPO)", "Incident response only", "Risk assessment", "Policy writing"], answer: 0, explanation: "RTO/RPO define acceptable downtime and data loss." },

                    // Domain 2: Asset Security (continued)
                    { domain: 2, type: 'single', question: "Which is the best method for sanitizing SSDs?", options: ["Cryptographic erasure", "Degaussing", "Overwrite multiple times", "Format"], answer: 0, explanation: "Crypto erase is effective and faster for flash media." },
                    { domain: 2, type: 'single', question: "What is data in use?", options: ["Data being processed in memory", "Data at rest", "Data in transit", "Archived data"], answer: 0, explanation: "Data in use is vulnerable to memory scraping attacks." },
                    { domain: 2, type: 'single', question: "Which is a data ownership responsibility?", options: ["Determine classification and handling requirements", "Perform backups", "Encrypt data", "Delete old data"], answer: 0, explanation: "Owners define how data is classified and protected." },
                    { domain: 2, type: 'single', question: "What is the purpose of asset inventory?", options: ["Identify and track all organizational assets", "Encrypt assets", "Delete old assets", "Share assets"], answer: 0, explanation: "Inventory ensures visibility and proper protection." },
                    { domain: 2, type: 'single', question: "Which is the most secure way to dispose of paper documents?", options: ["Cross-cut shredding or incineration", "Recycle bin", "Simple tear", "Recycle whole"], answer: 0, explanation: "Cross-cut shredding prevents reconstruction." },

                    // Domain 3: Security Architecture and Engineering (continued)
                    { domain: 3, type: 'single', question: "What is zero trust architecture?", options: ["Never trust, always verify", "Trust internal network", "Perimeter only", "Implicit trust"], answer: 0, explanation: "Zero trust assumes breach and verifies every access." },
                    { domain: 3, type: 'single', question: "Which is a secure design principle?", options: ["Economy of mechanism", "Fail-safe defaults", "Complete mediation", "All of the above"], answer: 3, explanation: "These are classic Saltzer and Schroeder principles." },
                    { domain: 3, type: 'single', question: "What is the purpose of a secure enclave?", options: ["Isolate sensitive code/data execution", "Encrypt traffic", "Log events", "Manage patches"], answer: 0, explanation: "Enclaves protect code from the rest of the system (e.g., Intel SGX)." },
                    { domain: 3, type: 'single', question: "Which is a benefit of using a hardware security module (HSM)?", options: ["Secure key storage and cryptographic operations", "Faster network throughput", "User authentication", "Log aggregation"], answer: 0, explanation: "HSMs protect private keys and perform crypto operations." },
                    { domain: 3, type: 'single', question: "What is the purpose of Secure Boot?", options: ["Verify integrity of boot components using digital signatures", "Encrypt the disk", "Hide boot process", "Speed up startup"], answer: 0, explanation: "Secure Boot prevents unauthorized code from loading during boot." },

                    // Domain 4: Communication and Network Security (continued)
                    { domain: 4, type: 'single', question: "Which protocol provides secure email transmission?", options: ["S/MIME or PGP", "SMTP", "POP3", "IMAP"], answer: 0, explanation: "S/MIME provides encryption and signing for email messages." },
                    { domain: 4, type: 'single', question: "What is a bastion host?", options: ["Hardened jump server in DMZ", "Load balancer", "Web firewall", "SIEM collector"], answer: 0, explanation: "Bastion controls access to internal resources." },
                    { domain: 4, type: 'single', question: "Which is a benefit of micro-segmentation?", options: ["Limits lateral movement", "Increases bandwidth", "Simplifies management", "Reduces patching"], answer: 0, explanation: "Granular policies contain threats." },
                    { domain: 4, type: 'single', question: "What is the purpose of a DMZ?", options: ["Host public-facing services with limited internal access", "Store sensitive data", "Run internal applications", "Provide VPN access"], answer: 0, explanation: "DMZ isolates internet-facing servers from the internal network." },

                    // Domain 5: Identity and Access Management (continued)
                    { domain: 5, type: 'single', question: "What is privilege creep?", options: ["Accumulation of unnecessary privileges over time", "Password reuse", "MFA bypass", "No monitoring"], answer: 0, explanation: "Regular access reviews prevent creep." },
                    { domain: 5, type: 'single', question: "Which is a phishing-resistant MFA method?", options: ["FIDO2 / WebAuthn", "SMS OTP", "Email link", "Security question"], answer: 0, explanation: "Hardware tokens are phishing-resistant." },
                    { domain: 5, type: 'single', question: "What is the purpose of attribute-based access control (ABAC)?", options: ["Dynamic access based on attributes", "Role-based only", "Discretionary", "Mandatory"], answer: 0, explanation: "ABAC uses user, resource, and context attributes." },
                    { domain: 5, type: 'single', question: "Which is a best practice for privileged access?", options: ["Just-in-time (JIT) access", "Permanent admin rights", "Shared credentials", "No monitoring"], answer: 0, explanation: "JIT reduces standing privileges and risk." },

                    // Domain 6: Security Assessment and Testing (continued)
                    { domain: 6, type: 'single', question: "What is fuzz testing?", options: ["Input random data to find crashes", "Manual review", "Static analysis", "Patch testing"], answer: 0, explanation: "Fuzzing discovers vulnerabilities by malformed input." },
                    { domain: 6, type: 'single', question: "Which is a type of security control test?", options: ["Synthetic transaction monitoring", "Log review", "Patch deployment", "Backup testing"], answer: 0, explanation: "Synthetic monitoring tests availability and performance." },
                    { domain: 6, type: 'single', question: "What is the purpose of a red team exercise?", options: ["Simulate real-world attacks", "Encrypt data", "Manage patches", "Log events"], answer: 0, explanation: "Red team emulates adversaries to test defenses." },

                    // Domain 7: Security Operations (continued)
                    { domain: 7, type: 'single', question: "What is the purpose of change management?", options: ["Control modifications to reduce risk", "Speed up patching", "Ignore changes", "Delete logs"], answer: 0, explanation: "Change management prevents unauthorized changes." },
                    { domain: 7, type: 'single', question: "Which is a key forensic principle?", options: ["Preserve evidence integrity", "Delete originals", "Share publicly", "Modify evidence"], answer: 0, explanation: "Chain of custody and hashing ensure admissibility." },
                    { domain: 7, type: 'single', question: "What is the purpose of a jump bag in incident response?", options: ["Pre-packed toolkit with forensics tools", "Backup storage", "Communication device", "Documentation folder"], answer: 0, explanation: "Jump bag contains ready-to-go tools for rapid response." },

                    // Domain 8: Software Development Security (continued)
                    { domain: 8, type: 'single', question: "What is secure by design?", options: ["Integrate security from the start", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Security is built-in throughout the SDLC." },
                    { domain: 8, type: 'single', question: "Which is a secure software development practice?", options: ["Static application security testing (SAST)", "No code review", "Hardcoded secrets", "Plaintext storage"], answer: 0, explanation: "SAST finds vulnerabilities early in code." },
                    // Domain 6: Security Assessment and Testing (heavy focus)
                    { domain: 6, type: 'single', question: "What is the primary objective of penetration testing?", options: ["Identify exploitable vulnerabilities before attackers do", "Encrypt all data", "Manage patches", "Log events"], answer: 0, explanation: "Pen testing simulates real attacks to find weaknesses." },
                    { domain: 6, type: 'single', question: "Which type of scan uses credentials to access systems?", options: ["Authenticated scan", "Unauthenticated scan", "External scan", "Passive scan"], answer: 0, explanation: "Authenticated scans provide deeper visibility into internal vulnerabilities." },
                    { domain: 6, type: 'single', question: "What is fuzz testing used for?", options: ["Discover crashes and vulnerabilities by sending malformed input", "Encrypt code", "Patch software", "Review logs"], answer: 0, explanation: "Fuzzing finds bugs by injecting unexpected data." },
                    { domain: 6, type: 'single', question: "Which is a key output of a vulnerability assessment?", options: ["Prioritized list of vulnerabilities with risk ratings", "Encrypted data", "Patched systems", "Deleted logs"], answer: 0, explanation: "VAs produce reports with severity and remediation recommendations." },
                    { domain: 6, type: 'single', question: "What is synthetic transaction monitoring?", options: ["Simulate user actions to test availability and performance", "Log review", "Patch deployment", "Backup testing"], answer: 0, explanation: "Synthetic monitoring proactively checks system health." },
                    { domain: 6, type: 'single', question: "Which is a common tool for web application vulnerability scanning?", options: ["OWASP ZAP or Burp Suite", "Nmap", "Wireshark", "Volatility"], answer: 0, explanation: "These tools scan for XSS, SQLi, CSRF, etc." },
                    { domain: 6, type: 'single', question: "What is the purpose of a red team exercise?", options: ["Emulate real adversary tactics to test defenses", "Encrypt data", "Manage patches", "Log events"], answer: 0, explanation: "Red team mimics attackers to evaluate detection/response." },
                    { domain: 6, type: 'single', question: "Which test validates security controls are working as designed?", options: ["Control assessment", "Penetration test", "Vulnerability scan", "Log review"], answer: 0, explanation: "Control assessments verify effectiveness." },
                    { domain: 6, type: 'single', question: "What is the difference between a vulnerability scan and penetration test?", options: ["Scan identifies; pen test exploits", "Both exploit", "Scan exploits; pen test identifies", "No difference"], answer: 0, explanation: "Scans detect; pen tests attempt exploitation." },
                    { domain: 6, type: 'single', question: "Which is a best practice for vulnerability management?", options: ["Prioritize remediation based on risk and exploitability", "Patch everything immediately", "Ignore low-risk findings", "Run scans annually"], answer: 0, explanation: "Risk-based prioritization optimizes effort." },

                    // Domain 7: Security Operations (heavy focus)
                    { domain: 7, type: 'single', question: "What is the purpose of change management?", options: ["Control modifications to reduce risk", "Speed up patching", "Ignore changes", "Delete logs"], answer: 0, explanation: "Change management prevents unauthorized or untested changes." },
                    { domain: 7, type: 'single', question: "Which is a key forensic principle?", options: ["Preserve evidence integrity", "Delete originals", "Share publicly", "Modify evidence"], answer: 0, explanation: "Chain of custody and hashing ensure admissibility." },
                    { domain: 7, type: 'single', question: "What is the purpose of a jump bag in incident response?", options: ["Pre-packed toolkit with forensics tools", "Backup storage", "Communication device", "Documentation folder"], answer: 0, explanation: "Jump bag contains ready-to-go tools for rapid response." },
                    { domain: 7, type: 'single', question: "Which log source is critical for detecting privilege escalation?", options: ["Security event log (Event ID 4672/4673)", "Application log", "System log", "DNS log"], answer: 0, explanation: "Event ID 4672/4673 shows new privileges assigned." },
                    { domain: 7, type: 'single', question: "What is the purpose of a SIEM system?", options: ["Collect, correlate, and alert on security events", "Encrypt data", "Manage patches", "User provisioning"], answer: 0, explanation: "SIEM provides centralized visibility and threat detection." },
                    { domain: 7, type: 'single', question: "Which is a containment technique in incident response?", options: ["Isolate affected systems", "Pay ransom", "Run antivirus", "Reboot"], answer: 0, explanation: "Containment stops the spread of the incident." },
                    { domain: 7, type: 'single', question: "What is the final phase of NIST incident response lifecycle?", options: ["Post-Incident Activity (lessons learned)", "Recovery", "Eradication", "Containment"], answer: 0, explanation: "Post-incident includes root cause analysis and improvement." },
                    { domain: 7, type: 'single', question: "Which tool is commonly used for memory forensics?", options: ["Volatility", "Wireshark", "Nmap", "Burp Suite"], answer: 0, explanation: "Volatility analyzes memory dumps for hidden processes." },
                    { domain: 7, type: 'single', question: "What is the purpose of a honeypot?", options: ["Attract and detect attackers", "Store backups", "Encrypt traffic", "Manage patches"], answer: 0, explanation: "Honeypots lure attackers to study tactics." },
                    { domain: 7, type: 'single', question: "Which is a common indicator of compromise in logs?", options: ["Unusual outbound connections", "Normal logins", "Patch installs", "Backups"], answer: 0, explanation: "C2 or exfiltration traffic often shows suspicious connections." },

                    // Domain 8: Software Development Security (heavy focus)
                    { domain: 8, type: 'single', question: "What is secure by design?", options: ["Integrate security from the start", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Security is built-in throughout the SDLC." },
                    { domain: 8, type: 'single', question: "Which is a secure software development practice?", options: ["Static application security testing (SAST)", "No code review", "Hardcoded secrets", "Plaintext storage"], answer: 0, explanation: "SAST finds vulnerabilities early in code." },
                    { domain: 8, type: 'single', question: "What is threat modeling?", options: ["Identify threats during design", "Encrypt code", "Patch after release", "No review"], answer: 0, explanation: "Models threats to prioritize mitigations early." },
                    { domain: 8, type: 'single', question: "Which is a secure SDLC practice?", options: ["Shift-left security", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Shift-left integrates security early." },
                    { domain: 8, type: 'single', question: "What is input validation used for?", options: ["Prevent injection attacks and buffer overflows", "Speed up application", "Encrypt data", "Log user activity"], answer: 0, explanation: "Validation ensures only expected data is processed." },
                    { domain: 8, type: 'single', question: "Which is a secure way to handle session tokens?", options: ["Use HttpOnly + Secure + SameSite cookies", "Store in URL", "Store in localStorage", "No expiration"], answer: 0, explanation: "HttpOnly prevents JS access; Secure forces HTTPS." },
                    { domain: 8, type: 'single', question: "What is the purpose of code signing?", options: ["Verify integrity and authenticity of software", "Encrypt code", "Compress code", "Delete code"], answer: 0, explanation: "Signing prevents tampering and verifies publisher." },
                    { domain: 8, type: 'single', question: "Which is a best practice for third-party libraries?", options: ["Regularly scan and update dependencies", "Hardcode versions", "No scanning", "Use outdated libs"], answer: 0, explanation: "Dependency scanning finds known vulnerabilities." },
                    // Domain 1: Security and Risk Management
                    { domain: 1, type: 'single', question: "Which is the PRIMARY reason organizations implement security governance?", options: ["Align security with business objectives", "Eliminate all risk", "Reduce patching effort", "Encrypt everything"], answer: 0, explanation: "Governance ensures security enables and supports business goals." },
                    { domain: 1, type: 'single', question: "What is the purpose of a risk appetite statement?", options: ["Define acceptable level of risk", "Eliminate all risk", "Set maximum budget", "List all controls"], answer: 0, explanation: "Guides risk treatment decisions." },
                    { domain: 1, type: 'single', question: "Which regulation governs protection of health information in the US?", options: ["HIPAA", "GDPR", "PCI DSS", "SOX"], answer: 0, explanation: "Health Insurance Portability and Accountability Act." },
                    { domain: 1, type: 'single', question: "What is the first step in the risk management process?", options: ["Risk identification", "Risk treatment", "Risk monitoring", "Risk acceptance"], answer: 0, explanation: "Identify before assessing or treating." },
                    { domain: 1, type: 'single', question: "Which is a key component of security awareness training?", options: ["Phishing simulations", "Firewall rules", "Patch management", "Encryption only"], answer: 0, explanation: "Simulations reduce human error." },
                    { domain: 1, type: 'single', question: "What does a BCP primarily ensure?", options: ["Continuation of critical business functions during disruption", "Encryption of data", "User access management", "Daily patching"], answer: 0, explanation: "Business Continuity Plan focuses on operational resilience." },
                    { domain: 1, type: 'single', question: "Which is a standard risk treatment option?", options: ["Avoid", "Ignore", "Delete", "Encrypt only"], answer: 0, explanation: "Avoid, Mitigate, Transfer, Accept are the four options." },

                    // Domain 2: Asset Security
                    { domain: 2, type: 'single', question: "What is the most secure method for destroying SSDs?", options: ["Cryptographic erasure", "Degaussing", "Overwrite multiple times", "Format"], answer: 0, explanation: "Crypto erase is efficient for flash media." },
                    { domain: 2, type: 'single', question: "What is data remanence?", options: ["Residual data after deletion attempts", "Encrypted data", "Backed-up data", "Live data"], answer: 0, explanation: "Data that persists after normal removal." },
                    { domain: 2, type: 'single', question: "Who is responsible for data classification?", options: ["Data owner", "Data custodian", "Data processor", "Data user"], answer: 0, explanation: "Owner determines sensitivity and handling." },
                    { domain: 3, type: 'single', question: "What is the core principle of zero trust?", options: ["Never trust, always verify", "Trust internal network", "Perimeter security only", "Implicit trust"], answer: 0, explanation: "Assumes breach and verifies every access." },
                    { domain: 3, type: 'single', question: "Which secure design principle minimizes complexity?", options: ["Economy of mechanism", "Fail-safe defaults", "Least privilege", "Complete mediation"], answer: 0, explanation: "Keep it simple to reduce attack surface." },
                    { domain: 3, type: 'single', question: "What is the purpose of a TPM?", options: ["Secure key storage and root of trust", "Network encryption", "User login", "Log collection"], answer: 0, explanation: "Trusted Platform Module provides hardware-based security." },
                    { domain: 4, type: 'single', question: "Which protocol is used for secure remote administration?", options: ["SSH", "Telnet", "FTP", "HTTP"], answer: 0, explanation: "SSH provides encrypted, authenticated access." },
                    { domain: 4, type: 'single', question: "What is the main purpose of a VPN?", options: ["Create encrypted tunnel over untrusted networks", "Increase bandwidth", "Block traffic", "Log connections"], answer: 0, explanation: "VPNs secure communication over public internet." },
                    { domain: 5, type: 'single', question: "Which is the strongest authentication factor category?", options: ["Something you have (hardware token)", "Something you know (password)", "Something you are (biometrics)", "Somewhere you are (location)"], answer: 0, explanation: "Hardware tokens are phishing-resistant." },
                    { domain: 5, type: 'single', question: "What is RBAC?", options: ["Role-Based Access Control", "Rule-Based Access Control", "Discretionary Access Control", "Mandatory Access Control"], answer: 0, explanation: "Permissions assigned to roles, not individuals." },
                    { domain: 6, type: 'single', question: "What is the main goal of penetration testing?", options: ["Identify exploitable vulnerabilities", "Encrypt data", "Manage patches", "Log events"], answer: 0, explanation: "Simulates attacks to find weaknesses." },
                    { domain: 6, type: 'single', question: "Which scan uses credentials for deeper visibility?", options: ["Authenticated scan", "Unauthenticated scan", "Passive scan", "External scan"], answer: 0, explanation: "Authenticated scans access internal configurations." },
                    { domain: 6, type: 'single', question: "What does fuzz testing do?", options: ["Sends malformed input to find crashes", "Encrypts code", "Patches software", "Reviews logs"], answer: 0, explanation: "Fuzzing discovers bugs via unexpected data." },
                    { domain: 6, type: 'single', question: "What is the primary output of a vulnerability assessment?", options: ["Prioritized list of vulnerabilities", "Encrypted data", "Patched systems", "Deleted logs"], answer: 0, explanation: "VA reports include severity and remediation." },
                    { domain: 6, type: 'single', question: "What is synthetic transaction monitoring?", options: ["Simulate user actions to test availability", "Log review", "Patch deployment", "Backup testing"], answer: 0, explanation: "Proactively checks system health." },
                    { domain: 6, type: 'single', question: "Which tool is commonly used for web app scanning?", options: ["OWASP ZAP or Burp Suite", "Nmap", "Wireshark", "Volatility"], answer: 0, explanation: "These detect XSS, SQLi, CSRF, etc." },
                    { domain: 6, type: 'single', question: "What does a red team exercise emulate?", options: ["Real adversary tactics", "Encryption", "Patching", "Logging"], answer: 0, explanation: "Tests detection and response capabilities." },
                    { domain: 7, type: 'single', question: "What is the purpose of change management?", options: ["Control modifications to reduce risk", "Speed patching", "Ignore changes", "Delete logs"], answer: 0, explanation: "Prevents untested/unauthorized changes." },
                    { domain: 7, type: 'single', question: "Which forensic principle is critical?", options: ["Preserve evidence integrity", "Delete originals", "Share publicly", "Modify evidence"], answer: 0, explanation: "Chain of custody and hashing ensure admissibility." },
                    { domain: 7, type: 'single', question: "What is a jump bag used for?", options: ["Pre-packed IR/forensics toolkit", "Backup storage", "Communication", "Documentation"], answer: 0, explanation: "Ready-to-go tools for rapid response." },
                    { domain: 7, type: 'single', question: "Which log is critical for privilege escalation detection?", options: ["Security event log (Event ID 4672/4673)", "Application log", "System log", "DNS log"], answer: 0, explanation: "Shows new privileges assigned to tokens." },
                    { domain: 7, type: 'single', question: "What is the primary function of a SIEM?", options: ["Log correlation and alerting", "Encryption", "Patching", "User provisioning"], answer: 0, explanation: "Centralized threat detection." },
                    { domain: 7, type: 'single', question: "Which is a containment action?", options: ["Isolate affected systems", "Pay ransom", "Run antivirus", "Reboot"], answer: 0, explanation: "Stops spread of incident." },
                    { domain: 7, type: 'single', question: "What is the final NIST IR phase?", options: ["Post-Incident Activity", "Recovery", "Eradication", "Containment"], answer: 0, explanation: "Lessons learned and process improvement." },
                    { domain: 7, type: 'single', question: "Which tool is used for memory forensics?", options: ["Volatility", "Wireshark", "Nmap", "Burp Suite"], answer: 0, explanation: "Extracts hidden processes from RAM." },
                    { domain: 7, type: 'single', question: "What is the purpose of a honeypot?", options: ["Detect and study attackers", "Store backups", "Encrypt traffic", "Manage patches"], answer: 0, explanation: "Lures attackers to gain intelligence." },
                    { domain: 8, type: 'single', question: "What is secure by design?", options: ["Integrate security from the start", "Add security at end", "No testing", "Vendor defaults"], answer: 0, explanation: "Security is built-in throughout SDLC." },
                    { domain: 8, type: 'single', question: "Which is a secure coding practice?", options: ["Input validation", "Hardcoded credentials", "No error handling", "Plaintext storage"], answer: 0, explanation: "Prevents injection and overflows." },
                    { domain: 8, type: 'single', question: "What is threat modeling?", options: ["Identify threats during design", "Encrypt code", "Patch after release", "No review"], answer: 0, explanation: "Prioritizes mitigations early." },
                    { domain: 8, type: 'single', question: "Which is a best practice for dependencies?", options: ["Regularly scan and update libraries", "Hardcode versions", "No scanning", "Use outdated libs"], answer: 0, explanation: "Dependency scanning finds known vulnerabilities." },
                    { domain: 8, type: 'single', question: "What is SAST?", options: ["Static Application Security Testing", "Dynamic testing", "Manual review", "Runtime protection"], answer: 0, explanation: "Analyzes source code for vulnerabilities." },
                            // ==================================================
                    // DOMAIN 2 ‚Äì Asset Security (50 questions)
                    // ==================================================
                    { domain: 2, type: 'single', question: "Which is the most secure method for sanitizing flash-based media (SSD, USB)?", options: ["Cryptographic erasure", "Degaussing", "Multiple overwrite passes", "Physical destruction only"], answer: 0, explanation: "Crypto erase securely wipes keys, rendering data unrecoverable on modern flash devices." },
                    { domain: 2, type: 'single', question: "What is data remanence?", options: ["Residual data remaining after deletion attempts", "Encrypted data", "Backed-up data", "Data in transit"], answer: 0, explanation: "Remanence is the leftover representation of data after erasure attempts." },
                    { domain: 2, type: 'single', question: "Who is ultimately responsible for classifying data?", options: ["Data owner", "Data custodian", "Data processor", "Security administrator"], answer: 0, explanation: "The data owner determines classification and handling requirements." },
                    { domain: 2, type: 'single', question: "Which is the BEST method for destroying paper documents containing Top Secret information?", options: ["Cross-cut shredding followed by pulping or incineration", "Strip-cut shredding", "Recycling", "Simple tearing"], answer: 0, explanation: "Cross-cut + pulping/incineration prevents reconstruction." },
                    { domain: 2, type: 'single', question: "What is the purpose of media sanitization?", options: ["Remove sensitive data so media can be reused or disposed", "Encrypt media", "Back up data", "Label media"], answer: 0, explanation: "Sanitization ensures data is irrecoverable before disposal or reuse." },
                    { domain: 2, type: 'single', question: "Which standard provides guidelines for media sanitization?", options: ["NIST SP 800-88", "ISO 27001", "PCI DSS", "HIPAA"], answer: 0, explanation: "SP 800-88 defines Clear, Purge, and Destroy methods." },
                    { domain: 2, type: 'single', question: "What is scoping in asset management?", options: ["Defining which assets are in scope for protection", "Encrypting assets", "Deleting assets", "Backing up assets"], answer: 0, explanation: "Scoping identifies assets requiring protection under policies." },
                    { domain: 2, type: 'single', question: "Which is a secure method for handling end-of-life media?", options: ["Physical destruction or certified sanitization", "Delete files", "Format once", "Recycle as-is"], answer: 0, explanation: "Certified processes ensure data cannot be recovered." },
                    { domain: 2, type: 'single', question: "What is the role of a data custodian?", options: ["Implement technical controls as directed by the owner", "Classify data", "Approve access", "Audit usage"], answer: 0, explanation: "Custodians handle day-to-day protection (backups, access controls)." },
                    { domain: 2, type: 'single', question: "Which is the correct order for data handling based on classification?", options: ["Public < Internal < Confidential < Secret < Top Secret", "Top Secret < Secret < Confidential < Internal < Public", "All data handled the same", "Only encrypt Top Secret"], answer: 0, explanation: "Increasing classification = increasing protection requirements." },

                    // ==================================================
                    // DOMAIN 3 ‚Äì Security Architecture and Engineering (50 questions)
                    // ==================================================
                    { domain: 3, type: 'single', question: "Which cryptographic mode provides both confidentiality and authenticity?", options: ["GCM (Galois/Counter Mode)", "CBC", "ECB", "CFB"], answer: 0, explanation: "GCM is AEAD ‚Äì authenticated encryption with associated data." },
                    { domain: 3, type: 'single', question: "What is the primary purpose of a Trusted Platform Module (TPM)?", options: ["Secure storage of cryptographic keys and measurements", "Network encryption", "User authentication", "Log collection"], answer: 0, explanation: "TPM provides hardware root of trust for boot integrity and key protection." },
                    { domain: 3, type: 'single', question: "Which principle states 'keep it simple' in secure design?", options: ["Economy of mechanism", "Fail-safe defaults", "Least privilege", "Open design"], answer: 0, explanation: "Simpler designs have fewer vulnerabilities." },
                    { domain: 3, type: 'single', question: "What is the purpose of Secure Boot?", options: ["Verify digital signatures of boot components", "Encrypt the disk", "Speed up boot", "Hide processes"], answer: 0, explanation: "Prevents bootkits and unauthorized OS loaders." },
                    { domain: 3, type: 'single', question: "Which is a secure design principle for access control?", options: ["Complete mediation", "Implicit allow", "No logging", "Single point of failure"], answer: 0, explanation: "Every access request must be checked." },
                    { domain: 3, type: 'single', question: "What is the primary benefit of using a Hardware Security Module (HSM)?", options: ["Tamper-resistant key storage and crypto operations", "Faster hashing", "User login", "Log storage"], answer: 0, explanation: "HSMs protect private keys from extraction." },
                    { domain: 3, type: 'single', question: "Which cryptographic algorithm is post-quantum resistant (lattice-based)?", options: ["Kyber", "RSA", "ECC", "AES"], answer: 0, explanation: "Kyber is a NIST-selected post-quantum KEM." },
                    { domain: 3, type: 'single', question: "What is the purpose of a secure enclave?", options: ["Isolate sensitive code/data from the rest of the system", "Encrypt network traffic", "Manage patches", "Log events"], answer: 0, explanation: "Enclaves (e.g., Intel SGX, Apple Secure Enclave) protect against privileged attacks." },
                    { domain: 3, type: 'single', question: "Which is a key benefit of constant-time cryptographic implementations?", options: ["Prevent timing side-channel attacks", "Faster execution", "Smaller key size", "No salting needed"], answer: 0, explanation: "Constant-time prevents leaking info via execution time." },
                    { domain: 3, type: 'single', question: "What is the primary goal of secure multiparty computation?", options: ["Multiple parties compute a function without revealing inputs", "Encrypt data at rest", "Speed up hashing", "Manage keys"], answer: 0, explanation: "Enables privacy-preserving collaborative computation." },

                    // ==================================================
                    // DOMAIN 4 ‚Äì Communication and Network Security (50 questions)
                    // ==================================================
                    { domain: 4, type: 'single', question: "Which protocol provides secure remote administration?", options: ["SSH", "Telnet", "RDP without TLS", "FTP"], answer: 0, explanation: "SSH encrypts traffic and authenticates users." },
                    { domain: 4, type: 'single', question: "What is the purpose of a VPN?", options: ["Create encrypted tunnel over untrusted networks", "Increase bandwidth", "Block traffic", "Log connections"], answer: 0, explanation: "VPNs secure communication over public internet." },
                    { domain: 4, type: 'single', question: "Which is the strongest wireless security protocol?", options: ["WPA3", "WPA2", "WEP", "Open"], answer: 0, explanation: "WPA3 uses SAE and resists offline attacks." },
                    { domain: 4, type: 'single', question: "What is the purpose of IPsec?", options: ["Secure IP communications with authentication and encryption", "Route traffic", "Name resolution", "Load balancing"], answer: 0, explanation: "IPsec operates at Layer 3 for VPNs and host-to-host security." },
                    { domain: 4, type: 'single', question: "Which attack exploits weak ARP resolution?", options: ["ARP poisoning", "DNS spoofing", "DHCP starvation", "MAC flooding"], answer: 0, explanation: "Associates attacker MAC with victim IP." },
                    { domain: 4, type: 'single', question: "What is the purpose of a bastion host?", options: ["Hardened jump server for controlled access", "Load balancer", "Web server", "Database"], answer: 0, explanation: "Bastion provides single entry point into private networks." },
                    { domain: 4, type: 'single', question: "Which is a secure email standard?", options: ["S/MIME", "SMTP", "POP3", "IMAP"], answer: 0, explanation: "S/MIME provides encryption and digital signing." },
                    { domain: 4, type: 'single', question: "What is the main risk of using Telnet?", options: ["Transmits data in plaintext", "Slow connection", "High CPU usage", "No authentication"], answer: 0, explanation: "Credentials and commands are visible to sniffers." },
                    { domain: 4, type: 'single', question: "Which protocol is used for secure DNS queries?", options: ["DNS over TLS (DoT) or DNS over HTTPS (DoH)", "Plain DNS", "LDAP", "Kerberos"], answer: 0, explanation: "DoT/DoH encrypt DNS queries to prevent eavesdropping." },
                    { domain: 4, type: 'single', question: "What is the purpose of a DMZ?", options: ["Isolate public-facing services", "Store sensitive data", "Run internal apps", "Provide VPN"], answer: 0, explanation: "DMZ limits exposure of internal network." },

                    // ==================================================
                    // DOMAIN 5 ‚Äì Identity and Access Management (50 questions)
                    // ==================================================
                    { domain: 5, type: 'single', question: "Which is the strongest form of multi-factor authentication?", options: ["Phishing-resistant hardware token (FIDO2)", "SMS OTP", "Email link", "Security questions"], answer: 0, explanation: "FIDO2 uses public-key crypto and is resistant to phishing." },
                    { domain: 5, type: 'single', question: "What is the purpose of just-in-time (JIT) access?", options: ["Grant temporary elevated privileges only when needed", "Permanent admin rights", "Share credentials", "No monitoring"], answer: 0, explanation: "JIT reduces standing privileges." },
                    { domain: 5, type: 'single', question: "Which is a benefit of role-based access control (RBAC)?", options: ["Simplifies administration by assigning permissions to roles", "Assigns permissions to individuals", "No hierarchy", "Manual per-user"], answer: 0, explanation: "Users inherit permissions from roles." },
                    { domain: 5, type: 'single', question: "What is privilege creep?", options: ["Accumulation of unnecessary privileges over time", "Password reuse", "MFA bypass", "No monitoring"], answer: 0, explanation: "Regular reviews prevent creep." },
                    { domain: 5, type: 'single', question: "Which is a secure way to implement single sign-on?", options: ["SAML 2.0 or OpenID Connect", "Shared passwords", "Basic auth", "No SSO"], answer: 0, explanation: "Federated standards with tokens." },
                    { domain: 5, type: 'single', question: "What is the purpose of attribute-based access control (ABAC)?", options: ["Dynamic access based on attributes", "Role-based only", "Discretionary", "Mandatory"], answer: 0, explanation: "Uses user, resource, environment attributes." },
                    { domain: 5, type: 'single', question: "Which is a best practice for privileged access management?", options: ["Use PAM solution with session recording", "Share admin passwords", "Permanent admin rights", "No auditing"], answer: 0, explanation: "PAM provides JIT, recording, and monitoring." },
                    { domain: 5, type: 'single', question: "What is the risk of using SMS for MFA?", options: ["SIM swapping and interception", "No risk", "Slower login", "Only cost"], answer: 0, explanation: "SMS is vulnerable to social engineering and SS7 attacks." },
                    { domain: 5, type: 'single', question: "Which is a key benefit of federated identity?", options: ["Single credential across multiple providers", "Local accounts only", "No SSO", "Shared passwords"], answer: 0, explanation: "Users authenticate once, access many services." },
                    { domain: 5, type: 'single', question: "What is the purpose of a service account in IAM?", options: ["Non-human account for applications/services", "Regular user account", "Guest account", "Admin account"], answer: 0, explanation: "Used by apps to access resources." }



                    // Add more CISSP questions here as needed
                ]
            },

            {
                id: 4,
                title: "SC-300 Microsoft Identity and Access Administrator Practice Exam",
                icon: "ü™™",
                difficulty: "intermediate",
                description: "Realistic simulation of the SC-300 certification exam ‚Äì randomized questions covering Microsoft Entra ID identity and access management",
                timeLimitMinutes: 120, // SC-300 is typically up to 120-150 minutes for practice with ~40-60 questions
                domainWeights: [0.225, 0.275, 0.225, 0.225, 0.05],
                questions: [
                    // Domain 1: Implement and manage user identities (approx. 20-25%)
                    // Domain 2: Implement authentication and access management (approx. 25-30%)
                    // Domain 3: Implement workload identities and access to resources (approx. 20-25%)
                    // Domain 4: Plan and implement identity governance (approx. 20-25%)
                    // Domain 5: Monitor, maintain, and troubleshoot identity solutions (approx. 5-10%)
                    { domain: 2, type: 'single', question: "What is the primary purpose of Conditional Access policies in Microsoft Entra ID?", options: ["To enforce access controls based on signals like user risk, device state, and location", "To synchronize on-premises AD with the cloud", "To manage guest user invitations", "To assign privileged roles just-in-time"], answer: 0, explanation: "Conditional Access uses signals to determine access granting, blocking, or requiring MFA/compliance." },
                            // SC-300 Microsoft Entra ID practice questions ‚Äì new batch 2026 edition

                    { domain: 2, type: 'single', question: "You need to require phishing-resistant MFA specifically for users accessing from unmanaged devices. Which Conditional Access policy setting achieves this most precisely?", options: ["Authentication strength = Phishing-resistant MFA + Device condition = Exclude hybrid Azure AD joined", "Grant = Require multifactor authentication", "Authentication context + session controls", "User risk = High + block access"], answer: 0, explanation: "Authentication strength policies allow granular selection of phishing-resistant methods and can be combined with device conditions." },

                    { domain: 2, type: 'single', question: "A Conditional Access policy is set to 'Report-only' mode and targets all users for Exchange Online. What will users experience when they match the policy?", options: ["No enforcement ‚Äì only logging occurs", "MFA prompt for every sign-in", "Block access silently", "Warning message in Outlook"], answer: 0, explanation: "Report-only mode logs what would happen without applying any grant or block controls." },

                    { domain: 4, type: 'single', question: "You want managers to approve access package requests for their direct reports only. What must be configured in the access package policy?", options: ["Approval required from manager (single-stage)", "Multi-stage approval with group owner", "No approval ‚Äì auto-approve", "Require justification only"], answer: 0, explanation: "Entitlement management supports manager as single approver for scoped self-service requests." },

                    { domain: 1, type: 'single', question: "After enabling cross-tenant synchronization from tenant A to tenant B, users from A appear in B but cannot sign in. What is the most likely missing configuration?", options: ["Inbound trust settings in cross-tenant access configuration in tenant B", "Guest invite restrictions in tenant A", "Conditional Access policy in tenant B", "SAML federation metadata"], answer: 0, explanation: "Cross-tenant synchronization requires explicit inbound trust in the target tenant." },

                    { domain: 3, type: 'single', question: "An Azure App Service needs to call Microsoft Graph to read user profiles without user interaction. Which authentication flow and permission type should you use?", options: ["Client credentials flow + Application permissions", "Authorization code flow + Delegated permissions", "Device code flow", "On-behalf-of flow"], answer: 0, explanation: "Client credentials is the standard for daemon/app-only access to Graph." },

                    { domain: 5, type: 'single', question: "You need to investigate why a user was able to activate a PIM-eligible Global Administrator role without approval. Where should you look first?", options: ["Privileged Identity Management ‚Üí Audit logs ‚Üí Activation requests", "Sign-in logs ‚Üí Conditional Access tab", "Audit logs ‚Üí Role management", "Identity Protection ‚Üí Risky users"], answer: 0, explanation: "PIM audit logs show activation details, including whether approval was required or bypassed." },

                    { domain: 2, type: 'multi', question: "Select all that apply: Which authentication methods are classified as phishing-resistant in Microsoft Entra authentication strengths?", options: ["FIDO2 security key", "Certificate-based authentication", "Microsoft Authenticator ‚Äì number matching", "Windows Hello for Business", "SMS one-time passcode"], answer: [0,1,3], explanation: "FIDO2, CBA, and WHfB are phishing-resistant; number matching improves resilience but is not fully classified as resistant." },

                    { domain: 4, type: 'single', question: "You need to automatically expire guest user access after 60 days of inactivity. What is the recommended and most automated approach?", options: ["Access review on the All guest users dynamic group with auto-remove", "Entitlement management access package expiration", "Conditional Access inactivity-based block", "Lifecycle workflow with inactive trigger"], answer: 0, explanation: "Access reviews can be scoped to dynamic guest groups and set to auto-apply removal." },

                    { domain: 1, type: 'single', question: "Your organization has two Entra ID tenants and wants B2B direct connect for Teams shared channels without guest accounts. Which setting must be configured in both tenants?", options: ["Cross-tenant access settings ‚Äì B2B direct connect trust", "External collaboration settings ‚Äì Allow invitations", "Entitlement management connected organizations", "Federation with SAML/WS-Fed"], answer: 0, explanation: "B2B direct connect requires explicit trust configuration in cross-tenant settings." },

                    { domain: 3, type: 'single', question: "A workload identity in Azure Kubernetes Service (AKS) needs to authenticate to Azure Key Vault using workload identity federation. What is required on the Kubernetes side?", options: ["Service account annotation with client ID and tenant ID", "Secret with client secret", "Managed identity extension", "AAD Pod Identity (deprecated)"], answer: 0, explanation: "Workload identity federation uses OIDC tokens from Kubernetes service accounts." },

                    { domain: 5, type: 'single', question: "The Identity Secure Score is showing low due to many permanent Privileged Role assignments. What remediation step does it recommend first?", options: ["Convert permanent assignments to eligible in Privileged Identity Management", "Enable security defaults", "Require MFA for all admins", "Run access reviews on users"], answer: 0, explanation: "Reducing standing privileged access via PIM eligible roles is a top Identity Secure Score recommendation." },

                    { domain: 2, type: 'single', question: "You need to block legacy authentication for all users except a legacy application that cannot be modernized yet. What is the most targeted approach?", options: ["Conditional Access policy excluding the legacy service principal + block legacy auth", "Authentication methods policy ‚Äì disable basic auth", "Security defaults", "Per-user MFA legacy block"], answer: 0, explanation: "Conditional Access can exclude specific service principals while blocking legacy clients broadly." },

                    { domain: 4, type: 'multi', question: "Select all that apply: Which components can be included in an entitlement management access package?", options: ["Microsoft Entra groups", "Enterprise applications", "SharePoint sites", "Azure role assignments", "Teams channels"], answer: [0,1,2], explanation: "Access packages can bundle groups, apps, and SharePoint sites; Azure roles and Teams channels are handled separately." },

                    { domain: 1, type: 'single', question: "You are migrating from Entra Connect Sync to Entra Cloud Sync. Which feature is NOT supported in Cloud Sync?", options: ["Password writeback", "Group writeback to on-premises", "Pass-through authentication", "Device writeback"], answer: 0, explanation: "Cloud Sync does not support password writeback; that requires the older Entra Connect Sync." },

                    { domain: 3, type: 'single', question: "An Azure Function uses a managed identity to access an on-premises API via Entra Application Proxy. What type of identity is recommended?", options: ["System-assigned managed identity", "User-assigned managed identity", "Service principal with certificate", "App registration with secret"], answer: 0, explanation: "System-assigned is simplest and automatically deleted with the resource." },

                    { domain: 5, type: 'single', question: "A user is blocked by a high user risk policy. After remediation, how do you allow the user to sign in again?", options: ["Confirm user compromised in Identity Protection and reset password", "Dismiss the risk detection", "Require re-register MFA", "Both A and C"], answer: 3, explanation: "High risk requires confirmation + password reset; re-register MFA is also recommended." },

                    { domain: 2, type: 'single', question: "You want to require compliant devices for all cloud apps except approved unmanaged devices for specific low-risk apps. What feature helps?", options: ["Authentication contexts in Conditional Access", "Named locations exclusion", "Device filters", "Continuous access evaluation"], answer: 0, explanation: "Authentication contexts allow different policies for different apps using the same signals." },

                    { domain: 4, type: 'single', question: "You need to review who has access to a highly sensitive enterprise application every 90 days. What is the best governance feature?", options: ["Access reviews scoped to the enterprise application", "PIM eligible assignments", "Entitlement management access package review", "Conditional Access policy audit"], answer: 0, explanation: "Access reviews can be configured directly on enterprise applications." },

                    { domain: 1, type: 'single', question: "What must be configured to allow seamless SSO for users in a hybrid environment after password hash sync is enabled?", options: ["Enable seamless SSO in Entra Connect", "Create a Conditional Access policy", "Add the computer account to the local Intranet zone", "Enable PTA"], answer: 0, explanation: "Seamless SSO is enabled in Entra Connect and requires specific network configurations." },

                    { domain: 3, type: 'multi', question: "Select all that apply: Which are valid ways to assign permissions to a workload identity without secrets?", options: ["Federated credential using OIDC from GitHub Actions", "System-assigned managed identity", "User-assigned managed identity with federated credential", "App registration with client secret", "Certificate-based authentication"], answer: [0,1,2], explanation: "Federation and managed identities eliminate secret management." },

                    { domain: 5, type: 'single', question: "To monitor changes to Conditional Access policies across the tenant, which log type should you query?", options: ["Audit logs ‚Äì Policy category", "Sign-in logs", "Provisioning logs", "Risk detections"], answer: 0, explanation: "Audit logs capture policy creation, update, and deletion events." },

                    { domain: 2, type: 'single', question: "A policy requires devices to be compliant for high-risk sign-ins. If a device is noncompliant but the user is low risk, what happens?", options: ["Access is allowed ‚Äì risk condition not met", "MFA is required instead", "Access is blocked", "Session is limited"], answer: 0, explanation: "Conditional Access conditions are AND-ed; if risk condition is not met, the policy does not apply." },

                    { domain: 4, type: 'single', question: "What is the best way to automatically provision new hires into the correct department group and assign access packages?", options: ["Lifecycle workflows + dynamic groups + entitlement management", "Entra Connect group writeback", "PIM automatic activation", "Conditional Access named locations"], answer: 0, explanation: "Lifecycle workflows automate joiner tasks, including group membership and access package assignment." },

                    { domain: 1, type: 'single', question: "You need to prevent users from one specific partner tenant from being invited as guests. Where do you configure this?", options: ["Cross-tenant access settings ‚Äì Inbound trust ‚Äì Block specific tenant", "External collaboration settings ‚Äì Guest invite restrictions", "Conditional Access ‚Äì Named locations", "Entitlement management ‚Äì Connected organizations"], answer: 0, explanation: "Cross-tenant settings allow granular blocking of specific tenants." },

                    { domain: 3, type: 'single', question: "An Azure Logic App needs to authenticate to an on-premises REST API using Entra ID credentials without storing secrets. What identity type is best?", options: ["System-assigned managed identity + Application Proxy", "User-assigned managed identity", "Service principal with secret", "App registration with certificate"], answer: 0, explanation: "Managed identity + Application Proxy enables secure on-premises access." },

                    { domain: 5, type: 'single', question: "Which report shows failed sign-ins due to Conditional Access policy blocks?", options: ["Sign-in logs ‚Äì Conditional Access tab", "Audit logs ‚Äì Policy", "Risky sign-ins report", "Identity Protection ‚Äì Detections"], answer: 0, explanation: "The Conditional Access tab in sign-in logs shows the exact policy and failure reason." },

                    { domain: 2, type: 'single', question: "You need to enforce number matching in Microsoft Authenticator for all users accessing finance apps. Where do you configure this?", options: ["Authentication methods policy ‚Äì Microsoft Authenticator settings", "Conditional Access ‚Äì Grant ‚Äì Require MFA", "Authentication strength policy", "Security defaults"], answer: 0, explanation: "Number matching is configured in the authentication methods policy for Authenticator." },

                    { domain: 4, type: 'single', question: "To delegate the ability to approve access packages for a specific catalog to a business unit, what should you use?", options: ["Catalog owners or approvers assignment", "Administrative units", "PIM role delegation", "Conditional Access authentication context"], answer: 0, explanation: "Entitlement management catalogs support scoped owners and approvers." },
                            // SC-300 new questions ‚Äì January 2026 batch ‚Äì focus on current features

                    { domain: 2, type: 'single', question: "You must enforce certificate-based authentication (CBA) for all users accessing Power BI from corporate devices. Which policy type should you use?", options: ["Conditional Access policy with authentication strength 'Certificate-based authentication'", "Authentication methods policy enabling CBA globally", "Authentication strength policy targeting Power BI apps", "Security defaults with enhanced MFA"], answer: 2, explanation: "Authentication strength policies allow you to require specific phishing-resistant methods like CBA for selected cloud apps." },

                    { domain: 2, type: 'single', question: "A Conditional Access policy requires hybrid Azure AD joined devices for all users. A user is blocked despite having a compliant hybrid-joined device. What should you check first?", options: ["Device registration state in Entra ID and Intune compliance", "The user is in an excluded group", "Password hash sync is disabled", "Seamless SSO is not configured"], answer: 0, explanation: "Hybrid join must be visible in Entra ID, and the device must be compliant in Intune for the grant to succeed." },

                    { domain: 4, type: 'single', question: "You need to automatically add new external users to a review group after 180 days. What is the most efficient governance feature?", options: ["Access review with recurring scope on dynamic guest group", "Entitlement management access package with expiration", "Lifecycle workflow with 'Guest expiration' trigger", "PIM eligible assignment with max duration"], answer: 0, explanation: "Access reviews can run on dynamic groups and auto-apply removal or move to a review group." },

                    { domain: 1, type: 'single', question: "After configuring cross-tenant synchronization, users from the source tenant appear in the target tenant but have no licenses. What step was likely missed?", options: ["Assign licenses via entitlement management or group-based licensing in the target tenant", "Enable password hash sync in source tenant", "Configure inbound trust settings", "Create a Conditional Access policy"], answer: 0, explanation: "Synchronization provisions identities; licenses must be assigned separately in the target tenant." },

                    { domain: 3, type: 'single', question: "A GitHub Actions workflow needs to authenticate to Azure using Entra ID without secrets. What is the recommended setup?", options: ["Workload identity federation with OpenID Connect (OIDC)", "Managed identity in Azure", "Service principal with client secret", "App registration with certificate"], answer: 0, explanation: "Workload identity federation allows external IdPs like GitHub to use OIDC tokens without secrets." },

                    { domain: 5, type: 'single', question: "You notice several users have permanent Global Administrator assignments in PIM. Which report helps identify them quickly?", options: ["PIM ‚Üí Audit ‚Üí Permanent role assignments", "Entra ID ‚Üí Roles and administrators ‚Üí All assignments", "Identity Secure Score recommendations", "Audit logs filtered by role"], answer: 2, explanation: "Identity Secure Score explicitly flags standing privileged access and recommends conversion to eligible." },

                    { domain: 2, type: 'multi', question: "Select all that apply: Which signals can be used in Conditional Access policies to require phishing-resistant MFA?", options: ["Device platform", "User risk level", "Sign-in risk level", "Location (named locations)", "Authentication strength condition"], answer: [0,1,2,3], explanation: "All listed signals can be combined with an authentication strength grant requirement." },

                    { domain: 4, type: 'single', question: "Managers should be able to request access packages for their team without approval. How do you configure this?", options: ["Access package policy ‚Üí Self-service request with no approval required", "Multi-stage approval with manager as first stage", "Require justification only", "Use PIM self-activation"], answer: 0, explanation: "Access package policies allow self-service with optional approval; set to none for direct assignment." },

                    { domain: 1, type: 'single', question: "Your organization uses Entra Cloud Sync. Which on-premises object type is supported for provisioning to Entra ID?", options: ["Users and groups", "Computers and devices", "Contacts only", "Organizational units"], answer: 0, explanation: "Cloud Sync supports user and group provisioning (no device/computer support yet)." },

                    { domain: 3, type: 'single', question: "An Azure Container App needs to access Microsoft Graph with application permissions using managed identity. What is required?", options: ["System-assigned managed identity + Graph application permissions", "User-assigned managed identity + federated credential", "App registration with client secret", "Service principal with certificate"], answer: 0, explanation: "System-assigned identity is the simplest for container apps with Graph app permissions." },

                    { domain: 5, type: 'single', question: "A user reports being prompted for MFA unexpectedly. The policy is in report-only mode. Where do you see the simulated block?", options: ["Sign-in logs ‚Üí Conditional Access ‚Üí What If tab", "Audit logs ‚Üí Policy changes", "Identity Protection ‚Üí Risky sign-ins", "Entra admin center ‚Üí Conditional Access insights"], answer: 0, explanation: "The What If tool and sign-in logs in report-only mode show what would have happened." },

                    { domain: 2, type: 'single', question: "You need to block access from TOR exit nodes while allowing admins from those locations. What condition + exception works best?", options: ["Location condition ‚Üí Exclude named locations (admin IPs) + Block", "User risk condition", "Device platform filter", "Authentication strength exception"], answer: 0, explanation: "Named locations can exclude specific IPs; TOR nodes can be added as a blocked location." },

                    { domain: 4, type: 'single', question: "You want to automatically remove access packages when a user leaves the organization. What feature integrates best?", options: ["Lifecycle workflows ‚Äì Leaver process + access package removal action", "Access reviews with dynamic scope", "PIM role expiration", "Conditional Access block on last sign-in"], answer: 0, explanation: "Lifecycle workflows support leaver automation including access package revocation." },

                    { domain: 1, type: 'single', question: "What is required to enable B2B collaboration with a partner tenant using cross-tenant synchronization instead of guest accounts?", options: ["Inbound and outbound trust + synchronization configuration", "SAML federation", "Guest invite settings only", "Entitlement management catalog"], answer: 0, explanation: "Cross-tenant sync creates member-like identities with full trust setup." },

                    { domain: 3, type: 'multi', question: "Select all that apply: Which identity types support workload identity federation?", options: ["OIDC providers (GitHub, GitLab, etc.)", "Kubernetes service accounts", "Azure Arc-enabled servers", "On-premises AD service accounts", "AWS IAM roles"], answer: [0,1], explanation: "Federation is supported for OIDC-based providers and Kubernetes workloads." },

                    { domain: 5, type: 'single', question: "To track who approved a PIM role activation, which log filter should you use?", options: ["PIM audit logs ‚Üí Activation requests ‚Üí Approver column", "Sign-in logs ‚Üí Conditional Access", "Audit logs ‚Üí Role assignment", "Identity Protection ‚Üí Risk detections"], answer: 0, explanation: "PIM-specific audit logs show approver, justification, and duration." },

                    { domain: 2, type: 'single', question: "You need to require compliant devices for Exchange Online but allow browser access from unmanaged devices with session controls. What helps?", options: ["Authentication context + session controls (sign-in frequency, persistent browser session)", "Device condition exclusion", "Named locations only", "User risk policy"], answer: 0, explanation: "Authentication contexts allow different grant/session requirements per app." },

                    { domain: 4, type: 'single', question: "An access package is expiring in 30 days. How can a user extend access before expiration?", options: ["Request renewal in My Access portal if policy allows", "Manager approval workflow", "PIM activation", "Lifecycle workflow trigger"], answer: 0, explanation: "Access packages support renewal requests if the policy enables it." },

                    { domain: 1, type: 'single', question: "What Entra Connect feature must be enabled for password changes made in the cloud to write back to on-premises AD?", options: ["Password writeback", "Pass-through authentication", "Group writeback", "Device writeback"], answer: 0, explanation: "Password writeback synchronizes cloud password resets back to on-premises." },

                    { domain: 3, type: 'single', question: "A Logic App uses managed identity to call an on-premises SQL Server via Application Proxy. What identity type is best?", options: ["System-assigned managed identity", "User-assigned managed identity", "Service principal with secret", "App registration with federated credential"], answer: 0, explanation: "System-assigned is automatic and lifecycle-managed with the Logic App." },

                    { domain: 5, type: 'single', question: "Which blade shows why a Conditional Access policy blocked a sign-in with the exact failure reason code?", options: ["Sign-in logs ‚Üí Conditional Access tab", "Audit logs ‚Üí Policy", "Risky sign-ins", "Entra ID reports"], answer: 0, explanation: "The CA tab details grant/block results and failure codes." },

                    { domain: 2, type: 'single', question: "You want to require number matching in Authenticator push notifications for all admins. Where is this configured?", options: ["Authentication methods policy ‚Üí Microsoft Authenticator ‚Üí Number matching", "Conditional Access grant controls", "Authentication strength policy", "Security defaults"], answer: 0, explanation: "Number matching is a tenant-wide setting in authentication methods." },

                    { domain: 4, type: 'single', question: "To delegate management of a specific entitlement management catalog to a department, what should you assign?", options: ["Catalog owner role in entitlement management", "Administrative unit scoped role", "PIM eligible catalog role", "Global reader role"], answer: 0, explanation: "Catalog owners can manage packages within their catalog only." },

                    { domain: 1, type: 'single', question: "What setting blocks guest invitations from all users except members of a specific security group?", options: ["External collaboration settings ‚Üí Guest invite restrictions", "Cross-tenant access settings", "Conditional Access policy", "Entitlement management policies"], answer: 0, explanation: "Guest invite restrictions allow scoping to specific groups." },

                    { domain: 3, type: 'single', question: "An Azure VM needs to authenticate to Azure Storage using managed identity without secrets. What is required?", options: ["System-assigned managed identity + Storage Blob Data Contributor role", "User-assigned managed identity", "App registration with secret", "Service principal"], answer: 0, explanation: "System-assigned identity + RBAC role is the standard secretless pattern." },

                    { domain: 5, type: 'single', question: "To export all Conditional Access policy configurations for backup, what is the easiest method?", options: ["Microsoft Graph API or PowerShell export", "Entra admin center download", "Audit logs export", "Identity Secure Score report"], answer: 0, explanation: "Graph API / PowerShell provides full policy JSON export." },

                    { domain: 2, type: 'single', question: "A policy requires MFA for medium sign-in risk. A user with low risk is still prompted. Why?", options: ["Another policy applies MFA unconditionally", "Risk policy is separate from CA", "Authentication strength overrides", "User is in a high-risk group"], answer: 0, explanation: "Multiple policies can apply; the strictest grant wins." },

                    { domain: 4, type: 'single', question: "You need to review access to all enterprise applications every 6 months. What is the most scalable approach?", options: ["Access reviews scoped to 'All enterprise applications'", "PIM access reviews", "Entitlement management catalog reviews", "Conditional Access policy audit"], answer: 0, explanation: "Access reviews can target all enterprise apps for broad governance." },
                            // SC-300 additional questions ‚Äì February 2026 batch ‚Äì mixed topics

                    { domain: 2, type: 'single', question: "You need to require FIDO2 security keys for all users accessing Azure portal from unknown locations. Which is the most efficient configuration?", options: ["Conditional Access policy + authentication strength 'Phishing-resistant MFA' + location condition 'Any location'", "Authentication methods policy enabling FIDO2 globally", "Per-user MFA registration policy", "Security defaults"], answer: 0, explanation: "Authentication strength combined with location condition targets phishing-resistant methods precisely." },

                    { domain: 2, type: 'single', question: "A Conditional Access policy requires device compliance for all cloud apps. A user with a compliant Intune device is still blocked. What is the likely cause?", options: ["Device is not marked compliant in Intune", "Policy is set to 'Report-only'", "User is in an excluded group", "Password hash sync is disabled"], answer: 0, explanation: "Compliance requires Intune enrollment and successful compliance check; non-compliant devices are blocked." },

                    { domain: 4, type: 'single', question: "You want to automatically assign users to a department-specific access package upon joining the organization. What is the best integration?", options: ["Lifecycle workflows + dynamic group membership + access package auto-assignment", "Entra Connect group writeback", "PIM automatic role assignment", "Conditional Access user targeting"], answer: 0, explanation: "Lifecycle workflows can trigger access package assignment based on joiner events and attributes." },

                    { domain: 1, type: 'single', question: "After migrating to Entra Cloud Sync, you notice group memberships are not synchronizing to Entra ID. What is required?", options: ["Enable group writeback in Cloud Sync settings", "Use Entra Connect Sync instead", "Create dynamic groups only", "Enable pass-through authentication"], answer: 0, explanation: "Group writeback must be explicitly enabled in Cloud Sync configuration." },

                    { domain: 3, type: 'single', question: "An Azure Function in a consumption plan needs to read secrets from Key Vault using identity without credentials. What is the recommended setup?", options: ["System-assigned managed identity + Key Vault access policy", "User-assigned managed identity", "App registration with client secret", "Service principal with certificate"], answer: 0, explanation: "System-assigned managed identity is automatic and lifecycle-managed for Azure Functions." },

                    { domain: 5, type: 'single', question: "You need to find out why a Conditional Access policy was bypassed for a specific sign-in. Which log view provides the most detail?", options: ["Sign-in logs ‚Üí Conditional Access ‚Üí Failure reason and applied policies", "Audit logs ‚Üí Policy changes", "Risky sign-ins report", "Entra ID activity logs"], answer: 0, explanation: "The Conditional Access tab in sign-in logs shows exactly which policies were evaluated and why they did/did not apply." },

                    { domain: 2, type: 'multi', question: "Select all that apply: Which conditions can trigger an authentication strength requirement in Conditional Access?", options: ["User risk", "Sign-in risk", "Device platforms", "Locations", "Client apps"], answer: [0,1,2,3,4], explanation: "Authentication strength can be required based on any standard CA condition." },

                    { domain: 4, type: 'single', question: "You need to allow users to request access to an application via My Access portal without manager approval. How do you configure?", options: ["Access package policy ‚Üí Self-service request enabled + no approval", "Entitlement management catalog owner delegation", "PIM self-activation", "Conditional Access authentication context"], answer: 0, explanation: "Self-service access packages can be set to no approval for direct request." },

                    { domain: 1, type: 'single', question: "What is the primary benefit of using cross-tenant synchronization over traditional B2B guest invitations?", options: ["Users appear as members (not guests) with better integration", "No licenses required", "Automatic password sync", "Seamless SSO without configuration"], answer: 0, explanation: "Cross-tenant sync provisions member-like identities for improved collaboration." },

                    { domain: 3, type: 'single', question: "A GitLab CI/CD pipeline needs to deploy to Azure using Entra ID authentication without secrets. What should you configure?", options: ["Workload identity federation with GitLab OIDC provider", "Managed identity in Azure", "Service principal with secret rotation", "App registration with certificate"], answer: 0, explanation: "Federation with OIDC eliminates secrets for external CI/CD tools." },

                    { domain: 5, type: 'single', question: "Which Microsoft Entra report helps identify users who have not signed in for 90+ days?", options: ["Inactive users report", "Sign-in logs filtered by date", "Risky users report", "Identity Secure Score"], answer: 0, explanation: "The inactive users report shows stale accounts for cleanup or access review scoping." },

                    { domain: 2, type: 'single', question: "You need to enforce Microsoft Authenticator push with number matching for all admins. Where is this setting located?", options: ["Authentication methods policy ‚Üí Microsoft Authenticator ‚Üí Enable number matching", "Conditional Access grant controls", "Authentication strength policy", "Security defaults"], answer: 0, explanation: "Number matching is a configurable setting in the Authenticator method policy." },

                    { domain: 4, type: 'single', question: "To automatically remove access for users who change departments, what dynamic approach works best?", options: ["Dynamic groups + access reviews or lifecycle workflows", "Manual access package removal", "PIM role expiration", "Conditional Access block"], answer: 0, explanation: "Dynamic groups update membership automatically; workflows or reviews handle access changes." },

                    { domain: 1, type: 'single', question: "What must be configured in the source tenant for cross-tenant synchronization to provision users as members in the target tenant?", options: ["Outbound trust + synchronization job", "Inbound trust in target tenant", "Guest invite settings", "SAML federation"], answer: 0, explanation: "Outbound configuration in source + inbound trust in target are both required." },

                    { domain: 3, type: 'single', question: "An Azure Batch job needs to authenticate to Storage using identity without keys. What is required?", options: ["System-assigned managed identity + Storage Blob Data Contributor RBAC role", "User-assigned managed identity", "Shared access signature (SAS)", "Account key"], answer: 0, explanation: "Managed identity + RBAC is the secure, keyless method." },

                    { domain: 5, type: 'single', question: "To monitor all role assignment changes in Entra ID, which log type should be exported to a SIEM?", options: ["Audit logs ‚Äì Directory role category", "Sign-in logs", "Provisioning logs", "Risk detections"], answer: 0, explanation: "Directory role events in audit logs capture add/remove assignments." },

                    { domain: 2, type: 'single', question: "A policy blocks access for high sign-in risk. A user is blocked even though risk is low. What is the cause?", options: ["Another policy applies the block unconditionally", "Risk policy is separate", "User risk policy overrides", "Device condition conflict"], answer: 0, explanation: "Multiple policies are evaluated; the most restrictive grant/block wins." },

                    { domain: 4, type: 'single', question: "You need to allow self-service access package requests with manager approval for contractors only. What scoping is required?", options: ["Access package policy with user scope 'Contractors' group + manager approval", "Entitlement management connected organizations", "PIM eligible assignment", "Conditional Access targeting"], answer: 0, explanation: "Policies support group-based scoping and manager approval workflows." },

                    { domain: 1, type: 'single', question: "What Entra Connect health alert would indicate synchronization errors due to duplicate attributes?", options: ["Duplicate attribute sync error", "Export errors", "Password hash sync failure", "Seamless SSO failure"], answer: 0, explanation: "Duplicate attributes (e.g., proxyAddresses) cause sync failures and health alerts." },

                    { domain: 3, type: 'multi', question: "Select all that apply: Which are valid authentication methods for workload identities without secrets?", options: ["Managed identity (system-assigned)", "Workload identity federation (OIDC)", "Certificate-based authentication", "Client secret rotation", "Shared access signature"], answer: [0,1,2], explanation: "Managed identities and federation eliminate long-term secrets." },

                    { domain: 5, type: 'single', question: "Which tool provides recommendations to improve your tenant's identity security posture score?", options: ["Identity Secure Score in Microsoft Entra admin center", "Microsoft Secure Score", "Entra Connect Health", "Azure AD reports"], answer: 0, explanation: "Identity Secure Score gives identity-specific improvement actions." },

                    { domain: 2, type: 'single', question: "You need to limit session lifetime to 1 hour for high-risk sign-ins. What feature achieves this?", options: ["Conditional Access session controls ‚Äì Sign-in frequency", "Authentication context", "Continuous access evaluation", "Token lifetime policy"], answer: 0, explanation: "Sign-in frequency in session controls enforces re-authentication intervals." },

                    { domain: 4, type: 'single', question: "To delegate the management of access reviews for a specific group to a team lead, what should you use?", options: ["Access review scoped to the group + reviewer assignment", "Administrative units", "PIM scoped roles", "Entitlement management catalog"], answer: 0, explanation: "Access reviews allow assigning specific reviewers per review scope." },

                    { domain: 1, type: 'single', question: "What is the recommended method to decommission Entra Connect after full cloud migration?", options: ["Hard-match objects and uninstall Entra Connect", "Enable cloud provisioning agent", "Keep sync running indefinitely", "Disable password hash sync"], answer: 0, explanation: "Hard-match + uninstall cleans up after successful cloud-only transition." },

                    { domain: 3, type: 'single', question: "A web app needs to call an on-premises API using Entra ID authentication via Application Proxy. What identity type is best?", options: ["System-assigned managed identity", "User-assigned managed identity", "Service principal with secret", "App registration with federated credential"], answer: 0, explanation: "Managed identity + App Proxy provides secure, credential-less on-premises access." },

                    { domain: 5, type: 'single', question: "To audit who changed a Conditional Access policy, filter audit logs by which activity name?", options: ["Update conditional access policy", "Sign-in activity", "Role assignment", "Risk policy update"], answer: 0, explanation: "Audit logs capture policy updates with the actor and changes." },

                    { domain: 2, type: 'single', question: "You need to require MFA only for sign-ins from non-corporate countries. What is the best condition?", options: ["Locations condition ‚Üí Include 'Any location' exclude trusted named locations", "Device platforms", "User risk", "Client apps"], answer: 0, explanation: "Named locations allow exclusion of corporate IPs/countries." },

                    { domain: 4, type: 'single', question: "What allows users to request access to SharePoint sites via self-service without IT involvement?", options: ["Entitlement management access package with SharePoint resource", "Access reviews on sites", "PIM resource roles", "Conditional Access"], answer: 0, explanation: "Access packages can include SharePoint sites for self-service requests." },

                    { domain: 1, type: 'single', question: "What Entra ID feature enables passwordless sign-in using Windows Hello for Business in a hybrid environment?", options: ["Enable Windows Hello for Business in Entra Connect", "Seamless SSO", "Pass-through authentication", "Certificate-based authentication"], answer: 0, explanation: "WHfB requires hybrid join and Entra ID configuration for cloud trust." },
                            // SC-300 fresh questions ‚Äì February 2026 batch #2 ‚Äì advanced scenarios & current features

                    { domain: 2, type: 'single', question: "You need to enforce phishing-resistant MFA for all sign-ins from personal devices but allow standard MFA from corporate devices. What is the most precise way?", options: ["Authentication strength policy + device filter 'exclude hybrid joined'", "Conditional Access with two policies (one for phishing-resistant, one for standard)", "Authentication methods policy globally", "Security defaults"], answer: 0, explanation: "Authentication strength can be targeted with device filters to require stronger methods only on unmanaged devices." },

                    { domain: 2, type: 'single', question: "A Conditional Access policy requires MFA for medium sign-in risk. The user is blocked even though risk is low. What explains this?", options: ["Another policy applies MFA unconditionally", "Risk policy is not in effect", "Device compliance overrides risk", "Authentication strength is set to phishing-resistant"], answer: 0, explanation: "Multiple policies are evaluated cumulatively; the strictest requirement applies." },

                    { domain: 4, type: 'single', question: "You need to automatically provision access to a SharePoint site for new hires in the Sales department. What combination works best?", options: ["Dynamic group for Sales + lifecycle workflow + access package auto-assignment", "Manual access package request", "PIM resource role", "Conditional Access targeting"], answer: 0, explanation: "Dynamic groups + lifecycle workflows automate joiner access package provisioning." },

                    { domain: 1, type: 'single', question: "After enabling Entra Cloud Sync, on-premises group changes are not reflecting in Entra ID. What was likely missed?", options: ["Group scoping filters in Cloud Sync configuration", "Password writeback enablement", "Pass-through authentication", "Device registration"], answer: 0, explanation: "Cloud Sync requires explicit group scoping and writeback enablement for membership sync." },

                    { domain: 3, type: 'single', question: "An Azure Data Factory pipeline needs to authenticate to Blob Storage using identity without keys. What is required?", options: ["System-assigned managed identity + Storage Blob Data Reader RBAC role", "User-assigned managed identity", "Shared access signature", "Account key rotation"], answer: 0, explanation: "Managed identity + RBAC is the secure, credential-less pattern for ADF." },

                    { domain: 5, type: 'single', question: "You need to determine why a user was granted temporary access to a role via PIM. Where do you find the activation details?", options: ["PIM audit logs ‚Äì Activation requests", "Sign-in logs ‚Äì Conditional Access", "Audit logs ‚Äì Role management", "Risk detections"], answer: 0, explanation: "PIM activation requests log approver, justification, duration, and ticket info." },

                    { domain: 2, type: 'multi', question: "Select all that apply: Which authentication methods qualify as phishing-resistant for authentication strength policies?", options: ["FIDO2 security key", "Certificate-based authentication", "Windows Hello for Business", "Microsoft Authenticator passwordless", "Temporary Access Pass"], answer: [0,1,2], explanation: "FIDO2, CBA, and WHfB are fully phishing-resistant; Authenticator passwordless is strong but not classified as resistant." },

                    { domain: 4, type: 'single', question: "You want users to request access to multiple resources in one package with expiration after 90 days. What feature supports this?", options: ["Entitlement management access package bundling resources", "Access reviews on groups", "PIM eligible assignments", "Lifecycle workflows"], answer: 0, explanation: "Access packages can bundle groups, apps, and sites with policy-controlled expiration." },

                    { domain: 1, type: 'single', question: "What is required in the target tenant for cross-tenant synchronization to allow inbound user provisioning as members?", options: ["Inbound trust enabled + synchronization allowed", "Guest invite settings set to allow", "Conditional Access policy", "SAML/WS-Fed federation"], answer: 0, explanation: "Inbound trust in cross-tenant settings is mandatory for accepting synced identities." },

                    { domain: 3, type: 'single', question: "A GitHub repository Actions workflow needs to deploy Azure resources using Entra ID. How do you avoid secrets?", options: ["Workload identity federation with GitHub OIDC", "Managed identity in Azure", "Service principal secret", "App registration certificate"], answer: 0, explanation: "OIDC federation from GitHub Actions to Entra ID eliminates secret management." },

                    { domain: 5, type: 'single', question: "Which Entra ID report helps identify risky users who may need password reset or access revocation?", options: ["Risky users report in Identity Protection", "Inactive users report", "Sign-in logs filtered by risk", "Audit logs"], answer: 0, explanation: "Risky users report shows risk level, detections, and remediation history." },

                    { domain: 2, type: 'single', question: "You need to block access from legacy authentication protocols for Exchange Online only. What is the targeted method?", options: ["Conditional Access policy targeting Exchange Online + block legacy auth", "Authentication methods policy disable basic auth", "Security defaults", "Per-user legacy block"], answer: 0, explanation: "Conditional Access can block legacy auth for specific cloud apps." },

                    { domain: 4, type: 'single', question: "To allow contractors to request temporary access to a Teams channel via self-service, what resource can be included in an access package?", options: ["Microsoft 365 group backing the Team", "Enterprise application", "SharePoint site only", "Azure role"], answer: 0, explanation: "Access packages support Microsoft 365 groups, which include Teams channels." },

                    { domain: 1, type: 'single', question: "What Entra Connect feature enables hybrid join for devices to support Conditional Access device compliance?", options: ["Device writeback", "Password hash sync", "Group writeback", "Seamless SSO"], answer: 0, explanation: "Device writeback synchronizes hybrid join status to Entra ID." },

                    { domain: 3, type: 'single', question: "An Azure Logic App needs to call Microsoft Graph to update user attributes. What identity type provides the least management overhead?", options: ["System-assigned managed identity + Graph application permissions", "User-assigned managed identity", "App registration with secret", "Service principal"], answer: 0, explanation: "System-assigned identity is automatic and deleted with the Logic App." },

                    { domain: 5, type: 'single', question: "To export all access review decisions for compliance reporting, which export option is available?", options: ["Access reviews ‚Üí Export decisions CSV", "Audit logs export", "Sign-in logs", "Identity Secure Score"], answer: 0, explanation: "Access reviews blade allows direct CSV export of reviewer decisions." },

                    { domain: 2, type: 'single', question: "A policy requires session controls for high-risk sign-ins (e.g., sign-in frequency 30 minutes). What happens on low-risk sign-ins?", options: ["Session controls do not apply", "MFA is still required", "Access is blocked", "Persistent browser session enforced"], answer: 0, explanation: "Session controls only apply when the policy conditions are met." },

                    { domain: 4, type: 'single', question: "You need to review guest user access to all enterprise applications every quarter. What scoping works best?", options: ["Access reviews on 'All enterprise applications' with guest user scope", "PIM resource reviews", "Entitlement management catalog", "Conditional Access audit"], answer: 0, explanation: "Access reviews support scoping to enterprise applications and guest users." },

                    { domain: 1, type: 'single', question: "What must be enabled in Entra Connect for on-premises group changes to sync to Entra ID cloud groups?", options: ["Group writeback", "Password writeback", "Device writeback", "Pass-through authentication"], answer: 0, explanation: "Group writeback synchronizes cloud group membership changes back to on-premises." },

                    { domain: 3, type: 'multi', question: "Select all that apply: Which workload identity authentication methods avoid long-term secrets?", options: ["System-assigned managed identity", "User-assigned managed identity", "Workload identity federation (OIDC)", "Certificate-based authentication", "Client secret"], answer: [0,1,2,3], explanation: "All except client secret eliminate or minimize secret management." },

                    { domain: 5, type: 'single', question: "Which Microsoft Entra feature provides actionable recommendations to reduce privileged standing access?", options: ["Identity Secure Score", "Microsoft Secure Score", "Entra Connect Health alerts", "Risky users report"], answer: 0, explanation: "Identity Secure Score specifically targets identity risks like permanent roles." },

                    { domain: 2, type: 'single', question: "You need to require re-authentication every 4 hours for sensitive apps. What session control setting achieves this?", options: ["Sign-in frequency = 4 hours", "Persistent browser session disabled", "Continuous access evaluation", "Token lifetime policy"], answer: 0, explanation: "Sign-in frequency forces re-authentication at the set interval." },

                    { domain: 4, type: 'single', question: "To delegate the ability to create access packages for a business unit, what should you assign?", options: ["Catalog owner role in entitlement management", "Global administrator", "PIM eligible role", "Administrative unit scoped role"], answer: 0, explanation: "Catalog owners can create and manage packages within their assigned catalog." },

                    { domain: 1, type: 'single', question: "What setting prevents users from inviting guests from unverified domains?", options: ["External collaboration settings ‚Üí Guest invite restrictions", "Cross-tenant access settings", "Conditional Access named locations", "Entitlement management policies"], answer: 0, explanation: "Guest invite restrictions can limit to verified domains or specific groups." },

                    { domain: 3, type: 'single', question: "An Azure Web App needs to authenticate to an on-premises LDAP server using Entra ID credentials. What enables this?", options: ["Entra Application Proxy + managed identity", "Pass-through authentication", "Seamless SSO", "Certificate-based authentication"], answer: 0, explanation: "App Proxy publishes on-premises LDAP securely; managed identity handles authentication." },

                    { domain: 5, type: 'single', question: "To investigate a suspicious role activation in PIM, filter audit logs by which activity?", options: ["Activate role", "Sign-in activity", "Add member to role", "Risk detection"], answer: 0, explanation: "Activate role activity shows PIM-specific activation events." },

                    { domain: 2, type: 'single', question: "You need to enforce MFA for all users except service accounts using legacy protocols. How do you exempt them?", options: ["Conditional Access exclude service principal identities", "Authentication methods policy", "Per-user MFA registration", "Security defaults"], answer: 0, explanation: "Conditional Access can exclude specific service principals." },

                    { domain: 4, type: 'single', question: "What allows automatic removal of inactive external users after 120 days?", options: ["Access review on dynamic guest group with auto-remove policy", "Entitlement management expiration", "Lifecycle workflow inactive trigger", "Conditional Access block"], answer: 0, explanation: "Access reviews on dynamic guest groups support auto-removal based on inactivity." },

                    { domain: 1, type: 'single', question: "What Entra ID feature supports passwordless sign-in for hybrid users using FIDO2 keys?", options: ["Enable FIDO2 in authentication methods policy + hybrid join", "Seamless SSO", "Pass-through authentication", "Certificate trust"], answer: 0, explanation: "FIDO2 requires hybrid join and authentication methods enablement." }
                    // Add more SC-300 questions here as needed (paste arrays from previous responses)
                ]
            },

            {
                id: 5,
                title: "AWS Certified Security ‚Äì Specialty Practice Exam (SCS-C03)",
                icon: "üõ°Ô∏è",
                difficulty: "advanced",
                description: "Realistic simulation of the current AWS Certified Security ‚Äì Specialty (SCS-C03) exam ‚Äì randomized questions covering detection, incident response, infrastructure security, IAM, data protection, governance, and generative AI / Bedrock security (live since Dec 2025)",
                timeLimitMinutes: 170, // Official SCS-C03 exam duration is 170 minutes (65 questions total, 50 scored)
                domainWeights: [0.16, 0.14, 0.18, 0.20, 0.18, 0.14],  // Domains 1‚Äì6
                questions: [
                    // Domain 1: Detection (~16%)
                    { domain: 1, type: 'single', question: "Which service provides automated detection of prompt injection attempts in applications using Amazon Bedrock?", options: ["Amazon GuardDuty", "Amazon Bedrock Guardrails", "AWS WAF", "Amazon Macie"], answer: 1, explanation: "Bedrock Guardrails include built-in prompt injection detection and content filtering." },
                    { domain: 1, type: 'single', question: "You want to detect unusual patterns in Amazon Bedrock model invocations across multiple accounts. Which service should you enable organization-wide?", options: ["Amazon GuardDuty with AI/ML protection", "AWS Security Hub", "Amazon Inspector", "Amazon Detective"], answer: 0, explanation: "GuardDuty expanded coverage includes anomalous Bedrock usage and AI-related threats." },
                    { domain: 1, type: 'multi', question: "Select TWO sources that Amazon Security Lake can ingest in OCSF format for centralized threat detection.", options: ["Amazon GuardDuty findings", "VPC Flow Logs", "AWS CloudTrail", "Amazon Inspector findings", "Amazon Macie alerts"], answer: [0,2], explanation: "Security Lake supports GuardDuty and CloudTrail in OCSF for standardized analysis." },

                    // Domain 2: Incident Response (~14%)
                    { domain: 2, type: 'single', question: "An application using Amazon Bedrock experiences a spike in token usage due to a potential DoS attack via crafted prompts. What is the MOST effective immediate mitigation?", options: ["Implement Bedrock Guardrails with rate limiting and max tokens per request", "Use AWS Shield Advanced", "Revoke model invocation permissions", "Enable CloudWatch alarms on token metrics"], answer: 0, explanation: "Bedrock Guardrails enforce hard limits on tokens and rate to prevent resource exhaustion." },
                    { domain: 2, type: 'single', question: "During incident response for a suspected compromised EC2 instance hosting a Bedrock agent, what should you do FIRST to preserve evidence?", options: ["Create a snapshot of the EBS volumes", "Isolate the instance via security group changes", "Terminate the instance", "Run forensics tools directly on the instance"], answer: 0, explanation: "Creating EBS snapshots preserves disk state for forensic analysis before any changes." },

                    // Domain 3: Infrastructure Security (~18%)
                    { domain: 3, type: 'single', question: "To protect a generative AI web application exposed via CloudFront from OWASP Top 10 for LLM threats, which AWS WAF rule group should you enable?", options: ["AWSManagedRulesCommonRuleSet", "AWSManagedRulesBotControlRuleSet", "AWSManagedRulesKnownBadInputsRuleSet", "Custom rules for prompt patterns"], answer: 0, explanation: "The CommonRuleSet covers OWASP Top 10 protections applicable at the edge." },
                    { domain: 3, type: 'single', question: "A workload requires private connectivity from on-premises to Amazon Bedrock without traversing the public internet. What is the BEST solution?", options: ["AWS Direct Connect + VPC interface endpoints for Bedrock", "AWS Site-to-Site VPN with public endpoints", "AWS Transit Gateway with NAT", "Public internet with TLS"], answer: 0, explanation: "Interface endpoints + Direct Connect provide fully private access to Bedrock." },

                    // Domain 4: Identity and Access Management (~20%)
                    { domain: 4, type: 'single', question: "You need to grant cross-account access to a specific Amazon Bedrock custom model without using long-term credentials. What is the recommended method?", options: ["Resource-based policy on the Bedrock model + IAM role AssumeRole", "IAM user access keys shared securely", "AWS Resource Access Manager", "IAM Identity Center"], answer: 0, explanation: "Bedrock supports resource policies allowing cross-account AssumeRole for secure access." },
                    { domain: 4, type: 'multi', question: "Select TWO controls to enforce least privilege for Bedrock model invocations.", options: ["Use IAM condition keys like aws:CalledVia", "Apply IAM Access Analyzer to review Bedrock permissions", "Enable Bedrock Guardrails deny lists", "Use SCPs to deny all Bedrock actions"], answer: [0,1], explanation: "Condition keys and Access Analyzer help scope permissions tightly." },

                    // Domain 5: Data Protection (~18%)
                    { domain: 5, type: 'single', question: "For fine-tuning Amazon Bedrock models with customer data, how do you ensure data remains protected at rest and in transit?", options: ["Use S3 with SSE-KMS + VPC endpoints for Bedrock", "Enable client-side encryption before upload", "Use Bedrock managed encryption only", "Both A and B"], answer: 3, explanation: "Combining client-side encryption with KMS-managed SSE provides strongest protection." },
                    { domain: 5, type: 'single', question: "You need to mask PII in CloudTrail logs before sending to a third-party SIEM. Which service supports automated masking?", options: ["Amazon Macie", "AWS Glue ETL with data masking", "Amazon OpenSearch ingest pipelines", "AWS KMS"], answer: 1, explanation: "Glue includes PII detection and masking transforms for log processing." },

                    // Domain 6: Security Foundations and Governance (~14%)
                    { domain: 6, type: 'single', question: "To enforce Bedrock model usage policies (e.g., deny certain models) across all accounts in an AWS Organization, what should you use?", options: ["Service Control Policies (SCPs)", "AWS Config conformance packs", "AWS Control Tower guardrails", "IAM permission boundaries"], answer: 0, explanation: "SCPs provide preventive controls for Bedrock actions organization-wide." },
                    { domain: 6, type: 'multi', question: "Select ALL that apply: Which tools help assess generative AI security posture?", options: ["AWS Well-Architected Framework ‚Äì AI Lens", "Amazon Bedrock Guardrails", "AWS Security Hub AI/ML findings", "AWS Config rules for Bedrock"], answer: [0,1,2,3], explanation: "These provide governance, monitoring, and best-practice evaluation for AI workloads." },

                    // Bonus / high-yield GenAI questions
                    { domain: 1, type: 'single', question: "Which OWASP Top 10 for LLM risk is BEST mitigated by Amazon Bedrock Guardrails content filters?", options: ["LLM01: Prompt Injection", "LLM02: Insecure Output Handling", "LLM06: Sensitive Information Disclosure", "LLM08: Excessive Agency"], answer: 2, explanation: "Guardrails include PII redaction and filters to prevent sensitive data leakage." },
                    { domain: 3, type: 'single', question: "What is the most effective way to protect against excessive agency (LLM08) in a Bedrock-powered application?", options: ["Implement Bedrock Guardrails with denied topics and action restrictions", "Use AWS WAF rate limiting", "Apply strict IAM policies only", "Enable multi-region KMS"], answer: 0, explanation: "Guardrails can restrict model actions and topics to limit unintended behavior." },








                    { domain: 1, type: 'single', question: "A company uses Amazon GuardDuty to monitor for threats. They want to detect anomalous API calls related to Amazon Bedrock model invocations. What GuardDuty feature or integration should be enabled?", options: ["GuardDuty Malware Protection for S3", "GuardDuty Expanded Threat Detection for AI/ML services", "Enable Amazon Bedrock-specific findings in GuardDuty", "Use GuardDuty Runtime Monitoring for EC2"], answer: 2, explanation: "GuardDuty includes expanded coverage for Bedrock model access anomalies and unusual invocation patterns in recent updates." },
                    { domain: 1, type: 'single', question: "You need to detect potential prompt injection attacks in generative AI applications using Amazon Bedrock. Which service provides built-in detection for this?", options: ["Amazon GuardDuty", "Amazon Macie", "Amazon Bedrock Guardrails", "AWS WAF"], answer: 2, explanation: "Bedrock Guardrails include content filters and prompt safeguards to detect and block malicious inputs like prompt injection." },
                    { domain: 1, type: 'multi', question: "Select TWO services that can ingest logs in Open Cybersecurity Schema Framework (OCSF) format for centralized threat detection in SCS-C03.", options: ["Amazon Security Lake", "Amazon OpenSearch Service", "AWS Security Hub", "Amazon Detective", "Amazon GuardDuty"], answer: [0,1], explanation: "Security Lake and OpenSearch support OCSF for standardized security data ingestion and analysis." },

                    // Domain 2: Incident Response (~14%)
                    { domain: 2, type: 'single', question: "During a security incident involving a compromised EC2 instance running a Bedrock agent, what is the FIRST recommended step in incident response?", options: ["Isolate the instance using security group changes via Lambda", "Capture memory and disk forensics", "Revoke all IAM permissions", "Terminate the instance immediately"], answer: 0, explanation: "Containment (isolation) is prioritized early while preserving evidence for analysis." },
                    { domain: 2, type: 'single', question: "A generative AI application experiences repeated high-cost invocations due to a potential denial-of-service attack. How can you mitigate this in incident response?", options: ["Implement Bedrock Guardrails with rate limiting", "Use AWS Shield Advanced for Layer 7 protection", "Set max tokens and queued actions limits in Bedrock", "Enable Amazon Inspector for runtime scanning"], answer: 2, explanation: "Bedrock enforces hard limits on queued actions and token usage to prevent resource exhaustion attacks." },
                    { domain: 2, type: 'multi', question: "Select ALL that apply: Which AWS services support automated playbooks for incident response in multi-account environments?", options: ["AWS Security Hub", "Amazon EventBridge", "AWS Systems Manager Automation", "AWS Lambda", "Amazon Detective"], answer: [0,1,2,3], explanation: "These integrate for automated detection-to-response workflows across Organizations." },

                    // Domain 3: Infrastructure Security (~18%)
                    { domain: 3, type: 'single', question: "To protect against OWASP Top 10 threats at the network edge for a web app using CloudFront, what should you implement?", options: ["AWS WAF managed rules for OWASP Top 10", "AWS Shield Advanced with proactive engagement", "CloudFront geo-restriction and signed URLs", "VPC Network Firewall with stateful rules"], answer: 0, explanation: "AWS WAF provides managed OWASP Top 10 rulesets for edge protection." },
                    { domain: 3, type: 'single', question: "A hybrid workload requires secure connectivity from on-premises to AWS while preventing direct internet access. What is the MOST secure option?", options: ["AWS Direct Connect with private VIF and VPC endpoints", "Site-to-Site VPN with NAT gateway", "AWS Transit Gateway with inspection appliances", "Public internet with client VPN"], answer: 0, explanation: "Direct Connect + private VIF + VPC endpoints ensure private, controlled hybrid connectivity." },

                    // Domain 4: Identity and Access Management (~20%)
                    { domain: 4, type: 'single', question: "You need to allow cross-account access to Amazon Bedrock models without sharing long-term credentials. What is the recommended approach?", options: ["IAM roles with AssumeRole and resource-based policies", "IAM user access keys shared via Secrets Manager", "AWS Resource Access Manager (RAM)", "IAM Identity Center permission sets"], answer: 0, explanation: "Resource-based policies on Bedrock allow secure cross-account AssumeRole." },
                    { domain: 4, type: 'multi', question: "Select TWO best practices for securing IAM roles used by generative AI workloads.", options: ["Use temporary credentials via instance metadata", "Apply least privilege with IAM Access Analyzer", "Enable MFA Delete on role policies", "Store access keys in environment variables"], answer: [0,1], explanation: "Temporary creds and Access Analyzer enforce least privilege for workloads." },

                    // Domain 5: Data Protection (~18%)
                    { domain: 5, type: 'single', question: "For Amazon Bedrock model customization with private data, how do you ensure data protection during fine-tuning?", options: ["Use Amazon S3 with SSE-KMS and private VPC endpoints", "Enable Bedrock data isolation in managed service", "Use client-side encryption before upload", "Both A and C"], answer: 3, explanation: "Client-side encryption + KMS-managed SSE provides end-to-end protection." },
                    { domain: 5, type: 'single', question: "A company requires data masking for PII in logs before sending to a third-party SIEM. What service supports this?", options: ["Amazon Macie with custom data identifiers", "AWS Glue with data masking transforms", "Amazon OpenSearch with ingest pipelines", "AWS KMS encryption policies"], answer: 1, explanation: "Glue ETL jobs include built-in data masking for sensitive data." },

                    // Domain 6: Security Foundations and Governance (~14%)
                    { domain: 6, type: 'single', question: "To enforce consistent security baselines across all AWS accounts, including Bedrock usage policies, what should you use?", options: ["AWS Control Tower guardrails", "AWS Organizations tag policies", "AWS Security Hub standards", "Service Control Policies (SCPs)"], answer: 0, explanation: "Control Tower provides preventive and detective guardrails for multi-account governance." },
                    { domain: 6, type: 'multi', question: "Select ALL that apply: Which tools help evaluate and improve security posture for generative AI workloads?", options: ["AWS Well-Architected Framework AI Lens", "Amazon Bedrock Guardrails", "AWS Config conformance packs", "AWS Security Hub"], answer: [0,1,2,3], explanation: "These assess and enforce best practices for AI/ML security." },

                    // Extra bonus questions (GenAI/LLM focus ‚Äì high-yield for SCS-C03)
                    { domain: 3, type: 'single', question: "To mitigate LLM01: Prompt Injection per OWASP Top 10 for LLM Applications in a Bedrock-powered app, what is the BEST control?", options: ["Implement Bedrock Guardrails with content filters and denied topics", "Use AWS WAF rate limiting", "Encrypt all prompts with KMS", "Apply least privilege IAM policies"], answer: 0, explanation: "Bedrock Guardrails block prompt injection and harmful content per OWASP mitigations." },
                    { domain: 5, type: 'single', question: "How do you address LLM02: Sensitive Information Disclosure in Bedrock applications?", options: ["Use Bedrock Guardrails PII redaction and filters", "Mask data client-side before invocation", "Enable CloudTrail logging only", "Use multi-region KMS keys"], answer: 0, explanation: "Guardrails redact PII and sensitive data in inputs/outputs." },
                    { domain: 1, type: 'single', question: "GuardDuty now includes detections for which emerging threat in AI workloads?", options: ["Unusual Bedrock model invocation patterns", "Malware in S3 training data", "EC2 crypto mining", "All of the above"], answer: 0, explanation: "Expanded GuardDuty covers AI/ML-specific anomalies like unauthorized Bedrock access." },
                    { domain: 6, type: 'single', question: "What is the recommended governance tool for enforcing Bedrock model access controls organization-wide?", options: ["AWS Organizations SCPs denying unauthorized Bedrock actions", "IAM Identity Center permission sets", "AWS Config rules for Bedrock", "Both A and C"], answer: 3, explanation: "SCPs prevent unauthorized use; Config monitors compliance." },
                    { domain: 3, type: 'single', question: "For edge protection against OWASP threats in GenAI apps exposed via CloudFront, what rule group should you enable?", options: ["AWSManagedRulesCommonRuleSet for OWASP Top 10", "AWSManagedRulesBotControlRuleSet", "AWSManagedRulesKnownBadInputsRuleSet", "Custom Bedrock-specific rules"], answer: 0, explanation: "CommonRuleSet covers OWASP Top 10 for web-exposed AI interfaces." },




                            // More SCS-C03 questions ‚Äì Detection & Incident Response focus
                    { domain: 1, type: 'single', question: "Amazon GuardDuty has expanded threat detection for which new category in SCS-C03?", options: ["Generative AI and machine learning workloads", "Container runtime threats only", "S3 malware scanning", "EC2 crypto mining"], answer: 0, explanation: "GuardDuty now includes specific detections for unusual Bedrock invocations and AI/ML anomalies." },
                    { domain: 1, type: 'single', question: "You receive a GuardDuty finding indicating potential data exfiltration via Bedrock model outputs. What is the first automated response you should configure?", options: ["EventBridge rule triggering Lambda to suspend model access", "Manual review in Amazon Detective", "Enable Bedrock audit logging only", "Increase CloudWatch metric alarms"], answer: 0, explanation: "EventBridge + Lambda enables automated containment by revoking temporary access or quarantining." },
                    { domain: 1, type: 'multi', question: "Select TWO ways to centralize detection findings including Bedrock-related events.", options: ["Amazon Security Hub", "Amazon Security Lake", "AWS Config Aggregators", "Amazon OpenSearch Service", "AWS CloudTrail Lake"], answer: [0,1], explanation: "Security Hub aggregates findings; Security Lake stores them in OCSF format for analysis." },

                    // Incident Response
                    { domain: 2, type: 'single', question: "For a suspected Bedrock prompt injection incident, what forensic artifact should you collect first?", options: ["CloudTrail logs of model invocation API calls", "EC2 instance memory dump", "S3 access logs only", "VPC Flow Logs"], answer: 0, explanation: "CloudTrail captures who invoked the model, what prompt was used, and response metadata." },
                    { domain: 2, type: 'single', question: "An attacker is using stolen credentials to invoke a Bedrock model repeatedly. Which control would have prevented initial access?", options: ["MFA on IAM users + short-lived session tokens", "Bedrock Guardrails rate limits", "AWS Shield Advanced", "Multi-region KMS keys"], answer: 0, explanation: "MFA and temporary credentials (via STS) are foundational to prevent credential abuse." },

                    // Infrastructure Security
                    { domain: 3, type: 'single', question: "To apply the latest managed AWS WAF rules for OWASP Top 10 to a CloudFront distribution fronting a Bedrock app, what should you do?", options: ["Associate the AWSManagedRulesCommonRuleSet web ACL", "Use AWSManagedRulesBotControlRuleSet", "Create custom regex rules for prompts", "Enable AWS Firewall Manager"], answer: 0, explanation: "The CommonRuleSet provides broad OWASP protection at the edge." },
                    { domain: 3, type: 'single', question: "What is the MOST secure way to allow Bedrock access from an EC2 instance in a private subnet?", options: ["VPC interface endpoint for Bedrock + security group rules", "NAT gateway + internet access", "AWS PrivateLink with public endpoints", "Direct internet route with TLS"], answer: 0, explanation: "Interface endpoints keep traffic within AWS network without public exposure." },

                    // Identity and Access Management
                    { domain: 4, type: 'single', question: "You need to allow a partner account to invoke your custom Bedrock model for 30 days only. What is the best approach?", options: ["Create a temporary IAM role with AssumeRole and time-bound policy", "Share long-term access keys", "Use Bedrock model sharing feature", "Add partner to your IAM group"], answer: 0, explanation: "Time-bound AssumeRole with resource policy is secure and temporary." },
                    { domain: 4, type: 'multi', question: "Select TWO condition keys to restrict Bedrock invocations to specific IP ranges or services.", options: ["aws:SourceIp", "aws:ViaAWSService", "aws:CalledVia", "aws:MultiFactorAuthPresent", "aws:PrincipalTag"], answer: [0,2], explanation: "SourceIp and CalledVia help enforce context-aware access." },

                    // Data Protection
                    { domain: 5, type: 'single', question: "For Bedrock fine-tuning jobs using private datasets, how do you enforce encryption with customer-managed keys?", options: ["Use KMS customer-managed keys (CMKs) with multi-region support", "Rely on AWS-managed keys", "Encrypt data client-side only", "Disable encryption for performance"], answer: 0, explanation: "CMKs give you control, auditing, and rotation; multi-region keys support cross-region replication." },
                    { domain: 5, type: 'single', question: "To prevent sensitive data leakage in Bedrock model outputs, what feature should be enabled?", options: ["Bedrock Guardrails with PII redaction and filters", "AWS KMS envelope encryption", "CloudTrail logging only", "S3 bucket encryption"], answer: 0, explanation: "Guardrails redact PII and block harmful/sensitive content in responses." },

                    // Security Foundations and Governance
                    { domain: 6, type: 'single', question: "Which AWS service provides conformance packs specifically tailored for generative AI workloads in SCS-C03?", options: ["AWS Config", "AWS Security Hub", "AWS Control Tower", "AWS Organizations"], answer: 0, explanation: "AWS Config offers AI/ML conformance packs to enforce Bedrock and related best practices." },
                    { domain: 6, type: 'single', question: "To centrally manage Bedrock deny lists across accounts, what is the recommended governance mechanism?", options: ["AWS Organizations SCPs denying specific Bedrock model IDs", "IAM Identity Center permission sets", "AWS Firewall Manager policies", "Bedrock service control policies"], answer: 0, explanation: "SCPs provide preventive guardrails at the organization level." },

                    // Additional GenAI / LLM security focus
                    { domain: 1, type: 'single', question: "Which OWASP LLM Top 10 risk is addressed by limiting the number of queued actions in Bedrock?", options: ["LLM04: Model Denial of Service", "LLM05: Supply Chain Vulnerabilities", "LLM07: Insecure Plugin Design", "LLM09: Overreliance"], answer: 0, explanation: "Rate/queue limits mitigate resource exhaustion attacks (DoS on model)." },
                    { domain: 3, type: 'single', question: "For a Bedrock application, what edge-level control helps mitigate LLM03: Training Data Poisoning when ingesting external data?", options: ["AWS WAF content filtering rules", "Amazon Macie sensitive data detection", "Bedrock Guardrails input validation", "S3 object tagging"], answer: 2, explanation: "Guardrails validate and filter inputs before they reach the model." },
                    { domain: 4, type: 'single', question: "What IAM best practice prevents over-privileged access to Bedrock customization jobs?", options: ["Use IAM Access Analyzer to generate least-privilege policies", "Grant full Bedrock:* permissions", "Use root user for jobs", "Store credentials in Lambda environment variables"], answer: 0, explanation: "Access Analyzer identifies and recommends minimal permissions." },
                    { domain: 5, type: 'single', question: "How do you ensure Bedrock custom model weights remain encrypted at rest with your own keys?", options: ["Enable customer-managed KMS keys during model import/customization", "Use default AWS-managed keys", "Store weights in S3 without encryption", "Encrypt after model creation"], answer: 0, explanation: "KMS CMKs are required for customer control over model data encryption." },
                    { domain: 6, type: 'multi', question: "Select TWO ways to monitor Bedrock usage for governance and cost control.", options: ["CloudWatch metrics for invocation count and latency", "AWS Cost Explorer with Bedrock tags", "AWS Budgets with alerts", "Amazon Detective graph analysis"], answer: [0,1], explanation: "Metrics and tagged cost allocation help enforce usage policies." },




                            // Additional SCS-C03 questions ‚Äì strong focus on GenAI / Bedrock / OWASP LLM

                    { domain: 1, type: 'single', question: "Which Amazon GuardDuty feature helps detect unauthorized access or anomalous behavior when using Amazon Bedrock agents?", options: ["Runtime Monitoring for Bedrock", "Malware Protection for S3", "EKS Protection", "Expanded findings for AI services"], answer: 0, explanation: "GuardDuty Runtime Monitoring now covers Bedrock agents for runtime threats and anomalous invocations." },

                    { domain: 1, type: 'single', question: "A Bedrock-powered chatbot is receiving crafted prompts that cause harmful outputs. Which detection service would flag this as a potential attack?", options: ["Amazon Bedrock Guardrails content moderation", "Amazon GuardDuty Malware Protection", "AWS WAF SQL injection rules", "Amazon Macie sensitive data detection"], answer: 0, explanation: "Bedrock Guardrails actively detect and block prompt-based attacks like jailbreaking or injection." },

                    { domain: 2, type: 'single', question: "After detecting a high-severity GuardDuty finding on Bedrock usage, what is the recommended containment action?", options: ["Temporarily disable model access via IAM policy update via Lambda", "Delete the model immediately", "Ignore if low volume", "Reboot the associated EC2 instance"], answer: 0, explanation: "Automated IAM policy updates via EventBridge + Lambda are a fast, reversible containment step." },

                    { domain: 2, type: 'multi', question: "Select TWO steps that should be part of post-incident analysis for a Bedrock-related security event.", options: ["Review CloudTrail logs for invocation details", "Analyze Bedrock invocation metrics in CloudWatch", "Capture EBS snapshots of related instances", "Immediately delete all logs for privacy"], answer: [0,1], explanation: "CloudTrail and CloudWatch provide audit trail and performance context for root cause analysis." },

                    { domain: 3, type: 'single', question: "What is the most effective way to prevent direct public exposure of a Bedrock inference endpoint?", options: ["Use VPC interface endpoints and remove internet gateway", "Place the endpoint behind an internet-facing ALB", "Use public subnets with security groups", "Enable public access in Bedrock settings"], answer: 0, explanation: "Interface endpoints keep Bedrock traffic private within your VPC." },

                    { domain: 3, type: 'single', question: "To protect against LLM04: Model Denial of Service in a Bedrock application, which control is most direct?", options: ["Set maximum tokens and concurrent requests in Bedrock Guardrails", "Use AWS Shield Advanced DDoS protection", "Implement WAF rate-based rules on CloudFront", "Both A and C"], answer: 3, explanation: "Guardrails enforce model-level limits; WAF adds edge-layer rate protection." },

                    { domain: 4, type: 'single', question: "You want to restrict Bedrock model access to only specific IAM roles tagged with 'project:genai-prod'. Which policy element achieves this?", options: ["IAM condition key aws:PrincipalTag/project", "Resource policy with PrincipalTag condition", "SCP denying untagged principals", "Bedrock Guardrails tag filters"], answer: 1, explanation: "Resource-based policies on Bedrock models can use PrincipalTag conditions for fine-grained access." },

                    { domain: 4, type: 'single', question: "What is the BEST way to grant temporary elevated Bedrock permissions to a developer for debugging?", options: ["IAM role with AssumeRole and time-bound session duration", "Create a permanent IAM user with full Bedrock access", "Share root credentials temporarily", "Use IAM access key with long expiration"], answer: 0, explanation: "Temporary sessions via AssumeRole follow least-privilege and reduce standing access risk." },

                    { domain: 5, type: 'single', question: "For Bedrock knowledge bases using Amazon OpenSearch Serverless, how do you ensure customer data encryption with your own keys?", options: ["Use customer-managed KMS keys for OpenSearch encryption at rest", "Rely on AWS-managed keys", "Disable encryption for faster queries", "Encrypt only during ingestion"], answer: 0, explanation: "KMS CMKs provide customer control over encryption keys for OpenSearch collections." },

                    { domain: 5, type: 'single', question: "Which Bedrock Guardrails feature helps mitigate LLM02: Insecure Output Handling?", options: ["Output content filters and toxicity detection", "Input PII redaction only", "Rate limiting only", "Model selection restrictions"], answer: 0, explanation: "Output filters block or redact harmful, toxic, or unsafe responses before delivery." },

                    { domain: 6, type: 'single', question: "Which AWS service allows you to create custom conformance packs for Bedrock governance requirements?", options: ["AWS Config", "AWS Security Hub", "AWS Control Tower", "AWS Organizations"], answer: 0, explanation: "AWS Config conformance packs let you define and enforce custom rules for Bedrock usage." },

                    { domain: 6, type: 'single', question: "To prevent shadow usage of Bedrock models in non-approved accounts, what preventive control should be applied?", options: ["AWS Organizations SCP denying bedrock:* actions except in approved OUs", "IAM permission boundaries", "AWS Budgets alerts", "CloudWatch alarms"], answer: 0, explanation: "SCPs provide organization-wide preventive guardrails." },

                    // Extra high-yield questions
                    { domain: 1, type: 'single', question: "Which service provides graph-based investigation for Bedrock-related security findings?", options: ["Amazon Detective", "Amazon GuardDuty", "AWS Security Hub", "Amazon Macie"], answer: 0, explanation: "Detective visualizes relationships between findings, users, resources, and Bedrock invocations." },

                    { domain: 3, type: 'single', question: "For a Bedrock application behind CloudFront, which header helps mitigate LLM03: Training Data Poisoning from malicious uploads?", options: ["Strict-Transport-Security", "Content-Security-Policy", "X-Content-Type-Options", "Bedrock input validation via Guardrails"], answer: 3, explanation: "Guardrails perform input validation and filtering before data reaches the model." },

                    { domain: 4, type: 'single', question: "What IAM feature helps identify and remove unused Bedrock permissions automatically?", options: ["IAM Access Analyzer unused access findings", "AWS Config rules", "CloudTrail insights", "AWS Budgets"], answer: 0, explanation: "Access Analyzer flags unused permissions for Bedrock actions to enforce least privilege." },

                    { domain: 5, type: 'single', question: "How do you enable automatic key rotation for Bedrock model encryption keys?", options: ["Use KMS customer-managed keys with automatic rotation enabled", "Manually rotate keys every 90 days", "Use AWS-managed keys (no rotation needed)", "Disable key rotation for compliance"], answer: 0, explanation: "KMS CMKs support automatic rotation (365 days) while preserving access." },

                    { domain: 2, type: 'single', question: "Which log source is critical for tracing a Bedrock model invocation back to the originating user during incident response?", options: ["AWS CloudTrail management events", "VPC Flow Logs", "CloudWatch Logs from Lambda", "S3 access logs"], answer: 0, explanation: "CloudTrail logs bedrock:InvokeModel calls with principal identity and request parameters." },

                    { domain: 6, type: 'multi', question: "Select TWO governance tools that support Bedrock-specific compliance monitoring.", options: ["AWS Security Hub with AI/ML standards", "AWS Config with Bedrock conformance packs", "AWS Organizations tag policies", "Amazon Inspector"], answer: [0,1], explanation: "Security Hub and Config provide centralized compliance checks for Bedrock usage." },




                            // Even more SCS-C03 questions ‚Äì GenAI security, Bedrock, governance & IAM emphasis

                    { domain: 1, type: 'single', question: "Which GuardDuty protection type should be enabled to detect runtime threats in Amazon Bedrock Agents?", options: ["Runtime Monitoring", "Malware Protection", "EKS Protection", "RDS Protection"], answer: 0, explanation: "Runtime Monitoring in GuardDuty covers Bedrock Agents for anomalous behavior and runtime attacks." },

                    { domain: 1, type: 'single', question: "A Bedrock application is generating unexpected toxic outputs. Which service would detect this as a potential security finding?", options: ["Amazon Bedrock Guardrails toxicity detection", "Amazon GuardDuty Malware Protection", "AWS WAF managed rules", "Amazon Inspector"], answer: 0, explanation: "Bedrock Guardrails actively detect and block toxic, harmful, or unsafe content in model outputs." },

                    { domain: 1, type: 'multi', question: "Select TWO ways to get Bedrock-specific security findings into a centralized dashboard.", options: ["Amazon Security Hub", "Amazon GuardDuty findings for Bedrock", "AWS Config aggregators", "CloudWatch dashboards", "Amazon Detective"], answer: [0,1], explanation: "Security Hub aggregates GuardDuty findings, including expanded Bedrock coverage." },

                    { domain: 2, type: 'single', question: "What is the recommended first forensic step after a Bedrock Guardrails block event on a high-volume prompt injection attempt?", options: ["Review CloudTrail logs for the invoking principal and prompt details", "Delete the blocked prompts", "Reboot the application", "Increase token limits"], answer: 0, explanation: "CloudTrail logs provide the who, what, and when for accurate incident scoping." },

                    { domain: 2, type: 'single', question: "For rapid containment of a suspected compromised Bedrock API key, what automated action should you configure?", options: ["EventBridge + Lambda to revoke the key and notify via SNS", "Manual IAM console deletion", "Ignore if usage is low", "Change the model ID"], answer: 0, explanation: "Automated revocation via Lambda prevents further unauthorized invocations." },

                    { domain: 3, type: 'single', question: "Which AWS service provides the strongest protection against OWASP LLM03 (Training Data Poisoning) for Bedrock knowledge bases?", options: ["Amazon Bedrock Guardrails input validation & filters", "AWS WAF content inspection", "Amazon Macie PII detection", "S3 Object Lock"], answer: 0, explanation: "Guardrails filter and validate inputs before they are used for retrieval or fine-tuning." },

                    { domain: 3, type: 'single', question: "To ensure Bedrock inference traffic never leaves the AWS network from a private VPC, what must you configure?", options: ["VPC interface endpoints for Bedrock", "Internet Gateway + NAT", "Public subnet with public IP", "AWS Transit Gateway only"], answer: 0, explanation: "Interface endpoints provide private connectivity to Bedrock within AWS backbone." },

                    { domain: 4, type: 'single', question: "You need to allow a third-party developer to test a Bedrock model for 2 hours only. What is the most secure method?", options: ["Create an IAM role with AssumeRole, time-limited session, and scoped policy", "Share temporary access keys via email", "Add them to your IAM admin group temporarily", "Use Bedrock public model access"], answer: 0, explanation: "Time-bound AssumeRole sessions minimize risk and follow least privilege." },

                    { domain: 4, type: 'multi', question: "Select TWO IAM features to reduce over-privileged access to Bedrock customization APIs.", options: ["IAM Access Analyzer policy generation", "IAM condition keys (e.g., aws:CalledVia)", "Permanent full Bedrock:* permissions", "Multi-factor authentication on root"], answer: [0,1], explanation: "Access Analyzer creates minimal policies; condition keys restrict context of use." },

                    { domain: 5, type: 'single', question: "For Bedrock custom models deployed in multiple regions, which KMS feature ensures consistent encryption without manual key replication?", options: ["Multi-Region customer-managed keys (CMKs)", "AWS-managed keys", "Single-region CMKs with manual copy", "No encryption needed for models"], answer: 0, explanation: "Multi-Region keys automatically replicate and allow seamless cross-region use." },

                    { domain: 5, type: 'single', question: "Which Bedrock Guardrails capability directly addresses LLM06: Sensitive Information Disclosure?", options: ["PII / PHI redaction in model outputs", "Token rate limiting", "Topic denial lists only", "Input size restrictions"], answer: 0, explanation: "Guardrails automatically detect and redact sensitive data before returning responses." },

                    { domain: 6, type: 'single', question: "What is the most effective preventive control to block unauthorized Bedrock fine-tuning jobs across all accounts?", options: ["Service Control Policy (SCP) denying bedrock:CreateCustomModel", "AWS Budgets alerts on Bedrock spend", "CloudWatch metric alarms", "IAM permission boundaries"], answer: 0, explanation: "SCPs provide organization-wide deny rules for Bedrock actions." },

                    { domain: 6, type: 'single', question: "Which service allows you to monitor Bedrock conformance to company security baselines in a multi-account environment?", options: ["AWS Config with conformance packs", "Amazon Security Hub", "AWS Control Tower", "All of the above"], answer: 3, explanation: "Config, Security Hub, and Control Tower work together for AI governance monitoring." },

                    // High-yield extras ‚Äì OWASP LLM & Bedrock focus
                    { domain: 1, type: 'single', question: "Which OWASP LLM Top 10 risk is mitigated by Bedrock Guardrails' denied topics feature?", options: ["LLM08: Excessive Agency", "LLM07: Insecure Plugin Design", "LLM05: Supply Chain Vulnerabilities", "LLM09: Overreliance"], answer: 0, explanation: "Denied topics prevent the model from engaging in restricted or risky behaviors." },

                    { domain: 3, type: 'single', question: "For a Bedrock RAG application, what edge protection helps against malicious document uploads (LLM05 risk)?", options: ["Amazon Bedrock Guardrails document analysis filters", "AWS WAF file size limits", "S3 pre-signed URLs only", "VPC endpoints"], answer: 0, explanation: "Guardrails scan and filter uploaded content before ingestion into knowledge bases." },

                    { domain: 4, type: 'single', question: "What is the recommended way to audit who can invoke a specific Bedrock custom model?", options: ["CloudTrail + resource policy on the model", "CloudWatch Logs only", "IAM user report", "Bedrock console access history"], answer: 0, explanation: "Resource policies + CloudTrail provide full audit trail of invocations." },

                    { domain: 5, type: 'single', question: "How can you enforce encryption for Bedrock knowledge base vector stores in Amazon OpenSearch Serverless?", options: ["Enable customer-managed KMS encryption at collection creation", "Use default AWS-managed encryption", "Disable vector store encryption", "Encrypt only query results"], answer: 0, explanation: "KMS CMKs ensure customer control over knowledge base encryption." },

                    { domain: 2, type: 'single', question: "After revoking access during a Bedrock incident, what should you do next for lessons learned?", options: ["Conduct root cause analysis using CloudTrail and GuardDuty findings", "Immediately re-enable the model", "Delete all related logs", "Ignore if no data was leaked"], answer: 0, explanation: "Root cause analysis prevents recurrence." },

                    { domain: 6, type: 'single', question: "Which framework lens should you use to evaluate the security of a generative AI workload architecture?", options: ["AWS Well-Architected Framework ‚Äì AI & Machine Learning Lens", "AWS Well-Architected Framework ‚Äì Security Pillar only", "AWS CAF", "NIST AI Risk Management Framework"], answer: 0, explanation: "The AI/ML Lens includes specific security best practices for GenAI workloads." },

                            // Final large batch of SCS-C03 questions ‚Äì mixed domains, heavy GenAI/Bedrock/OWASP focus

                    { domain: 1, type: 'single', question: "Which Amazon GuardDuty capability now includes detection of anomalous Bedrock model fine-tuning attempts?", options: ["Expanded Threat Detection for AI/ML", "S3 Malware Protection", "EBS Volume Scanning", "Lambda Function Monitoring"], answer: 0, explanation: "GuardDuty's AI/ML expansion covers unusual fine-tuning patterns and unauthorized customization." },

                    { domain: 1, type: 'single', question: "A Bedrock application logs unusual invocation spikes from an unknown IP. Which tool provides the fastest correlation to a potential credential compromise?", options: ["Amazon GuardDuty + CloudTrail integration", "CloudWatch Logs Insights only", "Amazon Inspector runtime scan", "VPC Flow Logs"], answer: 0, explanation: "GuardDuty correlates anomalous behavior with CloudTrail to identify compromised credentials quickly." },

                    { domain: 1, type: 'multi', question: "Select TWO services that can ingest Bedrock invocation logs for threat hunting in OCSF format.", options: ["Amazon Security Lake", "Amazon OpenSearch Service", "AWS CloudTrail Lake", "Amazon Macie", "AWS Config"], answer: [0,1], explanation: "Security Lake and OpenSearch support OCSF-standardized logs for advanced hunting." },

                    { domain: 2, type: 'single', question: "During a Bedrock-related incident, you discover repeated failed invocations from a single IP. What is the most appropriate containment action?", options: ["Block the IP at AWS WAF or Network Firewall", "Delete the model version", "Revoke all IAM roles globally", "Ignore as failed attempts"], answer: 0, explanation: "Edge-level IP blocking (WAF or Network Firewall) contains the attack without broad disruption." },

                    { domain: 2, type: 'single', question: "What Bedrock feature should be reviewed first when investigating a potential LLM jailbreak incident?", options: ["Guardrails deny lists and prompt filters", "CloudTrail invocation history", "Model metrics in CloudWatch", "S3 training data logs"], answer: 0, explanation: "Guardrails logs show which filters were bypassed or why a prompt was allowed." },

                    { domain: 3, type: 'single', question: "To mitigate LLM07: Insecure Plugin Design in a Bedrock-integrated application, what infrastructure control is recommended?", options: ["Strict IAM roles for plugin execution + least privilege", "Public API Gateway endpoints", "No authentication on plugins", "Allow full Bedrock access to plugins"], answer: 0, explanation: "Least-privilege IAM roles limit what plugins can do if compromised." },

                    { domain: 3, type: 'single', question: "Which VPC configuration ensures Bedrock knowledge base queries remain private even when using Amazon Aurora?", options: ["VPC interface endpoints for Bedrock and Aurora", "Public subnets with security groups", "Internet Gateway + NAT", "Transit Gateway only"], answer: 0, explanation: "Interface endpoints keep both Bedrock and Aurora traffic within the AWS private network." },

                    { domain: 4, type: 'single', question: "You need to allow Bedrock access only during business hours (08:00‚Äì18:00 UTC). What IAM condition key achieves this?", options: ["aws:CurrentTime with date range condition", "aws:SourceIp", "aws:MultiFactorAuthPresent", "aws:RequestedRegion"], answer: 0, explanation: "aws:CurrentTime lets you enforce time-based access windows." },

                    { domain: 4, type: 'multi', question: "Select TWO ways to prevent standing access to Bedrock customization permissions.", options: ["Use IAM roles with short session durations", "Require approval workflows via AWS SSO permission sets", "Grant permanent AdministratorAccess", "Use root user for customization"], answer: [0,1], explanation: "Short sessions and approval workflows reduce standing privileged access." },

                    { domain: 5, type: 'single', question: "For Bedrock model evaluation jobs with private test datasets, how do you enforce encryption with auditability?", options: ["KMS CMKs with CloudTrail logging enabled", "AWS-managed keys", "No encryption for evaluation speed", "Client-side encryption only"], answer: 0, explanation: "KMS CMKs + CloudTrail provide customer control and full usage audit trail." },

                    { domain: 5, type: 'single', question: "Which Bedrock Guardrails setting helps mitigate LLM09: Overreliance by limiting misleading outputs?", options: ["Confidence score thresholds and disclaimers", "Token limits only", "Denied topics only", "Rate limiting"], answer: 0, explanation: "Guardrails can add disclaimers or block low-confidence responses to reduce overreliance risk." },

                    { domain: 6, type: 'single', question: "Which AWS service lets you create organization-wide policies to require Bedrock Guardrails on all custom models?", options: ["AWS Organizations SCPs + AWS Config rules", "AWS Budgets", "CloudWatch alarms", "IAM permission boundaries"], answer: 0, explanation: "SCPs deny non-compliant usage; Config enforces and remediates Guardrails requirements." },

                    { domain: 6, type: 'single', question: "To track Bedrock spend and flag unusual model usage for governance, what is the best combination?", options: ["AWS Cost Explorer + CloudWatch anomaly detection", "AWS Budgets only", "Amazon Inspector cost findings", "S3 access logs"], answer: 0, explanation: "Cost Explorer tags + CloudWatch anomalies detect unexpected high-cost invocations." },

                    // More high-yield extras ‚Äì mixed OWASP LLM & cross-domain
                    { domain: 1, type: 'single', question: "Which OWASP LLM Top 10 risk is best addressed by Bedrock Guardrails' maximum response length setting?", options: ["LLM04: Model Denial of Service", "LLM10: Model Theft", "LLM02: Insecure Output Handling", "LLM06: Sensitive Information Disclosure"], answer: 0, explanation: "Limiting output length helps prevent resource exhaustion via verbose or looping responses." },

                    { domain: 3, type: 'single', question: "What is the strongest defense against LLM05: Supply Chain Vulnerabilities when using Bedrock foundation models?", options: ["Rely on AWS-managed model security updates", "Use only open-source models", "Disable model updates", "Custom fine-tuning only"], answer: 0, explanation: "AWS continuously patches foundation models; Guardrails add input/output safeguards." },

                    { domain: 4, type: 'single', question: "How can you enforce that Bedrock invocations require MFA for all human users?", options: ["IAM policy condition aws:MultiFactorAuthPresent", "Bedrock Guardrails authentication check", "AWS SSO MFA enforcement", "Both A and C"], answer: 3, explanation: "IAM conditions + SSO enforce MFA at the identity level." },

                    { domain: 5, type: 'single', question: "For Bedrock Agents that call external APIs, how do you protect sensitive data in transit?", options: ["Use HTTPS endpoints + VPC endpoints for Bedrock", "Plain HTTP for speed", "No encryption needed", "Encrypt only API responses"], answer: 0, explanation: "VPC endpoints + HTTPS ensure private, encrypted communication." },

                    { domain: 2, type: 'single', question: "After containing a Bedrock incident, what is the next phase in the AWS incident response playbook?", options: ["Eradication (remove root cause)", "Recovery (restore normal operations)", "Post-incident analysis", "Detection refinement"], answer: 0, explanation: "Eradication removes the vulnerability (e.g., patch, revoke keys) before recovery." },

                    { domain: 6, type: 'single', question: "Which lens in the AWS Well-Architected Framework specifically addresses security for generative AI workloads?", options: ["AI & Machine Learning Lens ‚Äì Security Pillar", "Cost Optimization Lens", "Reliability Pillar only", "Operational Excellence"], answer: 0, explanation: "The AI/ML Lens includes tailored security best practices for Bedrock and GenAI." }

                ]
            }




        ];

        function renderExams() {
            console.log("Rendering exams - count:", exams.length); // Debug to confirm
            const container = document.getElementById('examsView');
            container.innerHTML = exams.map((exam, idx) => `
                <div class="exam-card" onclick="selectExam(${idx})">
                    <div class="exam-header">
                        <div class="exam-icon">${exam.icon}</div>
                        <div class="exam-title">
                            <h3>${exam.title}</h3>
                            <p>${exam.description}</p>
                        </div>
                    </div>
                    <div class="exam-meta">
                        <span class="difficulty ${exam.difficulty}">${exam.difficulty.charAt(0).toUpperCase() + exam.difficulty.slice(1)}</span>
                        <span class="question-count">~90 questions</span>
                    </div>
                </div>
            `).join('');
        }
                function selectExam(idx) {
            state.selectedExam = idx;
            document.getElementById('examsView').classList.add('hidden');
            document.getElementById('instructionsView').classList.remove('hidden');
            renderInstructions();
        }

        function renderInstructions() {
            const exam = exams[state.selectedExam];
            const container = document.getElementById('instructionsView');
            container.innerHTML = `
                <h2>Exam Instructions</h2>
                <p>This practice exam simulates the ${exam.title} certification test as closely as possible.</p>
                <ul>
                    <li><strong>Format</strong>: Up to 90 questions, including multiple-choice (single and multiple response).</li>
                    <li><strong>Time Limit</strong>: ${exam.timeLimitMinutes || 90} minutes. The timer starts when you click 'Start Exam' and auto-submits if time expires.</li>
                    <li><strong>Navigation</strong>: No backtracking ‚Äî answer and move to the next question.</li>
                    <li><strong>Scoring</strong>: Passing score is 750 on a 100-900 scale. Detailed report at the end.</li>
                    <li><strong>Questions</strong>: Randomized from a large library ‚Äî each attempt is unique.</li>
                    <li><strong>Tips</strong>: Read carefully, manage time (~1 min/question). Multi-select questions require all correct answers.</li>
                </ul>
                <button class="start-btn" onclick="startExam()">Start Exam</button>
            `;
        }

        function startExam() {
    const exam = exams[state.selectedExam];
   
    // Define realistic question counts per exam (matching real exam ranges)
    const questionRanges = {
        1: 90,                    // Security+ max 90
        2: 65,                    // CLF-C02: 65 total
        3: { min: 100, max: 150 }, // CISSP adaptive
        4: { min: 40, max: 60 },  // SC-300: 40‚Äì60
        5: 65                     // SCS-C03: 65 total
    };

    let targetCount;
    const range = questionRanges[exam.id];
    if (typeof range === 'object') {
        // For ranges (e.g. CISSP, SC-300): pick random between min-max
        targetCount = Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;
    } else {
        // Fixed max (e.g. Security+, AWS exams)
        targetCount = range;
    }

    // Shuffle and slice to target count (or all if fewer questions available)
    state.questions = shuffle([...exam.questions]).slice(0, Math.min(targetCount, exam.questions.length));
    
    state.answers = new Array(state.questions.length).fill(null);
    state.currentQuestion = 0;
    state.startTime = Date.now();
    state.timeRemaining = exam.timeLimitMinutes * 60;
    
    document.getElementById('instructionsView').classList.add('hidden');
    document.getElementById('examView').classList.remove('hidden');
    
    renderQuestion();
    state.timerInterval = setInterval(updateTimer, 1000);
}

        function updateTimer() {
            state.timeRemaining--;
            const min = Math.floor(state.timeRemaining / 60);
            const sec = state.timeRemaining % 60;
            const timerEl = document.getElementById('timer');
            if (timerEl) {
                timerEl.textContent = `Time Remaining: ${min}:${sec < 10 ? '0' : ''}${sec}`;
            }
            if (state.timeRemaining <= 0) {
                clearInterval(state.timerInterval);
                endExam();
            }
        }
                function renderQuestion() {
            const q = state.questions[state.currentQuestion];
            const container = document.getElementById('examView');
            const inputType = q.type === 'single' ? 'radio' : 'checkbox';

            container.innerHTML = `
                <div class="timer" id="timer">Time Remaining: ${Math.floor(state.timeRemaining / 60)}:${(state.timeRemaining % 60) < 10 ? '0' : ''}${state.timeRemaining % 60}</div>
                <div class="question-box">${q.question}</div>
                <div class="options-container">
                    ${q.options.map((opt, i) => `
                        <div class="option" onclick="${q.type === 'single' ? `selectOption(${i})` : ''}">
                            <input type="${inputType}" name="answer" id="opt${state.currentQuestion}-${i}" value="${i}" ${q.type === 'multi' ? 'onclick="toggleMultiSelect(this)"' : ''}>
                            <label for="opt${state.currentQuestion}-${i}">${opt}</label>
                        </div>
                    `).join('')}
                </div>
                <button class="submit-btn" onclick="submitQuestionAnswer()">Next Question</button>
            `;
        }

        function selectOption(idx) {
            const opts = document.querySelectorAll('.option');
            opts.forEach(o => o.classList.remove('selected'));
            opts[idx].classList.add('selected');
            document.querySelectorAll('input[name="answer"]').forEach(r => r.checked = false);
            document.getElementById(`opt${state.currentQuestion}-${idx}`).checked = true;
        }

        function toggleMultiSelect(input) {
            input.parentNode.classList.toggle('selected', input.checked);
        }

        function submitQuestionAnswer() {
            const q = state.questions[state.currentQuestion];
            let selected = [];

            document.querySelectorAll('input[name="answer"]:checked').forEach(inp => {
                selected.push(parseInt(inp.value));
            });

            if (q.type === 'multi') {
                selected.sort((a, b) => a - b);
            } else if (q.type === 'single') {
                selected = selected.length > 0 ? selected[0] : null;
            }

            state.answers[state.currentQuestion] = selected;
            console.log(`Q${state.currentQuestion + 1} saved:`, selected); // debug

            if (state.currentQuestion < state.questions.length - 1) {
                state.currentQuestion++;
                renderQuestion();
            } else {
                clearInterval(state.timerInterval);
                endExam();
            }
        }
function endExam() {
    clearInterval(state.timerInterval);
    document.getElementById('examView').classList.add('hidden');
    document.getElementById('resultsView').classList.remove('hidden');

    const exam = exams[state.selectedExam];
    const total = state.questions.length;
    let correct = 0;

    // Dynamically create domainScores
    const domainScores = {};
    state.questions.forEach(q => {
        if (!domainScores[q.domain]) {
            domainScores[q.domain] = { correct: 0, total: 0 };
        }
        domainScores[q.domain].total++;
    });

    state.questions.forEach((q, i) => {
        const userAns = state.answers[i];
        let isCorrect = false;

        if (userAns === null || userAns === undefined) {
            isCorrect = false;
        } else if (q.type === 'single') {
            isCorrect = userAns === q.answer;
        } else if (q.type === 'multi') {
            const correctAns = Array.isArray(q.answer) ? q.answer.slice().sort((a,b)=>a-b) : [];
            isCorrect = Array.isArray(userAns) && userAns.length === correctAns.length &&
                        userAns.every((val, idx) => val === correctAns[idx]);
        }

        if (isCorrect) {
            correct++;
            domainScores[q.domain].correct++;
        }
    });

    const rawPercent = total > 0 ? (correct / total) * 100 : 0;

    // Weighted percentage using domainWeights
    let weightedPercent = 0;
    const weights = exam.domainWeights || [];
    const domainKeys = Object.keys(domainScores).map(Number).sort((a,b)=>a-b);
    domainKeys.forEach(d => {
        const weightIndex = d - 1;
        const weight = (weights[weightIndex] !== undefined) ? weights[weightIndex] : (1 / domainKeys.length); // fallback equal weight
        const domainPercent = (domainScores[d].correct / domainScores[d].total) || 0;
        weightedPercent += domainPercent * weight;
    });

    // Scale to 100‚Äì900 (common for these exams; adjust if needed)
    const score = Math.round(100 + (weightedPercent * 800));
    const passThreshold = exam.passThreshold || 750; // can add to exam objects if you want per-exam variation
    const pass = score >= passThreshold;

    state.examHistory.push({score, pass});
    updateDashboard();

    const container = document.getElementById('resultsView');
    container.innerHTML = `
        <h2 class="results-header">Exam Results</h2>
        <p>Your score: ${score}/900 <span class="${pass ? 'pass' : 'fail'}">(${pass ? 'PASS' : 'FAIL'})</span></p>
        <p>Correct answers: ${correct}/${total} (${rawPercent.toFixed(1)}% raw, weighted: ${(weightedPercent * 100).toFixed(1)}%)</p>
        <p>Time used: ${Math.floor((Date.now() - state.startTime) / 60000)} minutes</p>
        <div class="domain-breakdown">
            <h4>Domain Breakdown</h4>
            ${domainKeys.map(d => {
    const domainName = exam.domainNames?.[d - 1] || `Domain ${d}`;
    const percent = ((domainScores[d].correct / domainScores[d].total) * 100 || 0).toFixed(1);
    return `
        <div><strong>${domainName}</strong>: ${domainScores[d].correct}/${domainScores[d].total} (${percent}%)</div>
        <div class="domain-bar">
            <div class="domain-fill" style="width: ${percent}%"></div>
        </div>
    `;
}).join('')}
        </div>
        <button class="back-btn" onclick="backToExams()">Back to Exams</button>
    `;
}

        function backToExams() {
            document.getElementById('resultsView').classList.add('hidden');
            document.getElementById('instructionsView').classList.add('hidden');
            document.getElementById('examView').classList.add('hidden');
            document.getElementById('examsView').classList.remove('hidden');
        }

        function updateDashboard() {
            const history = state.examHistory;
            if (history.length === 0) return;
            document.getElementById('lastScore').textContent = history[history.length - 1].score;
            document.getElementById('examsCompleted').textContent = history.length;
            const passes = history.filter(h => h.pass).length;
            document.getElementById('passRate').textContent = ((passes / history.length) * 100).toFixed(1) + '%';
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        // Initialize
        renderExams();
    </script>
</body>
</html>
