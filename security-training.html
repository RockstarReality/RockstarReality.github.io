<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Training Lab</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .header p { color: #a0a0a0; font-size: 1.1rem; }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        .stat-card h3 { color: #a0a0a0; font-size: 0.9rem; margin-bottom: 8px; font-weight: 500; }
        .stat-card .value { font-size: 2rem; font-weight: 700; color: #ffd700; }
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }
        .module-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .module-card:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }
        .module-header { display: flex; align-items: flex-start; gap: 15px; margin-bottom: 15px; }
        .module-icon {
            background: rgba(255, 215, 0, 0.2);
            padding: 12px;
            border-radius: 8px;
            font-size: 24px;
        }
        .module-title { flex: 1; }
        .module-title h3 { color: #ffd700; font-size: 1.3rem; margin-bottom: 8px; }
        .module-title p { color: #a0a0a0; font-size: 0.9rem; line-height: 1.5; }
        .module-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        .difficulty {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .difficulty.beginner { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .difficulty.intermediate { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .difficulty.advanced { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .exercise-count { color: #666; font-size: 0.85rem; }
        .exercise-view {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        .exercise-header h3 { color: #ffd700; font-size: 1.3rem; }
        .back-btn {
            background: transparent;
            border: 1px solid #666;
            color: #fff;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .back-btn:hover { border-color: #ffd700; color: #ffd700; }
        .question-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        .hint-box {
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .hint-box p { color: #c084fc; font-size: 0.9rem; }
        .options-container { margin-bottom: 20px; }
        .option {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #666;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .option:hover { background: rgba(255, 255, 255, 0.05); }
        .option.selected {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }
        .option input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .submit-btn {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .submit-btn:hover { background: #ffed4e; transform: translateY(-2px); }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .feedback-box {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid;
        }
        .feedback-box.correct {
            background: rgba(34, 197, 94, 0.1);
            border-color: rgba(34, 197, 94, 0.5);
        }
        .feedback-box.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.5);
        }
        .feedback-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .feedback-box.correct .feedback-header { color: #22c55e; }
        .feedback-box.incorrect .feedback-header { color: #ef4444; }
        .feedback-explanation { color: #d1d5db; line-height: 1.6; margin-bottom: 15px; }
        .next-btn {
            background: #374151;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .next-btn:hover { background: #4b5563; }
        .completed-badge { color: #22c55e; font-size: 1.2rem; margin-left: 10px; }
        .hidden { display: none; }
        @media (max-width: 768px) {
            .header h1 { font-size: 2rem; }
            .modules-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><span>üõ°Ô∏è</span> Security Training Lab</h1>
            <p>Interactive hands-on security exercises ‚Äî cloud nine edition</p>
        </div>
        <div class="dashboard">
            <div class="stat-card">
                <h3>Total Score</h3>
                <div class="value" id="totalScore">0</div>
            </div>
            <div class="stat-card">
                <h3>Modules Completed</h3>
                <div class="value" id="modulesCompleted">0/9</div>
            </div>
            <div class="stat-card">
                <h3>Skill Level</h3>
                <div class="value" id="skillLevel">Novice</div>
            </div>
        </div>
        <div id="modulesView" class="modules-grid"></div>
        <div id="exerciseView" class="exercise-view hidden"></div>
    </div>
    <script>
        const state = {
            selectedModule: null,
            currentExercise: 0,
            score: 0,
            completedModules: []
        };

        const modules = [
            {
                id: 1,
                title: "SQL Injection Basics",
                icon: "‚ö†Ô∏è",
                difficulty: "beginner",
                description: "Learn to identify, exploit patterns and prevent SQL injection vulnerabilities",
                exercises: [
                    { question: "What is SQL Injection (SQLi)?", options: ["A code injection technique that destroys the database", "A technique to insert malicious SQL code into a query", "A way to optimize slow SQL queries", "A type of authentication bypass only"], answer: 1, explanation: "SQL Injection is a code injection technique used to attack data-driven applications by inserting malicious SQL statements." },
                    { question: "Which payload is a classic login bypass for: WHERE user='$input' AND pass='$pass'?", options: ["admin' --", "' OR '1'='1", "'; DROP TABLE users; --", "All of the above can work in different scenarios"], answer: 3, explanation: "All three are common payloads: comment-out, tautology, and destructive (if stacked queries allowed)." },
                    { question: "What is the MOST effective defense against SQL Injection?", options: ["Input sanitization/escaping", "Blacklist filtering", "Parameterized queries / prepared statements", "Regular expressions on input"], answer: 2, explanation: "Parameterized queries completely separate code from data ‚Äî the gold standard defense." },
                    { question: "Which code is vulnerable to SQLi?", options: ["cursor.execute('SELECT * FROM users WHERE id = ?', (uid,))", "cursor.execute(f'SELECT * FROM users WHERE id = {uid}')", "cursor.execute('SELECT * FROM users WHERE id = %s', (uid,))", "A and C are safe"], answer: 1, explanation: "String interpolation (f-string) directly inserts user input ‚Üí vulnerable." },
                    { question: "What does the payload ' UNION SELECT 1,2,3 -- do?", options: ["Bypasses login", "Appends extra rows to the result", "Drops the table", "Causes error to leak info"], answer: 1, explanation: "UNION-based injection appends attacker-controlled data to the original query results." },
                    { question: "Blind SQL Injection relies on?", options: ["Visible error messages", "Time delays or boolean conditions", "Union results", "Stacked queries"], answer: 1, explanation: "Blind SQLi infers information from app behavior (true/false pages or sleep delays) when no data is directly returned." },
                    { question: "Which function can help detect SQLi in logs?", options: ["UNION", "OR 1=1", "SLEEP(5)", "All are common indicators"], answer: 3, explanation: "All are classic signatures looked for in WAF / SIEM rules." },
                    { question: "What is error-based SQL Injection?", options: ["Forcing database to return errors with table/column info", "Injecting via time delays", "Bypassing login only", "Dropping tables"], answer: 0, explanation: "Error-based SQLi triggers verbose errors that leak database structure." },
                    { question: "Best practice: Where should input validation happen?", options: ["Only client-side", "Only server-side", "Both, but server-side is mandatory", "Never needed with prepared statements"], answer: 2, explanation: "Defense-in-depth: client-side for UX, server-side always required." }
                ]
            },
            {
                id: 2,
                title: "IAM Best Practices",
                icon: "üîí",
                difficulty: "intermediate",
                description: "Master cloud IAM principles, least privilege and secure identity management",
                exercises: [
                    { question: "What does the IAM policy {\"Effect\":\"Allow\",\"Action\":\"*\",\"Resource\":\"*\"} do?", options: ["Grants full access everywhere", "Denies everything", "Allows only read access", "Is invalid syntax"], answer: 0, explanation: "This is the most dangerous policy ‚Äî full admin rights on everything." },
                    { question: "Best way to give AWS services permissions?", options: ["Store access keys in code", "Use IAM roles with temporary credentials", "Share root account", "Long-lived user keys"], answer: 1, explanation: "IAM roles provide temporary creds and follow the 'no secrets in code' principle." },
                    { question: "Principle of Least Privilege means?", options: ["Give users full admin", "Grant only permissions actually needed", "Never rotate keys", "Use wildcards everywhere"], answer: 1, explanation: "Users/services get exactly ‚Äî and only ‚Äî the permissions required for their task." },
                    { question: "What should you do with root account after setup?", options: ["Use it daily", "Delete access keys and enable MFA", "Share with team", "Leave without MFA"], answer: 1, explanation: "Root should be rarely used, locked down with MFA, no keys." },
                    { question: "Which is better for EC2 instance permissions?", options: ["Attach policy to IAM user", "Use instance profile with IAM role", "Hardcode keys in app", "Grant AdministratorAccess"], answer: 1, explanation: "Instance profiles auto-provide temporary creds via metadata service." },
                    { question: "IAM Access Analyzer helps with?", options: ["Finding unused permissions and external access", "Creating policies automatically", "Rotating keys", "All of the above"], answer: 3, explanation: "It identifies unused roles, public buckets, external sharing, etc." },
                    { question: "Best practice for access keys?", options: ["Never create them if possible", "Rotate every 30 days", "Store in env variables", "All are good practices"], answer: 0, explanation: "Prefer roles over keys; if keys needed ‚Üí rotate regularly and monitor usage." },
                    { question: "What is IAM Identity Center used for?", options: ["Centralized SSO for AWS accounts", "Only for EC2", "Storing secrets", "Creating users"], answer: 0, explanation: "Successor to SSO ‚Äî manages workforce identities across accounts." },
                    { question: "Should you use wildcards (*) in policies?", options: ["Always ‚Äî it's convenient", "Only when unavoidable and scoped tightly", "Never ‚Äî always explicit", "Only for resources"], answer: 1, explanation: "Avoid broad wildcards; use specific actions/resources when possible." }
                ]
            },
            {
                id: 3,
                title: "Incident Response",
                icon: "üéØ",
                difficulty: "advanced",
                description: "Practice the full incident response lifecycle and decision making",
                exercises: [
                    { question: "First phase of NIST IR lifecycle?", options: ["Preparation", "Detection & Analysis", "Containment", "Recovery"], answer: 0, explanation: "Preparation includes tools, team, playbooks ‚Äî happens before incidents." },
                    { question: "Immediate action on compromised IAM key?", options: ["Investigate logs first", "Disable / revoke the key", "Delete the user", "Rotate all keys"], answer: 1, explanation: "Containment first: stop the bleeding by revoking access." },
                    { question: "Before shutting down infected server, do?", options: ["Capture volatile memory", "Reboot immediately", "Delete malware", "Ignore ‚Äî continue operation"], answer: 0, explanation: "Preserve evidence: memory dump, network connections, etc." },
                    { question: "What is 'lessons learned' phase?", options: ["Post-incident review and improvement", "Eradication of malware", "Containment actions", "Detection rules"], answer: 0, explanation: "After recovery: analyze what went wrong and improve defenses." },
                    { question: "Chain of custody is important for?", options: ["Evidence admissibility in court", "Faster containment", "User notifications", "Log rotation"], answer: 0, explanation: "Documents handling of evidence to maintain integrity." },
                    { question: "During containment, should you?", options: ["Preserve all logs", "Delete suspicious files immediately", "Reimage everything first", "Ignore backups"], answer: 0, explanation: "Preserve data for forensics ‚Äî don't destroy evidence." },
                    { question: "What is 'triage' in incident response?", options: ["Prioritizing incidents by severity", "Eradicating malware", "Notifying executives", "Restoring backups"], answer: 0, explanation: "Quick assessment to decide which incidents need urgent response." },
                    { question: "Best communication during active incident?", options: ["Use secure out-of-band channel", "Email everyone", "Post on Slack publicly", "Wait until resolved"], answer: 0, explanation: "Assume breach ‚Äî use encrypted, need-to-know channels." },
                    { question: "Golden image helps in?", options: ["Rapid recovery / rebuilding systems", "Detection only", "Prevention only", "Forensics"], answer: 0, explanation: "Pre-hardened, clean images speed up eradication/recovery." }
                ]
            },
            {
                id: 4,
                title: "Zero Trust Architecture",
                icon: "üõ°Ô∏è",
                difficulty: "intermediate",
                description: "Deep dive into Zero Trust principles, pillars and implementation",
                exercises: [
                    { question: "Core Zero Trust motto?", options: ["Trust but verify", "Never trust, always verify", "Trust internal network", "Verify only at perimeter"], answer: 1, explanation: "Assume breach ‚Äî verify every access regardless of location." },
                    { question: "Which is NOT a core Zero Trust pillar?", options: ["Verify explicitly", "Least privilege access", "Assume breach", "Trust internal traffic"], answer: 3, explanation: "No automatic trust ‚Äî even inside the network." },
                    { question: "Access decisions in ZTA based on?", options: ["Location only", "Identity + device + context + risk", "Username/password only", "VPN status"], answer: 1, explanation: "Contextual, dynamic policies (who, what, where, device health, etc.)." },
                    { question: "Zero Trust assumes?", options: ["Network is secure", "Breach has already occurred", "Perimeter is enough", "Internal users are trusted"], answer: 1, explanation: "Design assumes attackers are already inside." },
                    { question: "Micro-segmentation in ZTA means?", options: ["Granular access controls between workloads", "One big flat network", "Only firewall at edge", "No segmentation needed"], answer: 0, explanation: "Limit lateral movement with fine-grained policies." },
                    { question: "Continuous authentication / verification includes?", options: ["Only login time", "Ongoing risk scoring and re-auth", "Never re-authenticate", "Only at session start"], answer: 1, explanation: "Monitor behavior and re-verify as risk changes." },
                    { question: "Device health in ZTA checks?", options: ["Patch level, AV, EDR posture", "Only OS version", "Nothing ‚Äî trust all devices", "Only if on corporate Wi-Fi"], answer: 0, explanation: "Unhealthy devices get restricted or denied access." },
                    { question: "Data-centric security in ZTA?", options: ["Classify and protect data regardless of location", "Only secure at rest", "Ignore data classification", "Focus only on network"], answer: 0, explanation: "Protect sensitive data everywhere ‚Äî encryption, DLP, etc." },
                    { question: "Common ZTA implementation starting point?", options: ["Strong identity + MFA everywhere", "Replace all firewalls", "Disable VPN", "Trust cloud provider default"], answer: 0, explanation: "Start with identity as the new perimeter." }
                ]
            },
            {
                id: 5,
                title: "Cloud Misconfigurations & Vulnerabilities",
                icon: "‚òÅÔ∏è",
                difficulty: "intermediate",
                description: "Identify and remediate common cloud security misconfigurations in AWS and multi-cloud environments",
                exercises: [
                    { question: "What is one of the most common AWS S3 misconfigurations?", options: ["Public read/write bucket ACLs or policies", "Using SSE-KMS encryption", "Enabling versioning", "Bucket logging"], answer: 0, explanation: "Public buckets (via ACLs, bucket policies, or disabled block public access) expose data to the internet and are a top breach cause." },
                    { question: "An IAM policy with 'Action': '*' and 'Resource': '*' violates which principle?", options: ["Defense in depth", "Least privilege", "Data encryption", "Logging"], answer: 1, explanation: "This grants full access to everything ‚Äî a severe violation of least privilege." },
                    { question: "What does an open security group port 22 (SSH) to 0.0.0.0/0 allow?", options: ["Secure remote access", "Brute-force attacks from anywhere", "Only internal VPC traffic", "No risk"], answer: 1, explanation: "It exposes SSH to the entire internet, enabling credential stuffing or exploitation attempts." },
                    { question: "Which AWS feature, if disabled, can lead to data exposure?", options: ["Block Public Access on S3", "CloudTrail logging", "GuardDuty", "VPC Flow Logs"], answer: 0, explanation: "S3 Block Public Access prevents accidental public exposure; disabling it risks leaks." },
                    { question: "What vulnerability occurs when an EC2 instance has an IAM role with excessive permissions?", options: ["Privilege escalation if compromised", "No vulnerability", "Only network issues", "Storage overflow"], answer: 0, explanation: "Attackers can use the role's permissions for lateral movement or data exfiltration." },
                    { question: "Exposed metadata service (169.254.169.254) on EC2 can leak?", options: ["IAM role temporary credentials", "Nothing sensitive", "Only instance ID", "User passwords"], answer: 0, explanation: "IMDSv1 allows unauthenticated access to instance metadata, including role creds if SSRF or compromised." },
                    { question: "What is 'Shadow Resources' in cloud security?", options: ["Untagged or forgotten resources with permissions", "Encrypted backups", "Multi-factor auth", "Load balancers"], answer: 0, explanation: "Orphaned resources often retain broad permissions, creating hidden attack surfaces." },
                    { question: "Which tool helps detect public S3 buckets automatically?", options: ["AWS Config", "IAM Access Analyzer", "Both", "Neither"], answer: 2, explanation: "Access Analyzer finds public resources; Config tracks compliance rules." },
                    { question: "A Lambda function with overly broad VPC access risks?", options: ["Data exfiltration via internet", "No risk", "Only cold starts", "Execution timeouts"], answer: 0, explanation: "Broad VPC/subnet access can allow exfiltration if function is compromised." }
                ]
            },
            {
                id: 6,
                title: "Cloud-Native Security Controls & Monitoring",
                icon: "üîç",
                difficulty: "advanced",
                description: "Master AWS-native security services, logging, detection, and response in cloud environments",
                exercises: [
                    { question: "What service records API calls across AWS for auditing?", options: ["CloudTrail", "CloudWatch", "GuardDuty", "Config"], answer: 0, explanation: "CloudTrail logs all API activity (management + data events) for forensics and compliance." },
                    { question: "GuardDuty uses machine learning to detect threats like?", options: ["Crypto mining, reconnaissance, credential abuse", "Slow queries only", "High CPU usage", "Storage growth"], answer: 0, explanation: "It analyzes CloudTrail, VPC Flow Logs, and DNS logs for malicious behavior." },
                    { question: "AWS Config is primarily used for?", options: ["Continuous compliance monitoring and configuration history", "Real-time threat detection", "Log storage", "Encryption"], answer: 0, explanation: "Config records resource configurations, changes, and compliance against rules." },
                    { question: "What is the best practice for CloudTrail logs?", options: ["Enable multi-region trail + log file validation + S3 encryption", "Disable after setup", "Store in public bucket", "Use only single region"], answer: 0, explanation: "Protect integrity with validation, encrypt at rest, and cover all regions." },
                    { question: "Amazon Inspector assesses?", options: ["EC2 instances and Lambda for software vulnerabilities", "Only network ports", "IAM policies only", "S3 buckets"], answer: 0, explanation: "It scans for CVE vulnerabilities, network exposure, and best practice deviations." },
                    { question: "What does AWS Security Hub provide?", options: ["Centralized security posture view + findings aggregation", "Backup service", "Cost management", "User authentication"], answer: 0, explanation: "Aggregates findings from GuardDuty, Inspector, Config, etc., with compliance checks." },
                    { question: "For incident response in cloud, first action on suspicious GuardDuty finding?", options: ["Isolate affected resource (e.g., revoke IAM role, quarantine instance)", "Ignore low severity", "Delete the finding", "Wait 24h"], answer: 0, explanation: "Contain first: limit damage while investigating." },
                    { question: "VPC Flow Logs help investigate?", options: ["Network traffic anomalies and exfiltration", "CPU usage", "Storage access", "User logins"], answer: 0, explanation: "Capture IP traffic metadata for forensics (e.g., unusual outbound to C2)." },
                    { question: "MFA Delete on S3 bucket protects against?", options: ["Accidental or malicious deletion/versioning changes", "Data exfiltration", "Public access", "Encryption bypass"], answer: 0, explanation: "Requires MFA for delete or versioning changes on critical buckets." }
                ]
            },
            {
                id: 7,
                title: "Azure Cloud Security",
                icon: "‚òÅÔ∏èüîµ",
                difficulty: "intermediate",
                description: "Master Microsoft Azure security controls, Entra ID, RBAC, Defender for Cloud, and common misconfigurations",
                exercises: [
                    { question: "What is the primary identity service in Azure (formerly Azure AD)?", options: ["Microsoft Entra ID", "Azure Active Directory B2C", "Azure AD Domain Services", "All are identity services"], answer: 0, explanation: "Microsoft Entra ID is the cloud-native identity and access management service for Azure." },
                    { question: "What is the Azure equivalent of AWS IAM roles for VMs?", options: ["Managed Identities", "Service Principals only", "Azure AD users", "RBAC roles"], answer: 0, explanation: "Managed Identities provide Azure resources (VMs, Functions, etc.) with automatic, keyless authentication to other Azure services." },
                    { question: "Which Azure feature scans for misconfigurations and vulnerabilities?", options: ["Microsoft Defender for Cloud", "Azure Monitor", "Azure Policy", "Azure Sentinel"], answer: 0, explanation: "Defender for Cloud provides security posture management, workload protection, and threat detection." },
                    { question: "What is the least-privilege way to assign permissions in Azure?", options: ["Owner role at subscription level", "RBAC custom roles with specific actions and scopes", "Contributor role everywhere", "Global Administrator in Entra ID"], answer: 1, explanation: "Use Azure RBAC with custom roles scoped to resource groups or individual resources ‚Äî never broad Owner/Contributor." },
                    { question: "A storage account with public blob access risks?", options: ["Data exposure and unauthorized reads", "No risk if encrypted", "Only write access issues", "Performance degradation"], answer: 0, explanation: "Public containers/blobs are accessible to anyone with the URL ‚Äî a common data leak vector." },
                    { question: "What should you enable on Entra ID for strong authentication?", options: ["Multi-Factor Authentication (MFA) + Conditional Access", "Password-only login", "Shared access keys", "No policies needed"], answer: 0, explanation: "MFA + Conditional Access policies (location, device compliance, risk-based) are core to secure identity." },
                    { question: "Azure Network Security Groups (NSGs) are equivalent to?", options: ["AWS Security Groups / NACLs", "VPC Flow Logs", "Azure Firewall only", "Load balancer rules"], answer: 0, explanation: "NSGs filter traffic at subnet or NIC level ‚Äî deny by default unless allowed." },
                    { question: "Azure Activity Log should be configured to?", options: ["Send to Log Analytics + archive long-term", "Disable after setup", "Store publicly", "Only view in portal"], answer: 0, explanation: "Export Activity Log to Log Analytics / Storage for auditing, alerting, and compliance." },
                    { question: "What does Azure Defender for Storage detect?", options: ["Malware uploads, unusual access patterns, sensitive data exposure", "Only cost anomalies", "CPU spikes", "Nothing ‚Äî use third-party"], answer: 0, explanation: "Part of Defender for Cloud ‚Äî protects blob, file, ADLS storage from threats." }
                ]
            },
            {
                id: 8,
                title: "Advanced Cloud Attack Techniques & Red Teaming",
                icon: "ü©∏",
                difficulty: "advanced",
                description: "Simulate sophisticated cloud red-team attacks, privilege escalation chains, lateral movement, and persistence",
                exercises: [
                    { question: "In AWS, how can an attacker escalate from a low-priv EC2 role to full account takeover via IMDS?", options: ["Exploit IMDSv1 SSRF ‚Üí steal creds ‚Üí assume higher-role ‚Üí create new admin user", "Use CloudTrail to delete logs", "Exploit S3 bucket policy", "None ‚Äî IMDS is secure"], answer: 0, explanation: "Classic SSRF to 169.254.169.254/latest/meta-data/iam/security-credentials/role-name ‚Üí steal creds ‚Üí escalate via role chaining or policy abuse." },
                    { question: "What is the 'Golden SAML' attack targeting federated identity?", options: ["Forge SAML assertions using stolen signing keys from AD FS or Entra ID", "Steal golden ticket in Kerberos", "Exploit SAML response replay", "All are related but different"], answer: 0, explanation: "Attackers steal signing cert/key ‚Üí forge unlimited SAML assertions ‚Üí persistent access across cloud tenants." },
                    { question: "In Azure, how can a compromised service principal lead to tenant-wide compromise?", options: ["Add federation credential ‚Üí impersonate any user", "Delete the principal", "Rotate secrets", "No escalation possible"], answer: 0, explanation: "Add rogue federated credential to app registration ‚Üí persistent, high-priv access without needing password/secret." },
                    { question: "What is a common persistence technique after initial AWS access key compromise?", options: ["Create new IAM user with Admin access + access key", "Delete CloudTrail", "Change S3 bucket policy", "All can be used"], answer: 0, explanation: "Backdoor user creation is classic persistence ‚Äî hard to detect without monitoring." },
                    { question: "In GCP, how can an attacker escalate via service account key theft?", options: ["Use stolen key ‚Üí impersonate SA ‚Üí create new compute instance with higher SA", "Exploit metadata endpoint", "Both are valid paths", "No escalation possible"], answer: 2, explanation: "Key theft + impersonation + metadata abuse ‚Üí full project compromise." },
                    { question: "What is 'IAM privilege escalation via AssumeRole chaining'?", options: ["Create nested roles with increasing permissions via AssumeRole", "Exploit trust policy misconfigs", "Both", "Neither"], answer: 2, explanation: "Attacker assumes role A ‚Üí role A trusts role B ‚Üí assume B ‚Üí repeat until high priv." },
                    { question: "How can attackers bypass Azure Conditional Access during red teaming?", options: ["Use legacy auth protocols, rogue tokens, or token replay attacks", "Disable CA policy", "Only possible with insider", "Not possible"], answer: 0, explanation: "Legacy auth bypasses modern CA; stolen refresh tokens can be replayed." },
                    { question: "Which AWS service is frequently abused for data staging/exfiltration in breaches?", options: ["S3 (via signed URLs or role assumption)", "Lambda", "EC2 snapshots", "All can be abused"], answer: 0, explanation: "S3 is cheap, fast, and attackers often exfil large datasets via signed URLs." },
                    { question: "What is a realistic multi-cloud pivot technique?", options: ["Compromise federated identity creds or shared secrets between AWS/Azure/GCP", "Exploit cross-cloud API misconfigs", "Both", "Not realistic"], answer: 2, explanation: "Shared identities, misconfigured trust, or stolen creds enable lateral movement across clouds." }
                ]
            },
            {
                id: 9,
                title: "AI / LLM Hacking & OWASP LLM Top 10 Attacks",
                icon: "ü§ñ",
                difficulty: "advanced",
                description: "Red-team attacks against cloud-hosted LLMs: prompt injection, jailbreaks, model extraction, poisoning (OWASP LLM Top 10 focus)",
                exercises: [
                    { question: "OWASP LLM Top 10 #1 vulnerability in 2025 is?", options: ["Prompt Injection", "Insecure Output Handling", "Training Data Poisoning", "Model Denial of Service"], answer: 0, explanation: "Prompt injection remains #1 ‚Äî malicious input overrides system instructions." },
                    { question: "How can an attacker extract system prompt in Azure OpenAI / Bedrock?", options: ["Role-playing as developer, delimiter confusion, or multi-turn jailbreak", "Direct API call", "Only possible with insider access", "Not possible"], answer: 0, explanation: "Prompt leaking via creative jailbreaks is common ‚Äî even with filters." },
                    { question: "What is a realistic model stealing attack on cloud-hosted LLMs?", options: ["Query model thousands of times ‚Üí train shadow model locally", "Steal weights from S3", "Exploit training data", "All are possible"], answer: 0, explanation: "Query-based extraction (model stealing) is practical against public APIs." },
                    { question: "Which technique bypasses content filters in LLMs?", options: ["Unicode obfuscation, role-playing, base64 encoding of malicious intent", "Direct prompt", "Only possible with fine-tuning", "Not possible"], answer: 0, explanation: "Advanced jailbreaks often use obfuscation or persona switching." },
                    { question: "OWASP LLM Top 10 #3 ‚Äì what is 'Training Data Poisoning'?", options: ["Inject malicious data into training set to create backdoors", "Prompt injection during inference", "Model theft", "DoS via long prompts"], answer: 0, explanation: "Poisoned training data ‚Üí backdoors or biased outputs." },
                    { question: "How can attackers cause 'Model Denial of Service' (OWASP #7)?", options: ["Adversarial long/complex prompts that consume tokens", "Normal user queries", "Only via API abuse", "Not realistic"], answer: 0, explanation: "Long-context or recursive prompts can inflate costs and latency." },
                    { question: "What is 'Insecure Output Handling' (OWASP #2)?", options: ["Directly rendering LLM output in HTML/JS without sanitization ‚Üí XSS", "Prompt injection", "Data leakage", "Model theft"], answer: 0, explanation: "Unsanitized LLM output can execute malicious code in frontend." },
                    { question: "In cloud-hosted LLMs, what is a supply-chain attack vector?", options: ["Poisoned model weights in Hugging Face / public registries used in Bedrock/Vertex", "API key theft", "Prompt injection", "All are vectors"], answer: 0, explanation: "Compromised third-party models ‚Üí backdoors or data exfil." },
                    { question: "What is a hard jailbreak technique against modern LLM filters?", options: ["Multi-turn persuasion + hypothetical role-play + encoding", "Single malicious prompt", "Only possible in open-source", "Not effective anymore"], answer: 0, explanation: "Sophisticated multi-turn + obfuscation still bypasses even strong filters in 2026." }
                ]
            }
        ];
        function renderModules() {
            const container = document.getElementById('modulesView');
            container.innerHTML = modules.map((module, idx) => `
                <div class="module-card" onclick="selectModule(${idx})">
                    <div class="module-header">
                        <div class="module-icon">${module.icon}</div>
                        <div class="module-title">
                            <h3>
                                ${module.title}
                                ${state.completedModules.includes(idx) ? '<span class="completed-badge">‚úì</span>' : ''}
                            </h3>
                            <p>${module.description}</p>
                        </div>
                    </div>
                    <div class="module-meta">
                        <span class="difficulty ${module.difficulty}">${module.difficulty.charAt(0).toUpperCase() + module.difficulty.slice(1)}</span>
                        <span class="exercise-count">${module.exercises.length} exercises</span>
                    </div>
                </div>
            `).join('');
        }

        function selectModule(idx) {
            state.selectedModule = idx;
            state.currentExercise = 0;
            document.getElementById('modulesView').classList.add('hidden');
            document.getElementById('exerciseView').classList.remove('hidden');
            renderExercise();
        }

        function renderExercise() {
            const module = modules[state.selectedModule];
            const ex = module.exercises[state.currentExercise];
            const container = document.getElementById('exerciseView');

            container.innerHTML = `
                <div class="exercise-header">
                    <h3>Exercise ${state.currentExercise + 1} of ${module.exercises.length}</h3>
                    <button class="back-btn" onclick="backToModules()">‚Üê Back to Modules</button>
                </div>
                <div class="question-box">${ex.question}</div>
                <div class="options-container">
                    ${ex.options.map((opt, i) => `
                        <div class="option" onclick="selectOption(${i})">
                            <input type="radio" name="answer" id="opt${state.currentExercise}-${i}" value="${i}">
                            <label for="opt${state.currentExercise}-${i}">${opt}</label>
                        </div>
                    `).join('')}
                </div>
                <button class="submit-btn" onclick="submitAnswer()">Submit Answer</button>
                <div id="feedbackBox"></div>
            `;
        }

        function selectOption(idx) {
            const opts = document.querySelectorAll('.option');
            opts.forEach(o => o.classList.remove('selected'));
            opts[idx].classList.add('selected');
            document.querySelectorAll('input[name="answer"]').forEach(r => r.checked = false);
            document.getElementById(`opt${state.currentExercise}-${idx}`).checked = true;
        }

        function submitAnswer() {
            const module = modules[state.selectedModule];
            const ex = module.exercises[state.currentExercise];
            const selected = document.querySelector('input[name="answer"]:checked');
            if (!selected) return alert("Please select an option!");

            const userAnswer = parseInt(selected.value);
            const isCorrect = userAnswer === ex.answer;

            if (isCorrect) {
                state.score += 10;
                updateDashboard();
                if (state.currentExercise === module.exercises.length - 1 && !state.completedModules.includes(state.selectedModule)) {
                    state.completedModules.push(state.selectedModule);
                    updateDashboard();
                }
            }
            showFeedback(isCorrect, ex.explanation);
        }

        function showFeedback(isCorrect, explanation) {
            const fb = document.getElementById('feedbackBox');
            fb.className = `feedback-box ${isCorrect ? 'correct' : 'incorrect'}`;
            fb.innerHTML = `
                <div class="feedback-header">${isCorrect ? '‚úì Correct!' : '‚úó Incorrect'}</div>
                <div class="feedback-explanation">${explanation}</div>
                <button class="next-btn" onclick="nextExercise()">
                    ${state.currentExercise < modules[state.selectedModule].exercises.length - 1 ? 'Next Exercise ‚Üí' : 'Complete Module'}
                </button>
            `;
            document.querySelector('.submit-btn').disabled = true;
        }

        function nextExercise() {
            const module = modules[state.selectedModule];
            if (state.currentExercise < module.exercises.length - 1) {
                state.currentExercise++;
                renderExercise();
            } else {
                backToModules();
            }
        }

        function backToModules() {
            state.selectedModule = null;
            state.currentExercise = 0;
            document.getElementById('modulesView').classList.remove('hidden');
            document.getElementById('exerciseView').classList.add('hidden');
            renderModules();
        }

        function updateDashboard() {
            document.getElementById('totalScore').textContent = state.score;
            document.getElementById('modulesCompleted').textContent = `${state.completedModules.length}/9`;
            let skillLevel = 'Novice';
            if (state.score >= 700) skillLevel = 'Cloud Red Team Legend';
            else if (state.score >= 500) skillLevel = 'Expert';
            else if (state.score >= 300) skillLevel = 'Advanced';
            else if (state.score >= 140) skillLevel = 'Intermediate';
            document.getElementById('skillLevel').textContent = skillLevel;
        }

        // Initialize
        renderModules();
        updateDashboard();
    </script>
</body>
</html>
